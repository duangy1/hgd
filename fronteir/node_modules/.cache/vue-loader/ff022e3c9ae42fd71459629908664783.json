{"remainingRequest":"F:\\hdb\\fronteir\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\hdb\\fronteir\\src\\views\\Traits.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\hdb\\fronteir\\src\\views\\Traits.vue","mtime":1660495350241},{"path":"F:\\hdb\\fronteir\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\hdb\\fronteir\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\hdb\\fronteir\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\hdb\\fronteir\\node_modules\\vue-loader\\lib\\index.js","mtime":1656480287592}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovLyBAIGlzIGFuIGFsaWFzIHRvIC9zcmMNCi8vIGltcG9ydCBOYXZpZ2F0b3IgZnJvbSAiQC9jb21wb25lbnRzL25hdmlnYXRvci52dWUiOw0KaW1wb3J0IHRyYWl0T250b2xvZ3kgZnJvbSAiQC9hc3NldHMvc3RhdGljL3RyYWl0T250b2xvZ3kuanNvbiI7DQppbXBvcnQgQmFubmVyIGZyb20gIkAvY29tcG9uZW50cy9iYW5uZXIudnVlIjsNCmltcG9ydCBGb290ZXJCYXIgZnJvbSAiQC9jb21wb25lbnRzL0Zvb3RlckJhci52dWUiOw0KaW1wb3J0IEhlYWRlckJhciBmcm9tICJAL2NvbXBvbmVudHMvSGVhZGVyQmFyLnZ1ZSI7DQovLyBpbXBvcnQgcXMgZnJvbSAicXMiOw0KLy8gLy8gaWNvbnMNCmltcG9ydCBzYW1lVHJhaXRJY29uIGZyb20gIkAvYXNzZXRzL2ltZy9pY29uL3N0YXIuc3ZnIjsNCmltcG9ydCBvcnRob0ljb24gZnJvbSAiQC9hc3NldHMvaW1nL2ljb24vaHVhZnUuc3ZnIjsNCmltcG9ydCBzaW5nbGVUcmFpdEljb24gZnJvbSAiQC9hc3NldHMvaW1nL2ljb24vb3JhbmdlLnN2ZyI7DQovLyBpbXBvcnQgIkAvYXNzZXRzL2Nzcy90cmFpdHMuY3NzIjsNCi8vIGltcG9ydCBGaWxlU2F2ZXIgZnJvbSAnZmlsZS1zYXZlcicNCi8vIGltcG9ydCBYTFNYIGZyb20gJ3hsc3gnDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJUcmFpdHMiLA0KICBjb21wb25lbnRzOiB7DQogICAgLy8gTmF2aWdhdG9yLA0KICAgIEZvb3RlckJhciwNCiAgICBIZWFkZXJCYXIsDQogICAgQmFubmVyLA0KICAgIA0KICB9LA0KICB3YXRjaDogew0KICAgIGZpbHRlclRleHQodmFsKSB7DQogICAgICB0aGlzLiRyZWZzLnRyZWUuZmlsdGVyKHZhbCk7DQogICAgfSwNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgc2FtZVRyYWl0SWNvbiwNCiAgICAgIG9ydGhvSWNvbiwNCiAgICAgIHNpbmdsZVRyYWl0SWNvbiwNCiAgICAgIHZpc2libGU6ZmFsc2UsDQogICAgICB2aXNpYmxlXzE6ZmFsc2UsDQogICAgICBmaWx0ZXJUZXh0OiAiIiwNCiAgICAgIHRyZWVkYXRhOiB0cmFpdE9udG9sb2d5LnRyZWUsDQogICAgICBzaG93U3ViVGFibGVCb3g6ZmFsc2UsDQogICAgICBnd2FzTG9hZGluZzp0cnVlLA0KICAgICAgb3J0aG9Mb2FkaW5nOnRydWUsDQogICAgICBkcmF3ZXI6ZmFsc2UsDQogICAgICBkaXJlY3Rpb246Imx0ciIsDQogICAgICAgLy8g5L+d5a2Y5ZCM5rqQ54mp56eN77yM55So5LqO6KGo5qC855Sf5oiQ5YiXDQogICAgICBzcGVjaWVzTGlzdF9hbmltYWw6W10sDQogICAgICBzcGVjaWVzTGlzdF9wbGFudDpbXSwNCiAgICAgICAvLyDkv53lrZjlkIzmupDniannp41vYmrvvIznlKjkuo7liqjmgIHpgInmi6nliJcNCiAgICAgIHNwZWNpZXNMaXN0X2FuaW1hbF8xOltdLA0KICAgICAgc3BlY2llc0xpc3RfcGxhbnRfMTpbXSwNCiAgICAgIHRyYWl0RGF0YV9hbmltYWw6IFtdLA0KICAgICAgdHJhaXREYXRhX3BsYW50OltdLA0KICAgICAgb3J0aG9UYWJsZURhdGE6IFtdLA0KICAgICAgdmFsdWU6ICIiLA0KICAgICAgdHJhaXRJdGVtOnsNCiAgICAgICAgdHJhaXROYW1lOiJncm93dGggYW5kIG1lYXQgcHJvZHVjdGlvbiB0cmFpdCIsDQogICAgICAgIHRyYWl0SWQ6IkFQVE86MDAwMDAwNiIsDQogICAgICAgIHRyYWl0RGVmSUQ6Ijg5NzEiLA0KICAgICAgICBkZWZpbml0aW9uOiJhbnkgbWVhc3VyYWJsZSBvciBvYnNlcnZhYmxlIGNoYXJhY3RlcmlzdGljcyByZWxhdGVkIHRvIGFuaW1hbCBncm93dGggYW5kIG1lYXQgcHJvZHVjdGlvbiBxdWFudGl0eSBhbmQgcXVhbGl0eSIsDQogICAgICAgIGNsYXNzaWZpY2F0aW9uOiJhbmltYWwiDQogICAgICB9LA0KICAgICAgY3VycmVudFBhZ2U0X2E6IDEsDQogICAgICBjdXJyZW50UGFnZTRfcDogMSwNCiAgICAgIHRvdGFsU2l6ZV9hbmltYWw6IDAsDQogICAgICB0b3RhbFNpemVfcGxhbnQ6IDAsDQogICAgICBmb3JtOiB7DQogICAgICAgIHF1ZXJ5U3BlY2llczoiIiwNCiAgICAgICAgZ2VuZToiIg0KICAgICAgfSwNCiAgICAgIHBhZ2VTaXplOiAxMCwNCiAgICAgIGd3YXNJbmZvRGF0YTpbXSwNCiAgICAgIGxvYWRpbmc6dHJ1ZSwNCiAgICAgIGxvYWRpbmdfYW5pbWFsOmZhbHNlLA0KICAgICAgbG9hZGluZ19wbGFudDpmYWxzZSwNCiAgICAgIHNob3dPcnRob1N1YlRhYmxlOmZhbHNlLA0KICAgICAgY2xhc3NpZmljYXRpb246ImFuaW1hbCIsDQogICAgICBuYXZCYXJGaXhlZDoiZmFsc2UiLA0KICAgICAgc2hvd1RyYWl0U2FtZUljb246ZmFsc2UsDQogICAgICAgLy8g5LuO5o6l5Y+j6I635Y+W5omA5pyJ5pyJdHJhaXTmlbDmja7nmoTniannp43vvIznlKjkuo7niannp43pgInmi6nvvIzmj5DkuqRzZWFyY2gNCiAgICAgIHF1ZXJ5U3BlY2llc0xpc3RfYW5pbWFsOltdLA0KICAgICAgcXVlcnlTcGVjaWVzTGlzdF9wbGFudDpbXSwNCiAgICAgIHF1ZXJ5U3BlY2llc0xpc3Q6W10sDQogICAgICBzZWxlY3RHZW5lOnt9LA0KICAgICAgc2hvd1RpdGxlOnRydWUNCiAgICAgIA0KICAgIH07DQogIH0sDQoNCiAgbWV0aG9kczogew0KICAgDQogICAgY2hhbmdlQ2xhc3ModGFiKXsNCiAgICAgICAgdGhpcy5zcGVjaWVzTGlzdD1bXTsNCiAgICAgICAgdGhpcy5zaG93T3J0aG9TdWJUYWJsZT1mYWxzZTsNCiAgICAgICAgdGhpcy5zaG93U3ViVGFibGVCb3g9ZmFsc2U7DQogICAgICAgIHRoaXMuJHJlZnNbJ3RhYmxlJ10uZG9MYXlvdXQoKTsNCiAgICAgICAgdGhpcy5mb3JtLnF1ZXJ5U3BlY2llcz0nJzsNCiAgICAgICAgdGhpcy5mb3JtLmdlbmU9Jyc7DQogICAgICAgIC8vIGNvbnNvbGUubG9nKCJ0YWIsIGV2ZW50OiIsdGFiLCBldmVudCk7DQogICAgICAgIHRoaXMuY2xhc3NpZmljYXRpb249dGFiLm5hbWUNCiAgICB9LA0KDQogICAgY29uZmlybWJ1dHRvbigpew0KICAgIHRoaXMudmlzaWJsZV8xID0gZmFsc2U7DQogICAgdGhpcy52aXNpYmxlID0gZmFsc2U7DQogICAgdGhpcy4kcmVmcy50YWJsZS5kb0xheW91dCgpOw0KICAgfSwNCiAgICBoYW5kbGVTaXplQ2hhbmdlKHZhbCl7DQogICAgICAvLyB0aGlzLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgLy8gaWYodGhpcy5jbGFzc2lmaWNhdGlvbj09ImFuaW1hbCIpe3RoaXMubG9hZGluZ19hbmltYWw9dHJ1ZTt9ZWxzZXt0aGlzLmxvYWRpbmdfcGxhbnQ9dHJ1ZX0NCiAgICAgIGlmKHRoaXMuY2xhc3NpZmljYXRpb249PSJhbmltYWwiKXsNCiAgICAgICAgdGhpcy5jdXJyZW50UGFnZTRfYT0xDQogICAgICAgIHRoaXMubG9hZGluZ19hbmltYWw9dHJ1ZTsNCiAgICAgIH1lbHNlew0KICAgICAgICB0aGlzLmxvYWRpbmdfcGxhbnQ9dHJ1ZQ0KICAgICAgICB0aGlzLmN1cnJlbnRQYWdlNF9wPTENCiAgICAgIH0NCiAgICAgIHRoaXMucGFnZVNpemUgPSB2YWw7DQogICAgICAvLyBsZXQgcGFyYW1zPXt0cmFpdElkOnRoaXMudHJhaXRJdGVtLnRyYWl0RGVmSUQsY2xhc3NpZmljYXRpb246dGhpcy5jbGFzc2lmaWNhdGlvbixwYWdlc2l6ZTp0aGlzLnBhZ2VTaXplLHBhZ2VudW06MSxzcGVjaWVzTmFtZTp0aGlzLmZvcm0ucXVlcnlTcGVjaWVzfQ0KICAgICAgdGhpcy5nZXRUcmFpdERhdGEodGhpcy50cmFpdEl0ZW0udHJhaXREZWZJRCx0aGlzLmNsYXNzaWZpY2F0aW9uLHRoaXMuaGRiSWQpDQogICAgfSwNCiAgICBoYW5kbGVDdXJyZW50Q2hhbmdlKHZhbCkgew0KICAgICAgaWYodGhpcy5jbGFzc2lmaWNhdGlvbj09ImFuaW1hbCIpew0KICAgICAgICB0aGlzLmxvYWRpbmdfYW5pbWFsPXRydWU7DQogICAgICAgIHRoaXMuY3VycmVudFBhZ2U0X2EgPSB2YWw7DQogICAgICB9ZWxzZXsNCiAgICAgICAgdGhpcy5sb2FkaW5nX3BsYW50PXRydWU7DQogICAgICAgIHRoaXMuY3VycmVudFBhZ2U0X3AgPSB2YWw7DQogICAgICB9DQogICAgICB0aGlzLmdldFRyYWl0RGF0YSh0aGlzLnRyYWl0SXRlbS50cmFpdERlZklELHRoaXMuY2xhc3NpZmljYXRpb24sdGhpcy5oZGJJZCkNCg0KICAgIH0sDQogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKHZhbCkgew0KICAgICAgdGhpcy5tdWx0aXBsZVNlbGVjdGlvbiA9IHZhbDsNCiAgICB9LA0KICAgIGZpbHRlck5vZGUodmFsdWUsIGRhdGEpIHsNCiAgICAgIGlmICghdmFsdWUpIHJldHVybiB0cnVlOw0KICAgICAgcmV0dXJuIGRhdGEubGFiZWwuaW5kZXhPZih2YWx1ZSkgIT09IC0xOw0KICAgIH0sDQogICAgZ2V0SW5mb0J5VHJhaXQodmFsdWUsIGRhdGEpIHsNCiAgICAgIHRoaXMuaGRiSWQ9IiI7DQogICAgICB0aGlzLnNob3dUaXRsZT10cnVlOw0KICAgICAgLy8g5YWI6ZqQ6JeP546w5a6e55qEZGV0YWls6KGo5qC8DQogICAgICB0aGlzLnNob3dPcnRob1N1YlRhYmxlPWZhbHNlOw0KICAgICAgdGhpcy5zaG93U3ViVGFibGVCb3g9ZmFsc2U7DQogICAgICB0aGlzLnRyYWl0SXRlbS50cmFpdE5hbWU9dmFsdWUuTmFtZTsNCiAgICAgIHRoaXMudHJhaXRJdGVtLnRyYWl0SWQ9dmFsdWUudHJhaXRJRDsNCiAgICAgIHRoaXMudHJhaXRJdGVtLnRyYWl0RGVmSUQ9dmFsdWUudHJhaXREZWZJRDsNCiAgICAgIHRoaXMudHJhaXRJdGVtLmRlZmluaXRpb249dmFsdWUuRGVmaW5pdGlvbnM7DQogICAgICB0aGlzLnRyYWl0SXRlbS5jbGFzc2lmaWNhdGlvbj12YWx1ZS5jbGFzc2lmaWNhdGlvbjsNCiAgICAgIHRoaXMuZm9ybT0gew0KICAgICAgICBxdWVyeVNwZWNpZXM6IiIsDQogICAgICAgIGdlbmU6IiINCiAgICAgIH0NCiAgICAgIGlmKHZhbHVlLmNsYXNzaWZpY2F0aW9uIT09IiImJnZhbHVlLmNsYXNzaWZpY2F0aW9uIT09bnVsbCl7DQogICAgICAgIGlmKHZhbHVlLmNsYXNzaWZpY2F0aW9uPT0iYW5pbWFsIil7DQogICAgICAgICAgdGhpcy5jbGFzc2lmaWNhdGlvbj0iYW5pbWFsIg0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICB0aGlzLmNsYXNzaWZpY2F0aW9uPSJwbGFudCINCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgdGhpcy5sb2FkaW5nX2FuaW1hbD10cnVlOw0KICAgICAgdGhpcy5nZXRUcmFpdERhdGEodmFsdWUudHJhaXREZWZJRCwiYW5pbWFsIik7DQogICAgICB0aGlzLmxvYWRpbmdfcGxhbnQ9dHJ1ZTsNCiAgICAgIHRoaXMuZ2V0VHJhaXREYXRhKHZhbHVlLnRyYWl0RGVmSUQsInBsYW50IikNCiAgICAgIHRoaXMuY3VycmVudFBhZ2U0X3A9MTsNCiAgICAgIHRoaXMuY3VycmVudFBhZ2U0X2E9MTsNCiAgICAgIA0KICAgICAgZGF0YS5jaGVja2VkID0gdHJ1ZTsNCiAgICAgIHRoaXMuY2xhc3NpZmljYXRpb249dmFsdWUuY2xhc3NpZmljYXRpb247DQoNCiAgICB9LA0KICBzaG93U2VsZWN0ZWRHZW5lKHJvd0RhdGEpew0KICAgICAgdGhpcy5zZWxlY3RHZW5lPXJvd0RhdGE7DQogIH0sDQogIHNob3dPcnRob0luZm9UYWJsZShyb3dEYXRhLGluZGV4KXsNCiAgICB0aGlzLnNob3dTZWxlY3RlZEdlbmUocm93RGF0YSxpbmRleCkNCiAgICAvLyByb3dEYXRhLm9ydGhvTGlzdFtyb3dEYXRhLnNwZWNpZXNMaXN0RGF0YS5pbmRleE9mKGluZGV4KV07DQogICAgbGV0IG9ydGhvbGlzdD1bXTsNCiAgICByb3dEYXRhLnNwZWNpZXNMaXN0RGF0YS5mb3JFYWNoKChpZCxpZHgpPT57DQogICAgICBpZihpZD09aW5kZXgpew0KICAgICAgICBvcnRob2xpc3QucHVzaChyb3dEYXRhLm9ydGhvTGlzdFtpZHhdKQ0KICAgIH19KQ0KICAgIC8vIGNvbnNvbGUubG9nKCJpbmRleCBsaXN0OiIsb3J0aG9saXN0KTsNCg0KICAgIC8vIHJvd0RhdGEuDQogICAgdGhpcy5zaG93T3J0aG9TdWJUYWJsZSA9IHRydWU7DQogICAgdGhpcy5zaG93U3ViVGFibGVCb3g9ZmFsc2U7DQogICAgdGhpcy5vcnRob0xvYWRpbmc9ZmFsc2U7DQoNCiAgIHRoaXMub3J0aG9UYWJsZURhdGE9W10NCiAgICBvcnRob2xpc3QuZm9yRWFjaChpdGVtPT57DQogICAgICBsZXQgaGRiaWQ9aXRlbS5oZGJJZDsNCiAgICAgIHRoaXMuJGF4aW9zLmdldCgiaHR0cHM6Ly9uZ2RjLmNuY2IuYWMuY24vaGFwaS9hcGkvZ2VuZS1kZXRhaWwtb3J0aG8iLHtwYXJhbXM6eyJoZGJJZCI6aGRiaWR9fSkudGhlbigocmVzKT0+ew0KICAgICAgICBjb25zb2xlLmxvZygiZ2VuZSByZXM6IixyZXMpOw0KICAgICAgICBpdGVtLmVuc2VtYmxHZW5lSWQ9cmVzLmRhdGEuZW5zZW1ibEdlbmVJZC5sZW5ndGg+MD9yZXMuZGF0YS5lbnNlbWJsR2VuZUlkOiItIjsNCiAgICAgICAgaXRlbS5nZW5lU3ltYm9sPXJlcy5kYXRhLmdlbmVTeW1ib2wubGVuZ3RoPjA/cmVzLmRhdGEuZ2VuZVN5bWJvbDoiLSI7DQogICAgICAgIHRoaXMub3J0aG9UYWJsZURhdGEucHVzaChpdGVtKQ0KICAgICAgICB0aGlzLm9ydGhvTG9hZGluZz1mYWxzZTsNCiAgICAgIH0pDQogICAgfSkNCiAgICBjb25zb2xlLmxvZygib3J0aG9UYWJsZURhdGHvvJoiLHRoaXMub3J0aG9UYWJsZURhdGEpOw0KDQogICAgLy8gdGhpcy5vcnRob1RhYmxlRGF0YT1vcnRob2xpc3Q7DQogICAgLy8gY29uc29sZS5sb2codGhpcy5vcnRob1RhYmxlRGF0YSk7DQogICAgLy8g5bqU6K+l5Y+R6YCB6K+35rGC5Y67Z2VuZWJhc2ljaW5mb+afpeWFt+S9k+eahOWfuuWboOebuOWFs+S/oeaBrw0KDQogIH0sDQogDQogIC8vIOihqOagvOmrmOW6puiHqumAguW6lA0KICBnZXRUYWJsZU1heEhlaWdodCgpew0KICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgew0KICAgICAgbGV0IGJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi50cmFpdC1pbmZvIikuYXR0cmlidXRlcw0KICAgICAgbGV0IGJveF9jbGllbnRIZWlnaHQgPSBib3hbMF0ub3duZXJFbGVtZW50LmNsaWVudEhlaWdodDsNCiAgICAgIHRoaXMudGFibGVIZWlnaHQgPSBib3hfY2xpZW50SGVpZ2h0IC0gMTAwOw0KICAgIH0pDQogIH0sDQogIGJ1dHRvbkZ1bmN0aW9uKCl7DQogICAgdGhpcy5kcmF3ZXIgPSB0cnVlOw0KICAgfSwNCiAgc2hvd0d3YXNJbmZvVGFibGUocm93VmFsdWUsaW5kZXgpew0KICAgIHRoaXMuZ3dhc0xvYWRpbmc9dHJ1ZTsNCiAgICB0aGlzLnNob3dTZWxlY3RlZEdlbmUocm93VmFsdWUsaW5kZXgpDQogICAgLy8g6I635Y+W5b2T5YmN5L2N572u77yM5Lik54mp56eN6Ze05ZCM5rqQ5pWw5o2uDQogICAgbGV0IG9ydGhvbGlzdD1bXTsNCiAgICByb3dWYWx1ZS5zcGVjaWVzTGlzdERhdGEuZm9yRWFjaCgoaWQsaWR4KT0+ew0KICAgIGlmKGlkPT1pbmRleCl7DQogICAgICAgIGxldCBpdGVtPXJvd1ZhbHVlLm9ydGhvTGlzdFtpZHhdDQogICAgICAgIGNvbnNvbGUubG9nKCJpdGVtOiIsaXRlbSk7DQogICAgICAgIG9ydGhvbGlzdC5wdXNoKGl0ZW0pDQogICAgfX0pDQogICAgY29uc29sZS5sb2coIm9ydGhvbGlzdDoiLG9ydGhvbGlzdCk7DQogICAgdGhpcy5vcnRob1RhYmxlRGF0YT1bXQ0KICAgIG9ydGhvbGlzdC5mb3JFYWNoKGl0ZW09PnsNCiAgICAgIGxldCBoZGJpZD1pdGVtLmhkYklkOw0KICAgICAgdGhpcy4kYXhpb3MuZ2V0KCJodHRwczovL25nZGMuY25jYi5hYy5jbi9oYXBpL2FwaS9nZW5lLWRldGFpbC1vcnRobyIse3BhcmFtczp7ImhkYklkIjpoZGJpZH19KS50aGVuKChyZXMpPT57DQogICAgICAgIGNvbnNvbGUubG9nKCJnZW5lIHJlczoiLHJlcyk7DQogICAgICAgIGl0ZW0uZW5zZW1ibEdlbmVJZD1yZXMuZGF0YS5lbnNlbWJsR2VuZUlkLmxlbmd0aD4wP3Jlcy5kYXRhLmVuc2VtYmxHZW5lSWQ6Ii0iOw0KICAgICAgICBpdGVtLmdlbmVTeW1ib2w9cmVzLmRhdGEuZ2VuZVN5bWJvbC5sZW5ndGg+MD9yZXMuZGF0YS5nZW5lU3ltYm9sOiItIjsNCiAgICAgICAgdGhpcy5vcnRob1RhYmxlRGF0YS5wdXNoKGl0ZW0pDQogICAgICAgIHRoaXMub3J0aG9Mb2FkaW5nPWZhbHNlOw0KICAgICAgfSkNCiAgICB9KQ0KICAgIGNvbnNvbGUubG9nKCJyb3dWYWx1ZToiLHJvd1ZhbHVlKTsNCiAgICB0aGlzLnNob3dPcnRob1N1YlRhYmxlID0gdHJ1ZTsNCiAgICB0aGlzLm9ydGhvTG9hZGluZz1mYWxzZTsNCiAgICAvLyB0aGlzLm9ydGhvVGFibGVEYXRhPW9ydGhvbGlzdDsNCiAgICB0aGlzLnNob3dTdWJUYWJsZUJveD10cnVlOw0KICAgIA0KICAgIC8vIOW3puS+p+WfuuWboOeahOaOpeWPo+aVsOaNrg0KICAgIGxldCBnd2FzaWQxPXJvd1ZhbHVlLmd3YXNJZA0KICAgIGxldCB0YXhpZDE9cm93VmFsdWUuZ3dhc09yZ2lkOw0KICAgIGxldCBnd2FzR2VuZUlkPXJvd1ZhbHVlLmdlbmVJZDsNCiAgICAvLyBsZXQgdmFyTGlzdD1bXTsNCiAgICBsZXQgZmlsdExpc3Q9W10NCiAgICAvLyDlt6bkvqfln7rlm6Dor7fmsYLmjqXlj6MNCiAgICB0aGlzLiRheGlvcy5nZXQoImh0dHBzOi8vbmdkYy5jbmNiLmFjLmNuL2dhcGkvZ3dhcy9nd2FzaWRzP2d3YXNJZD0iK2d3YXNpZDErIiZvcmdhbmlzbUlkPSIrdGF4aWQxKyImb2Zmc2V0PTAmcGFnZXNpemU9MTAmdG90YWw9MTAmZ2VuZUlkPSIrZ3dhc0dlbmVJZCkNCiAgICAudGhlbihyZXNwb25zZT0+ew0KICAgICAgY29uc29sZS5sb2coImd3YXMgcmVzcG9uc2U6IixyZXNwb25zZSk7DQogICAgICBsZXQgZGF0YWxpc3Q9cmVzcG9uc2UuZGF0YTsNCiAgICAgIA0KICAgICAgZm9yKGxldCBpdGVtIG9mIGRhdGFsaXN0KXsNCiAgICAgICAgaXRlbS50b3BUcmFpdD1yb3dWYWx1ZS50cmFpdE5hbWU7DQogICAgICAgIGl0ZW0ub3J0aG9HZW5lSWQ9cm93VmFsdWUuZ2VuZUlkOw0KICAgICAgICAvLyBpZih2YXJMaXN0LmluZGV4T2YoaXRlbS52YXJJZCk9PS0xKXsNCiAgICAgICAgLy8gICB2YXJMaXN0LnB1c2goaXRlbS52YXJJZCkNCiAgICAgICAgZmlsdExpc3QucHVzaChpdGVtKTsNCiAgICAgICAgLy8gfQ0KICAgICAgfQ0KICAgICAgLy8gdGhpcy5nd2FzSW5mb0RhdGE9ZmlsdExpc3Q7IA0KICAgICAgDQogICAgICAvLyB0aGlzLmd3YXNMb2FkaW5nPWZhbHNlOw0KICAgICAgDQogICAgfSkNCiAgICAvLyDlj7Pkvqfln7rlm6DmlbDmja4NCiAgICAvLyDlvqrnjq/lvZPliY3lkIzmupDmlbDmja7vvIzor7fmsYLlkI7nq6/lvpfliLDmjqXlj6PmiYDpnIDopoHnmoTlj4LmlbANCiAgICBvcnRob2xpc3QuZm9yRWFjaCgoaXRlbSk9PnsNCiAgICAgIGNvbnNvbGUubG9nKCJpdGVtOiIsaXRlbSk7DQogICAgICBsZXQgaGRiaWQ9aXRlbS5oZGJJZDsNCiAgICAgIC8vIGxldCB0b3BUcmFpdD1pdGVtLnRyYWl0TmFtZTsNCiAgICAgIGNvbnNvbGUubG9nKCJpdGVtLmhkYklkOiIsaXRlbS5oZGJJZCk7DQogICAgICB0aGlzLiRheGlvcy5nZXQoImh0dHBzOi8vbmdkYy5jbmNiLmFjLmNuL2hhcGkvYXBpL3RyYWl0cy1nd2FzLWluZm8iLHtwYXJhbXM6eydoZGJJZCc6IGhkYmlkfX0pLnRoZW4ocmVzPT57DQogICAgICAgIGNvbnNvbGUubG9nKCJyZXM6IixyZXMpOw0KICAgICAgICBpZihyZXMuZGF0YS5sZW5ndGggIT09MCl7DQogICAgICAgICAgbGV0IGd3YXNpZDI9cmVzLmRhdGEuZ3dhc0lkOw0KICAgICAgICAgIGxldCB0YXhpZDI9cmVzLmRhdGEuZ3dhc09yZ2lkOw0KICAgICAgICAgIGxldCBnd2FzR2VuZUlkPXJlcy5kYXRhLmd3YXNHZW5lSWQ7DQogICAgICAgICAgaWYoZ3dhc2lkMiAhPSBnd2FzaWQxKXsNCiAgICAgICAgICAgIHRoaXMuJGF4aW9zLmdldCgiaHR0cHM6Ly9uZ2RjLmNuY2IuYWMuY24vZ2FwaS9nd2FzL2d3YXNpZHM/Z3dhc0lkPSIrZ3dhc2lkMisiJm9yZ2FuaXNtSWQ9Iit0YXhpZDIrIiZvZmZzZXQ9MCZwYWdlc2l6ZT0xMCZ0b3RhbD0xMCZnZW5lSWQ9Iitnd2FzR2VuZUlkKQ0KICAgICAgICAgICAgICAudGhlbihyZXNwb25zZT0+ew0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJnd2FzIHJlc3BvbnNlMjI6IixyZXNwb25zZSk7DQogICAgICAgICAgICAgICAgbGV0IGRhdGFsaXN0PXJlc3BvbnNlLmRhdGE7DQogICAgICAgICAgICAgICAgaWYoZGF0YWxpc3QubGVuZ3RoPjApew0KICAgICAgICAgICAgICAgICAgZm9yKGxldCBpZGF0YSBvZiBkYXRhbGlzdCl7DQogICAgICAgICAgICAgICAgICAgIC8vIGlmKHZhckxpc3QuaW5kZXhPZihpdGVtLnZhcklkKT09LTEpew0KICAgICAgICAgICAgICAgICAgICAvLyAgIHZhckxpc3QucHVzaChpdGVtLnZhcklkKQ0KICAgICAgICAgICAgICAgICAgICBpZGF0YS50b3BUcmFpdD1pdGVtLnRyYWl0TmFtZTsNCiAgICAgICAgICAgICAgICAgICAgaWRhdGEub3J0aG9HZW5lSWQ9aXRlbS5lbnNlbWJsR2VuZUlkOw0KICAgICAgICAgICAgICAgICAgICBmaWx0TGlzdC5wdXNoKGlkYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgLy8gfQ0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KS5maW5hbGx5KCgpPT57DQogICAgICAgICAgICAgIHRoaXMuZ3dhc0luZm9EYXRhPWZpbHRMaXN0Ow0KICAgICAgICAgICAgICB0aGlzLmd3YXNJbmZvRGF0YS50b3BUcmFpdD1yb3dWYWx1ZS50cmFpdE5hbWU7DQogICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICAgIHRoaXMuZ3dhc0xvYWRpbmc9ZmFsc2U7DQogICAgICAgICAgICAgIH0sIDEwMCk7DQogICAgICAgICAgICB9KQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICAgIA0KICAgIH0pDQogICANCiAgICAvLyB0aGlzLiRheGlvcy5nZXQoImh0dHBzOi8vbmdkYy5jbmNiLmFjLmNuL2hhcGkvYXBpL3RyYWl0cy1nd2FzLWluZm8iLHtwYXJhbXM6eydoZGJpZCc6IGhkYmxpc3R9fSkudGhlbihyZXM9PnsNCiAgICAvLyAgICAgY29uc29sZS5sb2coInJlczoiLHJlcyk7DQogICAgLy8gfSkNCiAgIH0sDQogICBzaG93U2luZ2xlR3dhc0luZm9UYWJsZShyb3dWYWx1ZSxpbmRleCl7DQogICAgY29uc29sZS5sb2coInJvd1ZhbHVlLGluZGV4OiIscm93VmFsdWUsaW5kZXgpOw0KICAgIC8vIOiOt+WPluW9k+WJjeS9jee9ru+8jOS4pOeJqeenjemXtOWQjOa6kOaVsOaNrg0KICAgIGxldCBvcnRob2xpc3Q9W107DQogICAgcm93VmFsdWUuc3BlY2llc0xpc3REYXRhLmZvckVhY2goKGlkLGlkeCk9PnsNCiAgICBpZihpZD09aW5kZXgpew0KICAgICAgICBsZXQgaXRlbT1yb3dWYWx1ZS5vcnRob0xpc3RbaWR4XQ0KICAgICAgICBjb25zb2xlLmxvZygiaXRlbToiLGl0ZW0pOw0KICAgICAgICBvcnRob2xpc3QucHVzaChpdGVtKQ0KICAgIH19KQ0KICAgIA0KICAgIHRoaXMuc2hvd09ydGhvU3ViVGFibGUgPSB0cnVlOw0KICAgIHRoaXMub3J0aG9Mb2FkaW5nPWZhbHNlOw0KICAgIHRoaXMub3J0aG9UYWJsZURhdGE9b3J0aG9saXN0Ow0KICAgIHRoaXMuc2hvd1N1YlRhYmxlQm94PXRydWU7DQogICAgdGhpcy5nd2FzTG9hZGluZz10cnVlOw0KICAgIHRoaXMuZ3dhc0luZm9EYXRhPVtdOw0KICAgIC8vIOWPs+S+p+WfuuWboOaVsOaNrg0KICAgIC8vIOW+queOr+W9k+WJjeWQjOa6kOaVsOaNru+8jOivt+axguWQjuerr+W+l+WIsOaOpeWPo+aJgOmcgOimgeeahOWPguaVsA0KICAgIG9ydGhvbGlzdC5mb3JFYWNoKChpdGVtKT0+ew0KICAgICAgbGV0IGhkYmlkPWl0ZW0uaGRiSWQ7DQogICAgICAvLyBsZXQgdG9wVHJhaXQ9aXRlbS50cmFpdE5hbWU7DQogICAgICBjb25zb2xlLmxvZygiaXRlbS5oZGJJZDoiLGl0ZW0uaGRiSWQpOw0KICAgICAgdGhpcy4kYXhpb3MuZ2V0KCJodHRwczovL25nZGMuY25jYi5hYy5jbi9oYXBpL2FwaS90cmFpdHMtZ3dhcy1pbmZvIix7cGFyYW1zOnsnaGRiSWQnOiBoZGJpZH19KS50aGVuKHJlcz0+ew0KICAgICAgICBjb25zb2xlLmxvZygicmVzOiIscmVzKTsNCiAgICAgICAgaWYocmVzLmRhdGEubGVuZ3RoICE9PTApew0KICAgICAgICAgIGxldCBnd2FzaWQyPXJlcy5kYXRhLmd3YXNJZDsNCiAgICAgICAgICBsZXQgdGF4aWQyPXJlcy5kYXRhLmd3YXNPcmdpZDsNCiAgICAgICAgICB0aGlzLiRheGlvcy5nZXQoImh0dHBzOi8vbmdkYy5jbmNiLmFjLmNuL2dhcGkvZ3dhcy9nd2FzaWRzP2d3YXNJZD0iK2d3YXNpZDIrIiZvcmdhbmlzbUlkPSIrdGF4aWQyKyImb2Zmc2V0PTAmcGFnZXNpemU9MTAmdG90YWw9MTAiKQ0KICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2U9PnsNCiAgICAgICAgICAgICAgY29uc29sZS5sb2coImd3YXMgcmVzcG9uc2UyMjoiLHJlc3BvbnNlKTsNCiAgICAgICAgICAgICAgbGV0IGRhdGFsaXN0PXJlc3BvbnNlLmRhdGE7DQogICAgICAgICAgICAgIGZvcihsZXQgaWRhdGEgb2YgZGF0YWxpc3Qpew0KICAgICAgICAgICAgICAgIGlkYXRhLnRvcFRyYWl0PWl0ZW0udHJhaXROYW1lOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIC8vIGxldCBkYXRhPXJlc3BvbnNlLmRhdGE7DQogICAgICAgICAgICAgIC8vIGRhdGEudG9wVHJhaXQ9aXRlbS50cmFpdE5hbWU7DQogICAgICAgICAgICAgIHRoaXMuZ3dhc0luZm9EYXRhPXRoaXMuZ3dhc0luZm9EYXRhLmNvbmNhdChkYXRhbGlzdCkNCiAgICAgICAgICAgICANCiAgICAgICAgICAgICAgY29uc29sZS5sb2coInRoaXMuZ3dhc0luZm9EYXRhOiIsdGhpcy5nd2FzSW5mb0RhdGEpOw0KICAgICAgICAgIH0pDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSkNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgIHRoaXMuZ3dhc0xvYWRpbmc9ZmFsc2U7DQogICAgfSwgMTAwKTsNCiAgIH0sDQogICAgaGlsaWd0RGJDb2xzKHtyb3dJbmRleH0pew0KICAgICAgaWYocm93SW5kZXg9PT0xKXsNCiAgICAgICAgICByZXR1cm4gIndyaXRpbmctbW9kZTogdmVydGljYWwtbHI7ICFpbXBvcnRhbnQ7dGV4dC1hbGlnbjpyaWdodCINCiAgICAgIH0NCiAgICAgIA0KICAgIH0sDQogICAgaWNvbkNsYXNzKGRhdGEsaW5kZXgpew0KICAgICAgLy8gaWYoZGF0YS5zcGVjaWVzTGlzdERhdGEuaW5kZXhPZihpbmRleCk+LTEpew0KICAgICAgICAvLyDlvqrnjq/lvZPliY3ooYznmoTlkIzmupDniannp41pbmRleA0KICAgICAgICBkYXRhLnNwZWNpZXNMaXN0RGF0YS5mb3JFYWNoKChpZCxpZHgpPT57DQogICAgICAgICAgLy8gY29uc29sZS5sb2coImlkLGluZGV4OiIsaWQsaW5kZXgpOw0KICAgICAgICAgIGlmKGlkPT1pbmRleCl7DQogICAgICAgICAgICAvLyDlj5blh7rliJdpbmRleOWSjOWQjOa6kGluZGV455u4562J55qE5YiX5YC8DQogICAgICAgICAgICBpZiggZGF0YS5vcnRob0xpc3RbaWR4XS50cmFpdE5hbWUhPW51bGwgKXsNCiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coImRhdGEub3J0aG9MaXN0W2lkeF06IixkYXRhLm9ydGhvTGlzdFtpZHhdLnRyYWl0TmFtZSxkYXRhLnRyYWl0TmFtZSk7DQogICAgICAgICAgICAgIGxldCB0cmFpdGxpc3Q9ZGF0YS5vcnRob0xpc3RbaWR4XS50cmFpdE5hbWUuc3BsaXQoIiwiKQ0KICAgICAgICAgICAgICBjb25zb2xlLmxvZygidHJhaXRsaXN0OiIsdHJhaXRsaXN0LCJkYXRhLnRyYWl0TmFtZToiLGRhdGEudHJhaXROYW1lKTsNCiAgICAgICAgICAgICAgaWYodHJhaXRsaXN0LmluZGV4T2YoZGF0YS50cmFpdE5hbWUpPi0xKXsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygxLCJpZHg6IixpZHgsInNwZWNpZXM6IixkYXRhLm9ydGhvTGlzdFtpZHhdLCJ0cmFpdCBkYXRhOiIsZGF0YS50cmFpdE5hbWUpOw0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJkYXRhLm9ydGhvTGlzdFtpZHhdOiIsZGF0YS5vcnRob0xpc3RbaWR4XS50cmFpdE5hbWUsZGF0YS50cmFpdE5hbWUpOw0KICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygyKTsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZGF0YS5vcnRob0xpc3RbaWR4XToiLGRhdGEub3J0aG9MaXN0W2lkeF0sZGF0YS50cmFpdE5hbWUpOw0KICAgICAgICAgICAgICByZXR1cm4gMjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAgIH0NCiAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgIC8vIH0NCiAgICB9LA0KICAgDQogICAgc2VhcmNoRmlsdGVyKCl7DQogICAgICBpZih0aGlzLmZvcm0ucXVlcnlTcGVjaWVzPT0iIiAmJiB0aGlzLmZvcm0uZ2VuZT09IiIpew0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCdQbGVhc2UgZW50ZXIgcXVlcnkgY3JpdGVyaWEnKTsNCiAgICAgIH1lbHNlew0KICAgICAgICBpZih0aGlzLmNsYXNzaWZpY2F0aW9uPT0iYW5pbWFsIil7DQogICAgICAgICAgdGhpcy5sb2FkaW5nX2FuaW1hbD10cnVlOw0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICB0aGlzLmxvYWRpbmdfcGxhbnQ9dHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLmdldFRyYWl0RGF0YSh0aGlzLnRyYWl0SXRlbS50cmFpdERlZklELHRoaXMuY2xhc3NpZmljYXRpb24pDQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgIHRoaXMubWVzc2FnRXJyb3IodGhpcy5jbGFzc2lmaWNhdGlvbikNCiAgICAgICAgfSwgMTAwMCk7DQogICAgICB9DQogICAgfSwgDQogICAgIG1lc3NhZ0Vycm9yKHR5cGUpew0KICAgICAgaWYodHlwZT09J3BsYW50Jyl7DQogICAgICAgIGlmKHRoaXMudG90YWxTaXplX3BsYW50PT0wKXsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ05vIGRhdGEgZm91bmQnKTsNCiAgICAgICAgICB9DQogICAgICB9ZWxzZXsNCiAgICAgICAgICBpZih0aGlzLnRvdGFsU2l6ZV9hbmltYWw9PTApew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcignTm8gZGF0YSBmb3VuZCcpOw0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICBjbGVhckZpbHRlcigpew0KICAgICAgaWYodGhpcy5mb3JtLnF1ZXJ5U3BlY2llcyE9PSIiIHx8IHRoaXMuZm9ybS5nZW5lIT09IiIpew0KDQogICAgICAgIGlmKHRoaXMuY2xhc3NpZmljYXRpb249PSJhbmltYWwiKXsNCiAgICAgICAgICB0aGlzLmxvYWRpbmdfYW5pbWFsPXRydWU7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgIHRoaXMubG9hZGluZ19wbGFudD10cnVlOw0KICAgICAgICB9DQogICAgICAgIHRoaXMuZm9ybS5xdWVyeVNwZWNpZXM9IiINCiAgICAgICAgdGhpcy5mb3JtLmdlbmU9IiINCiAgICAgICAgdGhpcy5nZXRUcmFpdERhdGEodGhpcy50cmFpdEl0ZW0udHJhaXREZWZJRCwiYW5pbWFsIikNCiAgICAgICAgdGhpcy5nZXRUcmFpdERhdGEodGhpcy50cmFpdEl0ZW0udHJhaXREZWZJRCwicGxhbnQiKQ0KICAgICAgICANCiAgICAgIH0NCiAgICB9LA0KICAgIGFzeW5jIHNob3dUYWJsZUljb24oZGF0YSxjbGFzc3NzKXsNCiAgICAgIA0KICAgICAgaWYoY2xhc3NzcyA9PSAicGxhbnQiKXsNCiAgICAgICAgdGhpcy5zcGVjaWVzTGlzdF9wbGFudD1bXTsNCiAgICAgICAgdGhpcy5zcGVjaWVzTGlzdF9wbGFudF8xPVtdOw0KICAgICAgICBpZihkYXRhLmxlbmd0aD4wKXsNCiAgICAgICAgICBmb3IobGV0IHZhckRhdGEgb2YgZGF0YSl7DQogICAgICAgICAgICAvLyDlop7liqDkuIDkuKrlsZ7mgKfkv53lrZjniannp43nmoRpbmRleO+8jOeUqOadpeaYvuekuuihqOagvOmHjOeahGljb24NCiAgICAgICAgICAgIHZhckRhdGEuc3BlY2llc0xpc3REYXRhPVtdOw0KICAgICAgICAgICAgLy8g5aKe5Yqg5LiA5Liq5bGe5oCn77yM5L+d5a2Y5pi+56S65pyJdHJhaXTmlbDmja7nmoTmg4XlhrUNCiAgICAgICAgICAgIHZhckRhdGEudHJhaXRMaXN0RGF0YTE9W107DQogICAgICAgICAgICB2YXJEYXRhLnRyYWl0TGlzdERhdGEyPVtdOw0KICAgICAgICAgICAgaWYodmFyRGF0YS5vcnRob0xpc3Qpew0KICAgICAgICAgICAgICBmb3IobGV0IGl0ZW0gb2YgdmFyRGF0YS5vcnRob0xpc3Qpew0KICAgICAgICAgICAgICAgIGxldCBzcGVjaWVzTmFtZT1pdGVtLnNwZWNpZXMuY29tbW9uTmFtZQ0KICAgICAgICAgICAgICAgIGlmKHRoaXMuc3BlY2llc0xpc3RfcGxhbnQuaW5kZXhPZihzcGVjaWVzTmFtZSk9PS0xKXsNCiAgICAgICAgICAgICAgICAgIHRoaXMuc3BlY2llc0xpc3RfcGxhbnQucHVzaChzcGVjaWVzTmFtZSk7DQogICAgICAgICAgICAgICAgICBpdGVtLnNwZWNpZXMuY2hlY2tlZD10cnVlOw0KICAgICAgICAgICAgICAgICAgdGhpcy5zcGVjaWVzTGlzdF9wbGFudF8xLnB1c2goaXRlbS5zcGVjaWVzKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdmFyRGF0YS5zcGVjaWVzTGlzdERhdGEucHVzaCh0aGlzLnNwZWNpZXNMaXN0X3BsYW50LmluZGV4T2Yoc3BlY2llc05hbWUpKTsNCiAgICAgICAgICAgICAgICBpZihpdGVtLnRyYWl0TmFtZSAhPT0gbnVsbCl7DQogICAgICAgICAgICAgICAgICB2YXJEYXRhLnRyYWl0TGlzdERhdGEyLnB1c2godGhpcy5zcGVjaWVzTGlzdF9wbGFudC5pbmRleE9mKHNwZWNpZXNOYW1lKSkNCiAgICAgICAgICAgICAgICAgIGlmKGl0ZW0udHJhaXROYW1lPT12YXJEYXRhLnRyYWl0TmFtZSl7DQogICAgICAgICAgICAgICAgICAgICAgdmFyRGF0YS50cmFpdExpc3REYXRhMS5wdXNoKHRoaXMuc3BlY2llc0xpc3RfcGxhbnQuaW5kZXhPZihzcGVjaWVzTmFtZSkpDQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMuJHJlZnNbJ3RhYmxlJ10uZG9MYXlvdXQoKTsNCiAgICAgICAgfQ0KICAgIH1lbHNlew0KICAgICAgdGhpcy5zcGVjaWVzTGlzdF9hbmltYWw9W107DQogICAgICANCiAgICAgIGNvbnNvbGUubG9nKCJ0aGlzLnNwZWNpZXNMaXN0X3BsYW50OiIsdGhpcy5zcGVjaWVzTGlzdF9wbGFudCk7DQogICAgICB0aGlzLnNwZWNpZXNMaXN0X2FuaW1hbF8xPVtdOw0KICAgICAgICBpZihkYXRhLmxlbmd0aD4wKXsNCiAgICAgICAgICBmb3IobGV0IHZhckRhdGEgb2YgZGF0YSl7DQogICAgICAgICAgICAvLyDlop7liqDkuIDkuKrlsZ7mgKfkv53lrZjniannp43nmoRpbmRleO+8jOeUqOadpeaYvuekuuihqOagvOmHjOeahGljb24NCiAgICAgICAgICAgIHZhckRhdGEuc3BlY2llc0xpc3REYXRhPVtdOw0KICAgICAgICAgICAgdmFyRGF0YS50cmFpdExpc3REYXRhMT1bXTsNCiAgICAgICAgICAgIHZhckRhdGEudHJhaXRMaXN0RGF0YTI9W107DQogICAgICAgICAgICBpZih2YXJEYXRhLm9ydGhvTGlzdCl7DQogICAgICAgICAgICAgIGZvcihsZXQgaXRlbSBvZiB2YXJEYXRhLm9ydGhvTGlzdCl7DQogICAgICAgICAgICAgICAgbGV0IHNwZWNpZXNOYW1lPWl0ZW0uc3BlY2llcy5jb21tb25OYW1lOw0KICAgICAgICAgICAgICAgIGlmKHRoaXMuc3BlY2llc0xpc3RfYW5pbWFsLmluZGV4T2Yoc3BlY2llc05hbWUpPT0tMSl7DQogICAgICAgICAgICAgICAgICB0aGlzLnNwZWNpZXNMaXN0X2FuaW1hbC5wdXNoKHNwZWNpZXNOYW1lKTsNCiAgICAgICAgICAgICAgICAgIGl0ZW0uc3BlY2llcy5jaGVja2VkPXRydWU7DQogICAgICAgICAgICAgICAgICB0aGlzLnNwZWNpZXNMaXN0X2FuaW1hbF8xLnB1c2goaXRlbS5zcGVjaWVzKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdmFyRGF0YS5zcGVjaWVzTGlzdERhdGEucHVzaCh0aGlzLnNwZWNpZXNMaXN0X2FuaW1hbC5pbmRleE9mKHNwZWNpZXNOYW1lKSk7DQogICAgICAgICAgICAgICAgaWYoaXRlbS50cmFpdE5hbWUgIT09IG51bGwpew0KICAgICAgICAgICAgICAgICAgLy8g5pyJdHJhaXTkvYbkuI3nm7jlkIwNCiAgICAgICAgICAgICAgICAgICB2YXJEYXRhLnRyYWl0TGlzdERhdGEyLnB1c2godGhpcy5zcGVjaWVzTGlzdF9hbmltYWwuaW5kZXhPZihzcGVjaWVzTmFtZSkpDQogICAgICAgICAgICAgICAgICBpZihpdGVtLnRyYWl0TmFtZT09dmFyRGF0YS50cmFpdE5hbWUpew0KICAgICAgICAgICAgICAgICAgICAvLyDmnInnm7jlkIx0cmFpdA0KICAgICAgICAgICAgICAgICAgICAgIHZhckRhdGEudHJhaXRMaXN0RGF0YTEucHVzaCh0aGlzLnNwZWNpZXNMaXN0X2FuaW1hbC5pbmRleE9mKHNwZWNpZXNOYW1lKSkNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkYXRhKTsNCiAgICB9LA0KICAgIC8vIOS4u+imgeiOt+WPluaVsOaNrueahOaWueazlQ0KICAgIC8vIOagueaNruWKqOakjeeJqeWIhuW8gOiOt+WPlg0KICAgIGFzeW5jIGdldFRyYWl0RGF0YSh0cmFpdElkLGNsYXNzaWZpY2F0aW9uLGhkYklkKXsNCiAgICAgIC8vIGNvbnNvbGUubG9nKCJwYXJhbXM6IixwYXJhbXMpOw0KICAgICAgLy8gbGV0IHRyYWl0SWQ9cGFyYW1zLnRyYWl0SWQ7DQogICAgICAvLyBsZXQgY2xhc3NpZmljYXRpb249cGFyYW1zLmNsYXNzaWZpY2F0aW9uOw0KICAgICAgLy8gbGV0IHBhZ2VzaXplPXBhcmFtcy5wYWdlc2l6ZTsNCiAgICAgIC8vIGxldCBwYWdlbnVtPXBhcmFtcy5wYWdlbnVtOw0KICAgICAgLy8gbGV0IHNwZWNpZXNOYW1lPXBhcmFtcy5zcGVjaWVzTmFtZTsNCiAgICAgIC8vIGxldCBnZW5lSWQ9cGFyYW1zLmdlbmVJZDsNCiAgICAgIC8vIGxldCBoZGJJZD1wYXJhbXMuaGRiSWQ7DQoNCiAgICAgIGlmKHRoaXMuZm9ybS5nZW5lIT09JycgJiYgdGhpcy5mb3JtLmdlbmUgIT09dW5kZWZpbmVkKXsNCiAgICAgICAgdGhpcy5mb3JtLmdlbmU9dGhpcy5mb3JtLmdlbmUudHJpbSgpDQogICAgICB9DQogICAgICBsZXQgcGFnZU5vOw0KICAgICAgaWYoY2xhc3NpZmljYXRpb249PSJhbmltYWwiKXtwYWdlTm89dGhpcy5jdXJyZW50UGFnZTRfYX1lbHNlIGlmKGNsYXNzaWZpY2F0aW9uPT0icGxhbnQiKXsNCiAgICAgICAgcGFnZU5vPXRoaXMuY3VycmVudFBhZ2U0X3ANCiAgICAgIH1lbHNle3BhZ2VObz0xfQ0KICAgICAgLy8gY29uc29sZS5sb2coJ2NsYXNzaWZpY2F0aW9uJywgY2xhc3NpZmljYXRpb24sJ3RyYWl0SWQnLHRyYWl0SWQsJ2xlbmd0aCcsdGhpcy5wYWdlU2l6ZSwncGFnZU5vJyxwYWdlTm8sJ3NwZWNpZXNOYW1lJyx0aGlzLmZvcm0ucXVlcnlTcGVjaWVzLCdnZW5lSWQnLHRoaXMuZm9ybS5nZW5lLCJoZGJJZCIsaGRiSWQpOw0KICAgICAgdGhpcy4kYXhpb3MuZ2V0KCJodHRwOi8vbG9jYWxob3N0Ojk0MDEvYXBpL3RyYWl0cyIse3BhcmFtczp7J2NsYXNzaWZpY2F0aW9uJzogY2xhc3NpZmljYXRpb24sJ3RyYWl0SWQnOnRyYWl0SWQsJ2xlbmd0aCc6dGhpcy5wYWdlU2l6ZSwncGFnZU5vJzpwYWdlTm8sJ3NwZWNpZXNOYW1lJzp0aGlzLmZvcm0ucXVlcnlTcGVjaWVzLCdnZW5lSWQnOnRoaXMuZm9ybS5nZW5lLCJoZGJJZCI6aGRiSWR9fSkNCiAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gew0KICAgICAgICBpZihjbGFzc2lmaWNhdGlvbj09ImFuaW1hbCIpew0KICAgICAgICAgIHRoaXMuZ2V0U3BlY2llcyh0cmFpdElkLCdhbmltYWwnKQ0KICAgICAgICAgIGNvbnNvbGUubG9nKCJyZXNwb25zZS5kYXRhLnJlY29yZHNUb3RhbDoiLHJlc3BvbnNlLmRhdGEpOw0KICAgICAgICAgIHRoaXMudG90YWxTaXplX2FuaW1hbCA9IHJlc3BvbnNlLmRhdGEucmVjb3Jkc1RvdGFsOw0KICAgICAgICAgIC8vIHRoaXMuc3BlY2llc0xpc3RfYW5pbWFsPXJlc3BvbnNlLmRhdGEuZGF0YVswXS5oZWFkZXJMaXN0Ow0KICAgICAgICAgIHRoaXMuc2hvd1RhYmxlSWNvbihyZXNwb25zZS5kYXRhLmRhdGEsY2xhc3NpZmljYXRpb24pLnRoZW4oKHJlcyk9PnsgdGhpcy50cmFpdERhdGFfYW5pbWFsPXJlczt0aGlzLmxvYWRpbmdfYW5pbWFsPWZhbHNlO30pOw0KICAgICAgICAgIA0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICB0aGlzLmdldFNwZWNpZXModHJhaXRJZCwncGxhbnQnKQ0KICAgICAgICAgIHRoaXMudG90YWxTaXplX3BsYW50ID0gcmVzcG9uc2UuZGF0YS5yZWNvcmRzVG90YWw7DQogICAgICAgICAgLy8gdGhpcy5zcGVjaWVzTGlzdF9wbGFudD1yZXNwb25zZS5kYXRhLmRhdGFbMF0uaGVhZGVyTGlzdDsNCiAgICAgICAgICB0aGlzLnNob3dUYWJsZUljb24ocmVzcG9uc2UuZGF0YS5kYXRhLGNsYXNzaWZpY2F0aW9uKS50aGVuKChyZXMpPT57IHRoaXMudHJhaXREYXRhX3BsYW50PXJlczsgdGhpcy5sb2FkaW5nX3BsYW50PWZhbHNlO30pOw0KICAgICAgICAgDQogICAgICAgIH0NCg0KICAgICAgfSkNCiAgICAgIC5maW5hbGx5KCgpPT57IHJldHVybiBQcm9taXNlLnJlc29sdmUoKX0pDQogICANCiAgICB9LA0KICAgIC8vIOagueaNruW9k+WJjWNsYXNzaWZpY2F0aW9u5Yik5pat6I635Y+W5Yqo54mp5oiW5qSN54mp5YiX6KGoDQogICAgZ2V0U3BlY2llcyh0cmFpdElELHNwZWNpZXNUeXBlKXsNCiAgICAgIHRoaXMuJGF4aW9zLmdldCgnaHR0cDovL2xvY2FsaG9zdDo5NDAxL2FwaS9zcGVjaWVzLXRyYWl0Jyx7cGFyYW1zOiB7J3RyYWl0SUQnOnRyYWl0SUQsc3BlY2llc1R5cGU6IHNwZWNpZXNUeXBlfX0pDQogICAgICAgIC50aGVuKHJlc3BvbnNlPT57DQogICAgICAgICAgLy8gMuaYr+akjeeJqe+8jDHmmK/liqjniakNCiAgICAgICAgICBpZihzcGVjaWVzVHlwZT09J3BsYW50Jyl7DQogICAgICAgICAgICB0aGlzLnF1ZXJ5U3BlY2llc0xpc3RfcGxhbnQ9cmVzcG9uc2UuZGF0YTsNCiAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIHRoaXMucXVlcnlTcGVjaWVzTGlzdF9hbmltYWw9cmVzcG9uc2UuZGF0YTsNCiAgICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgIGV4cG9ydDJFeGNlbCgpIHsNCiAgICAgICAgICByZXF1aXJlLmVuc3VyZShbXSwgKCkgPT4gew0KICAgICAgICAgICAgY29uc3QgeyBleHBvcnRfanNvbl90b19leGNlbCB9ID0gcmVxdWlyZSgnLi4vLi4vdmVuZG9yL0V4cG9ydDJFeGNlbCcpOw0KICAgICAgICAgICAgY29uc3QgdEhlYWRlciA9IFsn5bqP5Y+3JywgJ0lNU0knLCAnTVNJU0ROJywgJ+WPt+eggScsICflp5PlkI0nXTsNCiAgICAgICAgICAgIGNvbnN0IGZpbHRlclZhbCA9IFsnSUQnLCAnaW1zaScsICdtc2lzZG4nLCAnYWRkcmVzcycsICduYW1lJ107DQogICAgICAgICAgICBjb25zdCBsaXN0ID0gdGhpcy50YWJsZURhdGE7DQogICAgICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5mb3JtYXRKc29uKGZpbHRlclZhbCwgbGlzdCk7DQogICAgICAgICAgICBleHBvcnRfanNvbl90b19leGNlbCh0SGVhZGVyLCBkYXRhLCAn5YiX6KGoZXhjZWwnKTsNCiAgICAgICAgICB9KQ0KICAgICAgICAgIH0sDQogICAgICAgICAgICBmb3JtYXRKc29uKGZpbHRlclZhbCwganNvbkRhdGEpIHsNCiAgICAgICAgICByZXR1cm4ganNvbkRhdGEubWFwKHYgPT4gZmlsdGVyVmFsLm1hcChqID0+IHZbal0pKQ0KICAgICAgfSwNCiAgICAgIGNsZWFyVHJhaXRGaWx0ZXIoKXsNCiAgICAgICAgdGhpcy50cmFpdEl0ZW09ew0KICAgICAgICAgIHRyYWl0TmFtZToiIiwNCiAgICAgICAgICB0cmFpdElkOiIiLA0KICAgICAgICAgIHRyYWl0RGVmSUQ6IiIsDQogICAgICAgICAgZGVmaW5pdGlvbjoiIiwNCiAgICAgICAgICBjbGFzc2lmaWNhdGlvbjoiIg0KICAgICAgICB9DQogICAgICAgIGlmKHRoaXMuY2xhc3NpZmljYXRpb249PSdhbmltYWwnKXt0aGlzLmxvYWRpbmdfYW5pbWFsPXRydWV9ZWxzZXt0aGlzLmxvYWRpbmdfcGxhbnQ9dHJ1ZX0NCiAgICAgICAgdGhpcy5zaG93VGl0bGU9ZmFsc2U7DQogICAgICAgIHRoaXMuZ2V0VHJhaXREYXRhKCIiLCJhbmltYWwiKTsNCiAgICAgICAgdGhpcy5nZXRUcmFpdERhdGEoIiIsInBsYW50Iik7DQogICAgICB9DQogIH0sDQogIA0KDQogIG1vdW50ZWQoKSB7DQogICAgaWYodGhpcy5jbGFzc2lmaWNhdGlvbj09J2FuaW1hbCcpew0KICAgICAgdGhpcy5sb2FkaW5nX2FuaW1hbCA9IHRydWU7DQogICAgfWVsc2V7DQogICAgICB0aGlzLmxvYWRpbmdfcGxhbnQ9dHJ1ZTsNCiAgICB9DQogICAgbGV0IGhkYklkID0gdGhpcy4kcm91dGUucXVlcnkuaGRiSWQ7DQogICAgdGhpcy5oZGJJZD1oZGJJZDsNCiAgICAvLyBpZihoZGJJZCE9bnVsbCAmJiBoZGJJZCE9IiIpe30NCiAgICBpZihoZGJJZCE9IiImJmhkYklkIT1udWxsKXsNCiAgICAgIGxldCBjbGFzc2lmaWNhdGlvbjsNCiAgICAgIGlmKHRoaXMuJHJvdXRlLnF1ZXJ5LnNwZWNpZXNUeXBlPT0xKXsNCiAgICAgICAgY2xhc3NpZmljYXRpb249ImFuaW1hbCI7DQogICAgICAgIHRoaXMuY2xhc3NpZmljYXRpb249ImFuaW1hbCI7DQogICAgICB9ZWxzZSBpZih0aGlzLiRyb3V0ZS5xdWVyeS5zcGVjaWVzVHlwZT09Mil7DQogICAgICAgIGNsYXNzaWZpY2F0aW9uPSJwbGFudCI7DQogICAgICAgIHRoaXMuY2xhc3NpZmljYXRpb249InBsYW50IjsNCiAgICAgIH0NCiAgICAgDQogICAgICB0aGlzLnRyYWl0SXRlbT17DQogICAgICAgICAgdHJhaXROYW1lOiIiLA0KICAgICAgICAgIHRyYWl0SWQ6IiIsDQogICAgICAgICAgdHJhaXREZWZJRDoiIiwNCiAgICAgICAgICBkZWZpbml0aW9uOiIiLA0KICAgICAgICAgIGNsYXNzaWZpY2F0aW9uOiIiDQogICAgICAgIH0NCiAgICAgICAgdGhpcy5zaG93VGl0bGU9ZmFsc2U7DQogICAgICAgIHRoaXMuZ2V0VHJhaXREYXRhKCIiLGNsYXNzaWZpY2F0aW9uLGhkYklkKTsNCiAgICB9ZWxzZXsNCiAgICAgIHRoaXMuZ2V0VHJhaXREYXRhKHRoaXMudHJhaXRJdGVtLnRyYWl0RGVmSUQsdGhpcy50cmFpdEl0ZW0uY2xhc3NpZmljYXRpb24pOw0KICAgIH0NCg0KICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJzY3JvbGwiLCB0aGlzLndhdGNoU2Nyb2xsKTsNCiAgICANCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigic2Nyb2xsIiwgdGhpcy53YXRjaFNjcm9sbCk7DQogICAgICB0aGlzLmdldFRhYmxlTWF4SGVpZ2h0KCk7IA0KICAgICAgbGV0IF90aGlzID0gdGhpczsNCiAgICAgIHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uICgpIHsvL+eUqOS6juS9v+ihqOagvOmrmOW6puiHqumAguW6lOeahOaWueazlSAgDQogICAgICBfdGhpcy5nZXRUYWJsZU1heEhlaWdodCgpOy8v6I635Y+W5a655Zmo5b2T5YmN6auY5bqm77yM6YeN6K6+6KGo5qC855qE5pyA5aSn6auY5bqmDQogICAgfQ0KICAgIA0KICB9DQp9DQoNCg=="},{"version":3,"sources":["Traits.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwoBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Traits.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div>\r\n    <HeaderBar />\r\n    <Banner />\r\n    <!-- <Navigator /> -->\r\n    \r\n    <!-- 左侧树结构 -->\r\n    <!-- 抽屉结构 -->\r\n    <el-drawer\r\n      :visible.sync=\"drawer\"\r\n      :direction=\"direction\"\r\n    >\r\n      <div class=\"tree-div\">\r\n      <el-card shadow=\"none\" class=\"tree-card\" >\r\n      <el-input placeholder=\"Enter keywords to filter\" v-model=\"filterText\" class=\"filterInput\"> \r\n      </el-input>\r\n\r\n      <el-tree\r\n        style=\"margin-top: 15px\"\r\n        class=\"filter-tree\"\r\n        :data=\"treedata\"\r\n        default-expand-all\r\n        :filter-node-method=\"filterNode\"\r\n        icon-class=\"el-icon-s-management\"\r\n        ref=\"tree\"\r\n        :expand-on-click-node=\"false\"\r\n        @node-click=\"getInfoByTrait\"\r\n      >\r\n      </el-tree>\r\n      </el-card>\r\n    </div>\r\n    </el-drawer>\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\" class=\"arrow-title\">\r\n      <el-breadcrumb-item :to=\"{ path: '/gene' }\">Browse</el-breadcrumb-item>\r\n      <el-breadcrumb-item>Traits</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <!-- 侧边栏按钮 -->\r\n  \r\n  <el-container style=\"border: 1px solid #eee;overflow: hidden;\" id=\"trait-container\">\r\n  <div style=\"margin-top:3%\">\r\n  <div class=\"button-wrapper\">\r\n   <el-button @click=\"buttonFunction()\" ref=\"button\" id=\"button\"></el-button>\r\n   <!-- <div class=\"button-text\">Trait Ontology</div> -->\r\n  </div>\r\n  <!-- 灰色title横幅 -->\r\n   <transition name=\"el-zoom-in-top\">\r\n      <div class=\"trait-box trait-infoBox\"  v-show=\"showTitle\">\r\n        <div style=\"padding-left:29px;margin-top: -15px;\">\r\n          <h2 class=\"trait-title\">Selected Trait : {{ traitItem.traitName }} | ID: {{ traitItem.traitId }}</h2\r\n          >\r\n          <h2 class=\"trait-def trait-title\" v-if=\"traitItem.traitDef != ''\"\r\n            >Definition: {{ traitItem.definition }}</h2\r\n          >\r\n          \r\n        </div>\r\n         <el-button @click=\"clearTraitFilter\" icon=\"el-icon-remove-outline\" round class=\"remove-button\">Remove filter</el-button>\r\n      </div>\r\n      \r\n    </transition>\r\n   \r\n    </div>\r\n    <el-card shadow=\"none\" class=\"border-card\">\r\n    <el-tabs v-model=\"classification\" style=\"margin-top:10px;\" @tab-click=\"changeClass\">\r\n    <!-- 动物tab -->\r\n    <el-tab-pane label=\"Animal\" name=\"animal\" >\r\n      <!-- <el-card shadow=\"none\" class=\"tableCard\" style=\"margin-top: 10px\"> -->\r\n      <div>\r\n        <div>\r\n            <div class=\"filt-div\">\r\n                <el-input v-model=\"form.gene\" placeholder=\"Query gene\" class=\"gene-input\" clearable></el-input>\r\n                <el-select v-model=\"form.querySpecies\" class=\"filt-spe-select\" clearable placeholder=\"Query species\">\r\n                    <el-option\r\n                        v-for=\"(item,index) in querySpeciesList_animal\"\r\n                        :key=\"index\"\r\n                        :label=\"item\"\r\n                        :value=\"item\"\r\n                        >\r\n                    </el-option>\r\n                </el-select>\r\n                <el-button icon=\"el-icon-search\" type=\"success\"  plain id=\"filter-search\" @click=\"searchFilter()\">Search</el-button>\r\n                <el-button icon=\"el-icon-delete\" type=\"primary\"  plain id=\"filter-search2\" @click=\"clearFilter()\">Clear</el-button>\r\n\r\n                <el-button type=\"primary\" plain size=\"mini\" @click=\"exportOrderData()\">导出</el-button>\r\n\r\n                <el-popover\r\n                  placement=\"bottom-end\"\r\n                  width=\"400\"\r\n                  trigger=\"manual\"\r\n                  class=\"popbox\"\r\n                  v-model=\"visible_1\">\r\n                    <div class=\"checkbox-box\">\r\n                      <el-checkbox v-for=\"item of speciesList_animal_1\" :key=\"item.commonName\" :label=\"item.commonName\" class=\"chooseColBox\" ref=\"one\" v-model=\"item.checked\"></el-checkbox>\r\n                    </div>\r\n                    <div class=\"botton-wrapper\">\r\n                      <el-button size=\"mini\" type=\"primary\"  @click=\"confirmbutton\" class=\"choose-col-button\">Close</el-button>\r\n                      <!-- <el-button size=\"mini\" type=\"text\" plain @click=\"visible_1 = false\" class=\"choose-col-button\">cancel</el-button> -->\r\n                    </div>\r\n                  <el-button slot=\"reference\" icon=\"el-icon-s-grid\" type=\"primary\" plain id=\"filterCol\" @click=\"visible_1 = !visible_1\" :disabled=\"speciesList_animal_1.length==0\"></el-button>\r\n                </el-popover>\r\n\r\n\r\n\r\n            </div>\r\n          <!-- </el-card> -->\r\n          <div id=\"wrapper\"  >\r\n          <div class=\"trait-info\">\r\n            \r\n      <!-- 使用中的trait表格 -->\r\n      <!-- <el-container style=\"width:100%;border: 1px solid darkgray;\"> -->\r\n        \r\n          <el-table\r\n            :data=\"traitData_animal\"\r\n            class=\"trait-table\"\r\n            row-key=\"id\"\r\n            ref=\"table\"\r\n            :header-cell-style=\"hiligtDbCols\"\r\n            v-loading=\"loading_animal\"\r\n            id=\"out-table\"\r\n            border\r\n          >\r\n            <el-table-column align=\"center\" class=\"titleCell\" prop=\"traitName\" label=\"Trait Name\" fixed width=\"280px\" style=\"background-color:white\"></el-table-column>\r\n            <el-table-column align=\"center\" prop=\"geneId\" label=\"Gene Id\" width=\"220px\" fixed>\r\n              <template slot-scope=\"scope\">\r\n                \r\n                <a :href=\"'./gene-detail?hdbId='+scope.row.hdbId+'&taxonId='+scope.row.taxonId\">\r\n                    {{ scope.row.geneId }}\r\n                </a>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column align=\"center\" prop=\"speciesCommonName\" label=\"Species Name\" width=\"150px\" fixed></el-table-column>\r\n            <el-table-column align=\"center\" prop=\"taxonId\" label=\"Taxon Id\" width=\"160px\" fixed>\r\n               <template slot-scope=\"scope\">\r\n                <a :href=\"'https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id='+scope.row.taxonId+'&lvl=3&lin=f&keep=1&srchmode=1&unlock'\">\r\n                    {{ scope.row.taxonId }}\r\n                </a>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column align=\"center\" prop=\"speciesCommonName\" label=\"Homolog Species Name\">\r\n            <template v-for=\"(item,index) in speciesList_animal_1\">\r\n              <el-table-column align=\"center\" :label=\"item.commonName\" :prop=\"item.commonName\" v-if=\"item.checked\" :key=\"item.commonName\">\r\n                <template slot-scope=\"scope\" >\r\n                  <img\r\n                    :src=\"orthoIcon\"\r\n                    min-width=\"70\"\r\n                    height=\"70\"\r\n                    class=\"iconImg\"\r\n                    v-if='scope.row.speciesListData.indexOf(index)>-1'\r\n                    style=\"cursor:pointer !important\"\r\n                    @click=showOrthoInfoTable(scope.row,index)\r\n                  />\r\n                  <!--这个v-if，先判断在当前的cell内有数值，然后再判断值 -->\r\n                  <img\r\n                    :src=\"singleTraitIcon\"\r\n                    min-width=\"70\"\r\n                    height=\"70\"\r\n                    class=\"iconImg\"\r\n                    v-if='scope.row.traitListData2.indexOf(index)>-1 '\r\n                    style=\"cursor:pointer !important\"\r\n                    @click=showGwasInfoTable(scope.row,index)\r\n                  />\r\n                   <img\r\n                    :src=\"sameTraitIcon\"\r\n                    min-width=\"70\"\r\n                    height=\"70\"\r\n                    class=\"iconImg\"\r\n                    v-if='scope.row.traitListData1.indexOf(index)>-1'\r\n                    style=\"cursor:pointer !important\"\r\n                    @click=showGwasInfoTable(scope.row,index)\r\n                  />\r\n                </template>\r\n              </el-table-column>\r\n            </template>\r\n            </el-table-column>\r\n          </el-table>\r\n      \r\n          <div style=\"position: absolute;float: left;\">\r\n          <div style=\"display: flex;\">\r\n                    <img :src=\"orthoIcon\"\r\n                      style=\"margin-right: 6px;min-width=70px;height=70px;\"\r\n                      class=\"iconImg\" />\r\n                      <div class=\"note-info\">exists homolog gene</div>\r\n          </div>\r\n          <div style=\"display: flex;\">\r\n                    <img :src=\"singleTraitIcon\"   \r\n                      style=\"margin-right: 6px;min-width=70px;height=70px;\"\r\n                      class=\"iconImg\" /><div class=\"note-info\">exists homolog gene with trait annotation</div>  \r\n          </div>\r\n          <div style=\"display: flex;\">\r\n                    <img :src=\"sameTraitIcon\"   \r\n                      style=\"margin-right: 6px;min-width=70px;height=70px;\"\r\n                      class=\"iconImg\" /><div class=\"note-info\">exists homolog gene with same trait annotation</div>  \r\n          </div>\r\n          \r\n          </div>\r\n          <el-pagination\r\n          \r\n            class=\"trait-pag\"\r\n            @size-change=\"handleSizeChange\"\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"currentPage4_a\"\r\n            :page-sizes=\"[10, 20, 50, 100]\"\r\n            :page-size=\"pageSize\"\r\n            layout=\"total, sizes, prev, pager, next, jumper\"\r\n            :total=\"totalSize_animal\"\r\n          >\r\n          </el-pagination>\r\n      <!-- </el-container> -->\r\n      </div>\r\n</div>\r\n\r\n    <!-- 同源表格 -->\r\n    <!-- <el-card shadow=\"none\" class=\"sub-table-card\"> -->\r\n      \r\n      <div class=\"sub-trait-box \" v-if=\"showOrthoSubTable\">\r\n      <el-divider class=\"divider\"></el-divider>\r\n      <div class=\"title-box\">\r\n          <!-- <div class=\"gene-info\">\r\n            <div class=\"gene-sub-title\">Selected Gene: {{selectGene.geneId}}</div>\r\n            <div class=\"gene-sub-title\">Organism: {{selectGene.speciesCommonName}}</div>\r\n          </div> -->\r\n          <template>\r\n              <el-descriptions title=\"Selected Gene\" >\r\n                <el-descriptions-item label=\"Gene Id\"><a :href=\"'./gene-detail?hdbId='+selectGene.hdbId+'&taxonId='+selectGene.taxonId\">\r\n                    {{ selectGene.geneId }}\r\n                </a></el-descriptions-item>\r\n                <el-descriptions-item label=\"Protein Id\"><a :href=\"'https://www.uniprot.org/uniprot/'+selectGene.hdbId\" target='_blank'>\r\n                    {{ selectGene.hdbId }}\r\n                </a></el-descriptions-item>\r\n                <el-descriptions-item label=\"Species Name\">{{selectGene.speciesCommonName}}</el-descriptions-item>\r\n                <el-descriptions-item label=\"Classification\">{{selectGene.classification}}</el-descriptions-item>\r\n                <el-descriptions-item label=\"Trait Ontology term\">\r\n                  <el-tag size=\"small\">{{selectGene.traitName}}</el-tag>\r\n                </el-descriptions-item>\r\n                <!-- <el-descriptions-item label=\"Address\"\r\n                  >No.1188, Wuzhong Avenue, Wuzhong District, Suzhou, Jiangsu\r\n                  Province</el-descriptions-item\r\n                > -->\r\n              </el-descriptions>\r\n            </template>\r\n          <el-divider></el-divider>\r\n          <h2 class=\"trait-sub-title\">Homolog Gene Detail Information</h2>\r\n      </div>\r\n      </div>\r\n      <!-- <div id=\"wrapper\"> -->\r\n          <div class=\"trait-info\">\r\n            <el-table\r\n              :data=\"orthoTableData\"\r\n              class=\"info-table\"\r\n              v-loading=\"orthoLoading\"\r\n              v-if=\"showOrthoSubTable\"\r\n              :border=\"false\"\r\n              :header-cell-style=\"{background:'#F5F7FA'}\"\r\n              fixed\r\n          >\r\n             <el-table-column\r\n                prop=\"commonName\"\r\n                label=\"Species\">\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"tax\"\r\n                label=\"Taxon Id\">\r\n              <template slot-scope=\"scope\">\r\n                <a :href=\"'https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id='+scope.row.tax+'&lvl=3&lin=f&keep=1&srchmode=1&unlock'\">\r\n                    {{ scope.row.tax }}\r\n                </a>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"ensemblGeneId\"\r\n                label=\"Ensembl Id\">\r\n            </el-table-column>\r\n              <el-table-column\r\n              prop=\"geneSymbol\"\r\n              label=\"Gene Symbol\">\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"hdbId\"\r\n                label=\"Protein Id\">\r\n                <template slot-scope=\"scope\" v-if=\"scope.row.hdbId.slice(0,2)!=='EN'\">\r\n              \r\n                  <a :href=\"'https://www.uniprot.org/uniprot/'+scope.row.hdbId\" target='_blank'>\r\n                      {{ scope.row.hdbId }}\r\n                  </a>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column  label=\"Data Source\" align=\"center\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-popover\r\n                        placement=\"top\"\r\n                        title=\"Data Source\"\r\n                        width=\"200\"\r\n                        trigger=\"hover\"\r\n                        :content=\"scope.row.dbEvidence\">\r\n                        <i class=\"el-icon-s-order\" slot=\"reference\" width=\"30px\"></i>\r\n                    </el-popover>\r\n                    \r\n                </template>\r\n            </el-table-column>\r\n            </el-table>\r\n          </div>\r\n\r\n      <!-- </div> -->\r\n    <!-- </el-card> -->\r\n\r\n      <!-- gwas 表格 -->\r\n    <!-- <el-card shadow=\"none\"  class=\"sub-table-card\"> -->\r\n       \r\n      <div class=\"sub-trait-box\" v-if=\"showSubTableBox\">\r\n        <div  class=\"title-box\" >\r\n          <h3 class=\"trait-sub-title\">GWAS Detail Information</h3>\r\n        </div>\r\n        <div id=\"trait-info\">\r\n            <!-- <el-card shadow=\"none\" class=\"gwasDetailCard\"> -->\r\n              <el-table \r\n                :data=\"gwasInfoData\"\r\n                id=\"subTable\"\r\n                :row-style=\"{height: '0'}\"\r\n                :header-cell-style=\"{background:'#F5F7FA'}\"\r\n                max-height=\"800\"\r\n                v-loading=\"gwasLoading\"\r\n              >\r\n                <el-table-column prop=\"topTrait\" label=\"Trait Name\"></el-table-column>\r\n                <!-- <el-table-column prop=\"mapGeneId\" label=\"Gene Id\"></el-table-column> -->\r\n                <el-table-column prop=\"orthoGeneId\" label=\"Gene Id\"></el-table-column>\r\n                <el-table-column prop=\"varId\" label=\"Var Id\">\r\n                  <template slot-scope=\"scope\">\r\n                    <a v-bind:href=\"'https://ngdc.cncb.ac.cn/gvm/snp/getSNPDetail?snpname='+scope.row.varId+'&chrom='+scope.row.chrom+'&position='+scope.row.endPos+'&orgId='+scope.row.orgId\" target='_blank'>\r\n                      {{ scope.row.varId }}\r\n                    </a>\r\n                  </template>\r\n                </el-table-column>\r\n                <!-- <el-table-column prop=\"orthoGeneId\" label=\"Ensembl Gene Id\"></el-table-column> -->\r\n                <el-table-column prop=\"traitName\" label=\"Sub Trait Name\"></el-table-column>\r\n                <el-table-column prop=\"speciesCommonName\" label=\"Species\"></el-table-column>\r\n                <el-table-column prop=\"pmid\" label=\"Pubmed Id\">\r\n                  <template slot-scope=\"scope\">\r\n                    <a v-bind:href=\"'https://pubmed.ncbi.nlm.nih.gov/'+scope.row.pmid\" target='_blank'>\r\n                      {{ scope.row.pmid }}\r\n                    </a>\r\n                  </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"pvalue\" label=\"Pvalue\"></el-table-column>\r\n              </el-table>\r\n            <!-- </el-card> -->\r\n        </div>\r\n      </div>\r\n    <!-- </el-card> -->\r\n      </div>\r\n      </div>\r\n      <!-- </div> -->\r\n      <!-- </el-card> -->\r\n    </el-tab-pane>\r\n     <!-- 植物tab -->\r\n    <el-tab-pane label=\"Plant\" name=\"plant\">\r\n      <div class=\"filt-div\">\r\n            <el-input v-model=\"form.gene\" placeholder=\"Query gene\" class=\"gene-input\" clearable></el-input>\r\n            <el-select v-model=\"form.querySpecies\" class=\"filt-spe-select\" clearable placeholder=\"Query species\">\r\n                <el-option\r\n                    v-for=\"(item,index) in querySpeciesList_plant\"\r\n                    :key=\"index\"\r\n                    :label=\"item\"\r\n                    :value=\"item\"\r\n                    >\r\n                </el-option>\r\n            </el-select>\r\n            <el-button icon=\"el-icon-search\" type=\"success\" plain id=\"filter-search\" @click=\"searchFilter()\">Search</el-button>\r\n            <el-button icon=\"el-icon-delete\" type=\"primary\" plain id=\"filter-search2\" @click=\"clearFilter()\">Clear</el-button>\r\n\r\n            <el-popover\r\n              placement=\"bottom-end\"\r\n              width=\"400\"\r\n              trigger=\"manual\"\r\n              class=\"popbox\"\r\n              v-model=\"visible\">\r\n                <div class=\"checkbox-box\">\r\n                  <el-checkbox v-for=\"item of speciesList_plant_1\" :key=\"item.commonName\" :label=\"item.commonName\" class=\"chooseColBox\" ref=\"one\" v-model=\"item.checked\"></el-checkbox>\r\n                <!-- <el-checkbox  class=\"chooseColBox\" @change=\"chooseall\" ref=\"all\">Choose All</el-checkbox> -->\r\n                </div>\r\n                <div class=\"botton-wrapper\">\r\n                  <el-button size=\"mini\" type=\"primary\"  @click=\"confirmbutton\" class=\"choose-col-button\">Close</el-button>\r\n                  <!-- <el-button size=\"mini\" type=\"text\" plain @click=\"visible = false\" class=\"choose-col-button\">cancel</el-button> -->\r\n                </div>\r\n                <el-button slot=\"reference\" icon=\"el-icon-s-grid\" type=\"primary\" plain id=\"filterCol\" @click=\"visible = !visible\" :disabled=\"speciesList_plant_1.length==0\"></el-button>\r\n            </el-popover>\r\n\r\n      </div>\r\n      <!-- <div class=\"wraper\"> -->\r\n        \r\n      <div class=\"trait-info\">\r\n   <!-- 使用中的表格 -->\r\n        <el-table\r\n            :data=\"traitData_plant\"\r\n            class=\"trait-table\"\r\n            row-key=\"id\"\r\n            v-loading=\"loading_plant\"\r\n            ref=\"table\"\r\n            :header-cell-style=\"hiligtDbCols\"\r\n            border\r\n          >\r\n            <el-table-column align=\"center\" class=\"titleCell\" prop=\"traitName\" label=\"Trait Name\" fixed width=\"280px\" style=\"background-color:white\"></el-table-column>\r\n            <el-table-column align=\"center\" prop=\"geneId\" label=\"Gene Id\" width=\"220px\" fixed>\r\n\t\t\t<template slot-scope=\"scope\">\r\n                \r\n                <a :href=\"'./gene-detail?hdbId='+scope.row.hdbId+'&taxonId='+scope.row.taxonId\">\r\n                    {{ scope.row.geneId }}\r\n                </a>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column align=\"center\" prop=\"speciesCommonName\" label=\"Species Name\" width=\"150px\" fixed></el-table-column>\r\n            <el-table-column align=\"center\" prop=\"taxonId\" label=\"Taxon Id\" width=\"160px\" fixed>\r\n              <template slot-scope=\"scope\">\r\n                <a :href=\"'https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id='+scope.row.taxonId+'&lvl=3&lin=f&keep=1&srchmode=1&unlock'\">\r\n                    {{ scope.row.taxonId }}\r\n                </a>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column align=\"center\" prop=\"speciesCommonName\" label=\"Homolog Species Name\">\r\n            <template v-for=\"(item,index) in speciesList_plant_1\">\r\n              <el-table-column align=\"center\" :label=\"item.commonName\" :prop=\"item.commonName\" v-if=\"item.checked\" :key=\"item.commonName\">\r\n            <!-- <el-table-column :label=\"item\" :show-overflow-tooltip=\"true\" :prop=\"item\" v-for=\"(item,index) in speciesList_plant\" :key=\"index\"\r\n              class=\"imglink\" height=\"100px\"> -->\r\n                  <template slot-scope=\"scope\" >\r\n                  <img\r\n                      :src=\"orthoIcon\"\r\n                      min-width=\"70\"\r\n                      height=\"70\"\r\n                      class=\"iconImg\"\r\n                      v-if='scope.row.speciesListData.indexOf(index)>-1'\r\n                      style=\"cursor:pointer\"\r\n                      @click=showOrthoInfoTable(scope.row,index)\r\n                    />\r\n                    <!--这个v-if，先判断在当前的cell内有数值，然后再判断值 -->\r\n                     <img\r\n                      :src=\"singleTraitIcon\"\r\n                      min-width=\"70\"\r\n                      height=\"70\"\r\n                      class=\"iconImg\"\r\n                      v-if='scope.row.traitListData2.indexOf(index)>-1'\r\n                      style=\"cursor:pointer !important\"\r\n                      @click=showGwasInfoTable(scope.row,index)\r\n                    />\r\n                    <img\r\n                      :src=\"sameTraitIcon\"\r\n                      min-width=\"70\"\r\n                      height=\"70\"\r\n                      class=\"iconImg\"\r\n                      v-if='scope.row.traitListData1.indexOf(index)>-1'\r\n                      style=\"cursor:pointer\"\r\n                      @click=showGwasInfoTable(scope.row,index)\r\n                    />\r\n                    \r\n                  </template>\r\n              </el-table-column>\r\n            </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        <div style=\"position: absolute;float: left;\">\r\n        <div style=\"display: flex;\">\r\n                    <img :src=\"orthoIcon\"\r\n                      style=\"margin-right: 6px;min-width=70px;height=70px;\"\r\n                      class=\"iconImg\" />\r\n                      <div class=\"note-info\">exists homolog gene</div>\r\n          </div>\r\n          <div style=\"display: flex;\">\r\n                    <img :src=\"singleTraitIcon\"   \r\n                      style=\"margin-right: 6px;min-width=70px;height=70px;\"\r\n                      class=\"iconImg\" /><div class=\"note-info\">exists homolog gene with trait annotation</div>  \r\n          </div>\r\n          <div style=\"display: flex;\">\r\n                    <img :src=\"sameTraitIcon\"   \r\n                      style=\"margin-right: 6px;min-width=70px;height=70px;\"\r\n                      class=\"iconImg\" /><div class=\"note-info\">exists homolog gene with same trait annotation</div>  \r\n          </div>\r\n        </div>\r\n        <el-pagination\r\n          class=\"trait-pag\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          :current-page=\"currentPage4_p\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :page-size=\"pageSize\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"totalSize_plant\"\r\n        >\r\n        </el-pagination>\r\n        <div class=\"sub-trait-box \" v-if=\"showOrthoSubTable\">\r\n      <el-divider class=\"divider\"></el-divider>\r\n          <div class=\"title-box\">\r\n            <template>\r\n              <el-descriptions title=\"Selected Gene\" >\r\n                <el-descriptions-item label=\"Gene Id\"><a :href=\"'./gene-detail?hdbId='+selectGene.hdbId+'&taxonId='+selectGene.taxonId\">\r\n                    {{ selectGene.geneId }}\r\n                </a></el-descriptions-item>\r\n                <el-descriptions-item label=\"Protein Id\"><a :href=\"'https://www.uniprot.org/uniprot/'+selectGene.hdbId\" target='_blank'>\r\n                    {{ selectGene.hdbId }}\r\n                </a></el-descriptions-item>\r\n\r\n                <el-descriptions-item label=\"Species Name\">{{selectGene.speciesCommonName}}</el-descriptions-item>\r\n                <el-descriptions-item label=\"Classification\">{{selectGene.classification}}</el-descriptions-item>\r\n                <el-descriptions-item label=\"Trait Ontology term\">\r\n                  <el-tag size=\"small\">{{selectGene.traitName}}</el-tag>\r\n                </el-descriptions-item>\r\n                <!-- <el-descriptions-item label=\"Address\"\r\n                  >No.1188, Wuzhong Avenue, Wuzhong District, Suzhou, Jiangsu\r\n                  Province</el-descriptions-item\r\n                > -->\r\n              </el-descriptions>\r\n            </template>\r\n          <el-divider></el-divider>\r\n          <h2 class=\"trait-sub-title\">Homolog Gene Detail Information</h2>\r\n          </div>\r\n      </div>\r\n    <!-- 同源表格 -->\r\n          <el-table\r\n            :data=\"orthoTableData\"\r\n            class=\"info-table\"\r\n            v-loading=\"orthoLoading\"\r\n            v-if=\"showOrthoSubTable\"\r\n            :header-cell-style=\"{background:'#F5F7FA'}\"\r\n            :border=\"false\"\r\n        >\r\n           <el-table-column\r\n                prop=\"commonName\"\r\n                label=\"Species\">\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"tax\"\r\n                label=\"Taxon Id\">\r\n              <template slot-scope=\"scope\">\r\n                <a :href=\"'https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id='+scope.row.tax+'&lvl=3&lin=f&keep=1&srchmode=1&unlock'\">\r\n                    {{ scope.row.tax }}\r\n                </a>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"ensemblGeneId\"\r\n                label=\"Ensembl Id\">\r\n                \r\n            </el-table-column>\r\n              <el-table-column\r\n              prop=\"geneSymbol\"\r\n              label=\"Gene Symbol\">\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"hdbId\"\r\n                label=\"Protein Id\">\r\n                <template slot-scope=\"scope\" v-if=\"scope.row.hdbId.slice(0,2)!=='EN'\">\r\n              \r\n                  <a :href=\"'https://www.uniprot.org/uniprot/'+scope.row.hdbId\" target='_blank'>\r\n                      {{ scope.row.hdbId }}\r\n                  </a>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column  label=\"Data Source\" align=\"center\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-popover\r\n                        placement=\"top\"\r\n                        title=\"Data Source\"\r\n                        width=\"200\"\r\n                        trigger=\"hover\"\r\n                        :content=\"scope.row.dbEvidence\">\r\n                        <i class=\"el-icon-s-order\" slot=\"reference\"></i>\r\n                    </el-popover>\r\n                    \r\n                </template>\r\n            </el-table-column>\r\n          </el-table>\r\n    <!-- gwas detail info表格 -->\r\n      <div class=\"sub-trait-box\" v-if=\"showSubTableBox\">\r\n        <div  class=\"title-box\">\r\n          <h3 class=\"trait-sub-title\">GWAS Detail Information</h3>\r\n        </div>\r\n        <div id=\"trait-info\">\r\n            <!-- <el-card shadow=\"none\" class=\"gwasDetailCard\"> -->\r\n              <el-table \r\n                :data=\"gwasInfoData\"\r\n                id=\"subTable\"\r\n                :row-style=\"{height: '0'}\"\r\n                :header-cell-style=\"{background:'#F5F7FA'}\"\r\n                max-height=\"800\"\r\n                v-loading=\"gwasLoading\"\r\n              >\r\n                <el-table-column prop=\"topTrait\" label=\"Trait Name\"></el-table-column>\r\n                <!-- <el-table-column prop=\"mapGeneId\" label=\"Gene Id\"></el-table-column> -->\r\n                <el-table-column prop=\"orthoGeneId\" label=\"Gene Id\"></el-table-column>\r\n                <el-table-column prop=\"varId\" label=\"Var Id\">\r\n                  <template slot-scope=\"scope\">\r\n                    <a v-bind:href=\"'https://ngdc.cncb.ac.cn/gvm/snp/getSNPDetail?snpname='+scope.row.varId+'&chrom='+scope.row.chrom+'&position='+scope.row.endPos+'&orgId='+scope.row.orgId\" target='_blank'>\r\n                      {{ scope.row.varId }}\r\n                    </a>\r\n                  </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"traitName\" label=\"Sub Trait Name\"></el-table-column>\r\n                <el-table-column prop=\"speciesCommonName\" label=\"Species\"></el-table-column>\r\n                <el-table-column prop=\"pmid\" label=\"Pubmed Id\">\r\n                  <template slot-scope=\"scope\">\r\n                    <a v-bind:href=\"'https://pubmed.ncbi.nlm.nih.gov/'+scope.row.pmid\" target='_blank'>\r\n                      {{ scope.row.pmid }}\r\n                    </a>\r\n                  </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"pvalue\" label=\"Pvalue\" align=\"center\"></el-table-column>\r\n              </el-table>\r\n            <!-- </el-card> -->\r\n        </div>\r\n      </div>\r\n      </div>\r\n    <!-- </div> -->\r\n     \r\n     \r\n      <!-- </el-card> -->\r\n    </el-tab-pane>\r\n    \r\n    \r\n    </el-tabs>\r\n    </el-card>\r\n    </el-container>\r\n    <FooterBar />\r\n    <template>\r\n     <el-backtop\r\n      :bottom=\"100\"\r\n      style=\"z-index: 999;\"\r\n      class=\"backTop\"\r\n    >\r\n      <div\r\n        style=\"\r\n           {\r\n            height: 100%;\r\n            width: 100%;\r\n            box-shadow: 0 0 6px rgba(0, 0, 0, 0.12);\r\n            text-align: center;\r\n            line-height: 40px;\r\n            color: #1989fa;\r\n            border-radius: 50%;\r\n            background-color: white;\r\n          }\r\n        \"\r\n      >\r\n      <i class=\"el-icon-caret-top\"></i>\r\n      </div>\r\n    </el-backtop>\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<style src=\"../assets/css/traits.css\" scoped></style>\r\n\r\n<script>\r\n// @ is an alias to /src\r\n// import Navigator from \"@/components/navigator.vue\";\r\nimport traitOntology from \"@/assets/static/traitOntology.json\";\r\nimport Banner from \"@/components/banner.vue\";\r\nimport FooterBar from \"@/components/FooterBar.vue\";\r\nimport HeaderBar from \"@/components/HeaderBar.vue\";\r\n// import qs from \"qs\";\r\n// // icons\r\nimport sameTraitIcon from \"@/assets/img/icon/star.svg\";\r\nimport orthoIcon from \"@/assets/img/icon/huafu.svg\";\r\nimport singleTraitIcon from \"@/assets/img/icon/orange.svg\";\r\n// import \"@/assets/css/traits.css\";\r\n// import FileSaver from 'file-saver'\r\n// import XLSX from 'xlsx'\r\nexport default {\r\n  name: \"Traits\",\r\n  components: {\r\n    // Navigator,\r\n    FooterBar,\r\n    HeaderBar,\r\n    Banner,\r\n    \r\n  },\r\n  watch: {\r\n    filterText(val) {\r\n      this.$refs.tree.filter(val);\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      sameTraitIcon,\r\n      orthoIcon,\r\n      singleTraitIcon,\r\n      visible:false,\r\n      visible_1:false,\r\n      filterText: \"\",\r\n      treedata: traitOntology.tree,\r\n      showSubTableBox:false,\r\n      gwasLoading:true,\r\n      orthoLoading:true,\r\n      drawer:false,\r\n      direction:\"ltr\",\r\n       // 保存同源物种，用于表格生成列\r\n      speciesList_animal:[],\r\n      speciesList_plant:[],\r\n       // 保存同源物种obj，用于动态选择列\r\n      speciesList_animal_1:[],\r\n      speciesList_plant_1:[],\r\n      traitData_animal: [],\r\n      traitData_plant:[],\r\n      orthoTableData: [],\r\n      value: \"\",\r\n      traitItem:{\r\n        traitName:\"growth and meat production trait\",\r\n        traitId:\"APTO:0000006\",\r\n        traitDefID:\"8971\",\r\n        definition:\"any measurable or observable characteristics related to animal growth and meat production quantity and quality\",\r\n        classification:\"animal\"\r\n      },\r\n      currentPage4_a: 1,\r\n      currentPage4_p: 1,\r\n      totalSize_animal: 0,\r\n      totalSize_plant: 0,\r\n      form: {\r\n        querySpecies:\"\",\r\n        gene:\"\"\r\n      },\r\n      pageSize: 10,\r\n      gwasInfoData:[],\r\n      loading:true,\r\n      loading_animal:false,\r\n      loading_plant:false,\r\n      showOrthoSubTable:false,\r\n      classification:\"animal\",\r\n      navBarFixed:\"false\",\r\n      showTraitSameIcon:false,\r\n       // 从接口获取所有有trait数据的物种，用于物种选择，提交search\r\n      querySpeciesList_animal:[],\r\n      querySpeciesList_plant:[],\r\n      querySpeciesList:[],\r\n      selectGene:{},\r\n      showTitle:true\r\n      \r\n    };\r\n  },\r\n\r\n  methods: {\r\n   \r\n    changeClass(tab){\r\n        this.speciesList=[];\r\n        this.showOrthoSubTable=false;\r\n        this.showSubTableBox=false;\r\n        this.$refs['table'].doLayout();\r\n        this.form.querySpecies='';\r\n        this.form.gene='';\r\n        // console.log(\"tab, event:\",tab, event);\r\n        this.classification=tab.name\r\n    },\r\n\r\n    confirmbutton(){\r\n    this.visible_1 = false;\r\n    this.visible = false;\r\n    this.$refs.table.doLayout();\r\n   },\r\n    handleSizeChange(val){\r\n      // this.loading = true;\r\n      // if(this.classification==\"animal\"){this.loading_animal=true;}else{this.loading_plant=true}\r\n      if(this.classification==\"animal\"){\r\n        this.currentPage4_a=1\r\n        this.loading_animal=true;\r\n      }else{\r\n        this.loading_plant=true\r\n        this.currentPage4_p=1\r\n      }\r\n      this.pageSize = val;\r\n      // let params={traitId:this.traitItem.traitDefID,classification:this.classification,pagesize:this.pageSize,pagenum:1,speciesName:this.form.querySpecies}\r\n      this.getTraitData(this.traitItem.traitDefID,this.classification,this.hdbId)\r\n    },\r\n    handleCurrentChange(val) {\r\n      if(this.classification==\"animal\"){\r\n        this.loading_animal=true;\r\n        this.currentPage4_a = val;\r\n      }else{\r\n        this.loading_plant=true;\r\n        this.currentPage4_p = val;\r\n      }\r\n      this.getTraitData(this.traitItem.traitDefID,this.classification,this.hdbId)\r\n\r\n    },\r\n    handleSelectionChange(val) {\r\n      this.multipleSelection = val;\r\n    },\r\n    filterNode(value, data) {\r\n      if (!value) return true;\r\n      return data.label.indexOf(value) !== -1;\r\n    },\r\n    getInfoByTrait(value, data) {\r\n      this.hdbId=\"\";\r\n      this.showTitle=true;\r\n      // 先隐藏现实的detail表格\r\n      this.showOrthoSubTable=false;\r\n      this.showSubTableBox=false;\r\n      this.traitItem.traitName=value.Name;\r\n      this.traitItem.traitId=value.traitID;\r\n      this.traitItem.traitDefID=value.traitDefID;\r\n      this.traitItem.definition=value.Definitions;\r\n      this.traitItem.classification=value.classification;\r\n      this.form= {\r\n        querySpecies:\"\",\r\n        gene:\"\"\r\n      }\r\n      if(value.classification!==\"\"&&value.classification!==null){\r\n        if(value.classification==\"animal\"){\r\n          this.classification=\"animal\"\r\n        }else{\r\n          this.classification=\"plant\"\r\n        }\r\n      }\r\n      this.loading_animal=true;\r\n      this.getTraitData(value.traitDefID,\"animal\");\r\n      this.loading_plant=true;\r\n      this.getTraitData(value.traitDefID,\"plant\")\r\n      this.currentPage4_p=1;\r\n      this.currentPage4_a=1;\r\n      \r\n      data.checked = true;\r\n      this.classification=value.classification;\r\n\r\n    },\r\n  showSelectedGene(rowData){\r\n      this.selectGene=rowData;\r\n  },\r\n  showOrthoInfoTable(rowData,index){\r\n    this.showSelectedGene(rowData,index)\r\n    // rowData.orthoList[rowData.speciesListData.indexOf(index)];\r\n    let ortholist=[];\r\n    rowData.speciesListData.forEach((id,idx)=>{\r\n      if(id==index){\r\n        ortholist.push(rowData.orthoList[idx])\r\n    }})\r\n    // console.log(\"index list:\",ortholist);\r\n\r\n    // rowData.\r\n    this.showOrthoSubTable = true;\r\n    this.showSubTableBox=false;\r\n    this.orthoLoading=false;\r\n\r\n   this.orthoTableData=[]\r\n    ortholist.forEach(item=>{\r\n      let hdbid=item.hdbId;\r\n      this.$axios.get(\"https://ngdc.cncb.ac.cn/hapi/api/gene-detail-ortho\",{params:{\"hdbId\":hdbid}}).then((res)=>{\r\n        console.log(\"gene res:\",res);\r\n        item.ensemblGeneId=res.data.ensemblGeneId.length>0?res.data.ensemblGeneId:\"-\";\r\n        item.geneSymbol=res.data.geneSymbol.length>0?res.data.geneSymbol:\"-\";\r\n        this.orthoTableData.push(item)\r\n        this.orthoLoading=false;\r\n      })\r\n    })\r\n    console.log(\"orthoTableData：\",this.orthoTableData);\r\n\r\n    // this.orthoTableData=ortholist;\r\n    // console.log(this.orthoTableData);\r\n    // 应该发送请求去genebasicinfo查具体的基因相关信息\r\n\r\n  },\r\n \r\n  // 表格高度自适应\r\n  getTableMaxHeight(){\r\n      this.$nextTick(function () {\r\n      let box = document.querySelector(\".trait-info\").attributes\r\n      let box_clientHeight = box[0].ownerElement.clientHeight;\r\n      this.tableHeight = box_clientHeight - 100;\r\n    })\r\n  },\r\n  buttonFunction(){\r\n    this.drawer = true;\r\n   },\r\n  showGwasInfoTable(rowValue,index){\r\n    this.gwasLoading=true;\r\n    this.showSelectedGene(rowValue,index)\r\n    // 获取当前位置，两物种间同源数据\r\n    let ortholist=[];\r\n    rowValue.speciesListData.forEach((id,idx)=>{\r\n    if(id==index){\r\n        let item=rowValue.orthoList[idx]\r\n        console.log(\"item:\",item);\r\n        ortholist.push(item)\r\n    }})\r\n    console.log(\"ortholist:\",ortholist);\r\n    this.orthoTableData=[]\r\n    ortholist.forEach(item=>{\r\n      let hdbid=item.hdbId;\r\n      this.$axios.get(\"https://ngdc.cncb.ac.cn/hapi/api/gene-detail-ortho\",{params:{\"hdbId\":hdbid}}).then((res)=>{\r\n        console.log(\"gene res:\",res);\r\n        item.ensemblGeneId=res.data.ensemblGeneId.length>0?res.data.ensemblGeneId:\"-\";\r\n        item.geneSymbol=res.data.geneSymbol.length>0?res.data.geneSymbol:\"-\";\r\n        this.orthoTableData.push(item)\r\n        this.orthoLoading=false;\r\n      })\r\n    })\r\n    console.log(\"rowValue:\",rowValue);\r\n    this.showOrthoSubTable = true;\r\n    this.orthoLoading=false;\r\n    // this.orthoTableData=ortholist;\r\n    this.showSubTableBox=true;\r\n    \r\n    // 左侧基因的接口数据\r\n    let gwasid1=rowValue.gwasId\r\n    let taxid1=rowValue.gwasOrgid;\r\n    let gwasGeneId=rowValue.geneId;\r\n    // let varList=[];\r\n    let filtList=[]\r\n    // 左侧基因请求接口\r\n    this.$axios.get(\"https://ngdc.cncb.ac.cn/gapi/gwas/gwasids?gwasId=\"+gwasid1+\"&organismId=\"+taxid1+\"&offset=0&pagesize=10&total=10&geneId=\"+gwasGeneId)\r\n    .then(response=>{\r\n      console.log(\"gwas response:\",response);\r\n      let datalist=response.data;\r\n      \r\n      for(let item of datalist){\r\n        item.topTrait=rowValue.traitName;\r\n        item.orthoGeneId=rowValue.geneId;\r\n        // if(varList.indexOf(item.varId)==-1){\r\n        //   varList.push(item.varId)\r\n        filtList.push(item);\r\n        // }\r\n      }\r\n      // this.gwasInfoData=filtList; \r\n      \r\n      // this.gwasLoading=false;\r\n      \r\n    })\r\n    // 右侧基因数据\r\n    // 循环当前同源数据，请求后端得到接口所需要的参数\r\n    ortholist.forEach((item)=>{\r\n      console.log(\"item:\",item);\r\n      let hdbid=item.hdbId;\r\n      // let topTrait=item.traitName;\r\n      console.log(\"item.hdbId:\",item.hdbId);\r\n      this.$axios.get(\"https://ngdc.cncb.ac.cn/hapi/api/traits-gwas-info\",{params:{'hdbId': hdbid}}).then(res=>{\r\n        console.log(\"res:\",res);\r\n        if(res.data.length !==0){\r\n          let gwasid2=res.data.gwasId;\r\n          let taxid2=res.data.gwasOrgid;\r\n          let gwasGeneId=res.data.gwasGeneId;\r\n          if(gwasid2 != gwasid1){\r\n            this.$axios.get(\"https://ngdc.cncb.ac.cn/gapi/gwas/gwasids?gwasId=\"+gwasid2+\"&organismId=\"+taxid2+\"&offset=0&pagesize=10&total=10&geneId=\"+gwasGeneId)\r\n              .then(response=>{\r\n                console.log(\"gwas response22:\",response);\r\n                let datalist=response.data;\r\n                if(datalist.length>0){\r\n                  for(let idata of datalist){\r\n                    // if(varList.indexOf(item.varId)==-1){\r\n                    //   varList.push(item.varId)\r\n                    idata.topTrait=item.traitName;\r\n                    idata.orthoGeneId=item.ensemblGeneId;\r\n                    filtList.push(idata);\r\n                    // }\r\n                  }\r\n                 \r\n                }\r\n            }).finally(()=>{\r\n              this.gwasInfoData=filtList;\r\n              this.gwasInfoData.topTrait=rowValue.traitName;\r\n               setTimeout(() => {\r\n                  this.gwasLoading=false;\r\n              }, 100);\r\n            })\r\n          }\r\n        }\r\n      })\r\n      \r\n    })\r\n   \r\n    // this.$axios.get(\"https://ngdc.cncb.ac.cn/hapi/api/traits-gwas-info\",{params:{'hdbid': hdblist}}).then(res=>{\r\n    //     console.log(\"res:\",res);\r\n    // })\r\n   },\r\n   showSingleGwasInfoTable(rowValue,index){\r\n    console.log(\"rowValue,index:\",rowValue,index);\r\n    // 获取当前位置，两物种间同源数据\r\n    let ortholist=[];\r\n    rowValue.speciesListData.forEach((id,idx)=>{\r\n    if(id==index){\r\n        let item=rowValue.orthoList[idx]\r\n        console.log(\"item:\",item);\r\n        ortholist.push(item)\r\n    }})\r\n    \r\n    this.showOrthoSubTable = true;\r\n    this.orthoLoading=false;\r\n    this.orthoTableData=ortholist;\r\n    this.showSubTableBox=true;\r\n    this.gwasLoading=true;\r\n    this.gwasInfoData=[];\r\n    // 右侧基因数据\r\n    // 循环当前同源数据，请求后端得到接口所需要的参数\r\n    ortholist.forEach((item)=>{\r\n      let hdbid=item.hdbId;\r\n      // let topTrait=item.traitName;\r\n      console.log(\"item.hdbId:\",item.hdbId);\r\n      this.$axios.get(\"https://ngdc.cncb.ac.cn/hapi/api/traits-gwas-info\",{params:{'hdbId': hdbid}}).then(res=>{\r\n        console.log(\"res:\",res);\r\n        if(res.data.length !==0){\r\n          let gwasid2=res.data.gwasId;\r\n          let taxid2=res.data.gwasOrgid;\r\n          this.$axios.get(\"https://ngdc.cncb.ac.cn/gapi/gwas/gwasids?gwasId=\"+gwasid2+\"&organismId=\"+taxid2+\"&offset=0&pagesize=10&total=10\")\r\n            .then(response=>{\r\n              console.log(\"gwas response22:\",response);\r\n              let datalist=response.data;\r\n              for(let idata of datalist){\r\n                idata.topTrait=item.traitName;\r\n              }\r\n              // let data=response.data;\r\n              // data.topTrait=item.traitName;\r\n              this.gwasInfoData=this.gwasInfoData.concat(datalist)\r\n             \r\n              console.log(\"this.gwasInfoData:\",this.gwasInfoData);\r\n          })\r\n        }\r\n      })\r\n    })\r\n    setTimeout(() => {\r\n      this.gwasLoading=false;\r\n    }, 100);\r\n   },\r\n    hiligtDbCols({rowIndex}){\r\n      if(rowIndex===1){\r\n          return \"writing-mode: vertical-lr; !important;text-align:right\"\r\n      }\r\n      \r\n    },\r\n    iconClass(data,index){\r\n      // if(data.speciesListData.indexOf(index)>-1){\r\n        // 循环当前行的同源物种index\r\n        data.speciesListData.forEach((id,idx)=>{\r\n          // console.log(\"id,index:\",id,index);\r\n          if(id==index){\r\n            // 取出列index和同源index相等的列值\r\n            if( data.orthoList[idx].traitName!=null ){\r\n              // console.log(\"data.orthoList[idx]:\",data.orthoList[idx].traitName,data.traitName);\r\n              let traitlist=data.orthoList[idx].traitName.split(\",\")\r\n              console.log(\"traitlist:\",traitlist,\"data.traitName:\",data.traitName);\r\n              if(traitlist.indexOf(data.traitName)>-1){\r\n                console.log(1,\"idx:\",idx,\"species:\",data.orthoList[idx],\"trait data:\",data.traitName);\r\n                console.log(\"data.orthoList[idx]:\",data.orthoList[idx].traitName,data.traitName);\r\n                return 1;\r\n              }else{\r\n                console.log(2);\r\n                console.log(\"data.orthoList[idx]:\",data.orthoList[idx],data.traitName);\r\n              return 2;\r\n            }\r\n          }else{\r\n            return false\r\n          }\r\n          }else{\r\n            return false\r\n          }\r\n        })\r\n      // }\r\n    },\r\n   \r\n    searchFilter(){\r\n      if(this.form.querySpecies==\"\" && this.form.gene==\"\"){\r\n        this.$message.error('Please enter query criteria');\r\n      }else{\r\n        if(this.classification==\"animal\"){\r\n          this.loading_animal=true;\r\n        }else{\r\n          this.loading_plant=true;\r\n        }\r\n        this.getTraitData(this.traitItem.traitDefID,this.classification)\r\n        setTimeout(() => {\r\n          this.messagError(this.classification)\r\n        }, 1000);\r\n      }\r\n    }, \r\n     messagError(type){\r\n      if(type=='plant'){\r\n        if(this.totalSize_plant==0){\r\n            this.$message.error('No data found');\r\n          }\r\n      }else{\r\n          if(this.totalSize_animal==0){\r\n            this.$message.error('No data found');\r\n        }\r\n      }\r\n    },\r\n    clearFilter(){\r\n      if(this.form.querySpecies!==\"\" || this.form.gene!==\"\"){\r\n\r\n        if(this.classification==\"animal\"){\r\n          this.loading_animal=true;\r\n        }else{\r\n          this.loading_plant=true;\r\n        }\r\n        this.form.querySpecies=\"\"\r\n        this.form.gene=\"\"\r\n        this.getTraitData(this.traitItem.traitDefID,\"animal\")\r\n        this.getTraitData(this.traitItem.traitDefID,\"plant\")\r\n        \r\n      }\r\n    },\r\n    async showTableIcon(data,classss){\r\n      \r\n      if(classss == \"plant\"){\r\n        this.speciesList_plant=[];\r\n        this.speciesList_plant_1=[];\r\n        if(data.length>0){\r\n          for(let varData of data){\r\n            // 增加一个属性保存物种的index，用来显示表格里的icon\r\n            varData.speciesListData=[];\r\n            // 增加一个属性，保存显示有trait数据的情况\r\n            varData.traitListData1=[];\r\n            varData.traitListData2=[];\r\n            if(varData.orthoList){\r\n              for(let item of varData.orthoList){\r\n                let speciesName=item.species.commonName\r\n                if(this.speciesList_plant.indexOf(speciesName)==-1){\r\n                  this.speciesList_plant.push(speciesName);\r\n                  item.species.checked=true;\r\n                  this.speciesList_plant_1.push(item.species);\r\n                }\r\n                varData.speciesListData.push(this.speciesList_plant.indexOf(speciesName));\r\n                if(item.traitName !== null){\r\n                  varData.traitListData2.push(this.speciesList_plant.indexOf(speciesName))\r\n                  if(item.traitName==varData.traitName){\r\n                      varData.traitListData1.push(this.speciesList_plant.indexOf(speciesName))\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n          this.$refs['table'].doLayout();\r\n        }\r\n    }else{\r\n      this.speciesList_animal=[];\r\n      \r\n      console.log(\"this.speciesList_plant:\",this.speciesList_plant);\r\n      this.speciesList_animal_1=[];\r\n        if(data.length>0){\r\n          for(let varData of data){\r\n            // 增加一个属性保存物种的index，用来显示表格里的icon\r\n            varData.speciesListData=[];\r\n            varData.traitListData1=[];\r\n            varData.traitListData2=[];\r\n            if(varData.orthoList){\r\n              for(let item of varData.orthoList){\r\n                let speciesName=item.species.commonName;\r\n                if(this.speciesList_animal.indexOf(speciesName)==-1){\r\n                  this.speciesList_animal.push(speciesName);\r\n                  item.species.checked=true;\r\n                  this.speciesList_animal_1.push(item.species);\r\n                }\r\n                varData.speciesListData.push(this.speciesList_animal.indexOf(speciesName));\r\n                if(item.traitName !== null){\r\n                  // 有trait但不相同\r\n                   varData.traitListData2.push(this.speciesList_animal.indexOf(speciesName))\r\n                  if(item.traitName==varData.traitName){\r\n                    // 有相同trait\r\n                      varData.traitListData1.push(this.speciesList_animal.indexOf(speciesName))\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n    }\r\n    return Promise.resolve(data);\r\n    },\r\n    // 主要获取数据的方法\r\n    // 根据动植物分开获取\r\n    async getTraitData(traitId,classification,hdbId){\r\n      // console.log(\"params:\",params);\r\n      // let traitId=params.traitId;\r\n      // let classification=params.classification;\r\n      // let pagesize=params.pagesize;\r\n      // let pagenum=params.pagenum;\r\n      // let speciesName=params.speciesName;\r\n      // let geneId=params.geneId;\r\n      // let hdbId=params.hdbId;\r\n\r\n      if(this.form.gene!=='' && this.form.gene !==undefined){\r\n        this.form.gene=this.form.gene.trim()\r\n      }\r\n      let pageNo;\r\n      if(classification==\"animal\"){pageNo=this.currentPage4_a}else if(classification==\"plant\"){\r\n        pageNo=this.currentPage4_p\r\n      }else{pageNo=1}\r\n      // console.log('classification', classification,'traitId',traitId,'length',this.pageSize,'pageNo',pageNo,'speciesName',this.form.querySpecies,'geneId',this.form.gene,\"hdbId\",hdbId);\r\n      this.$axios.get(\"http://localhost:9401/api/traits\",{params:{'classification': classification,'traitId':traitId,'length':this.pageSize,'pageNo':pageNo,'speciesName':this.form.querySpecies,'geneId':this.form.gene,\"hdbId\":hdbId}})\r\n      .then((response) => {\r\n        if(classification==\"animal\"){\r\n          this.getSpecies(traitId,'animal')\r\n          console.log(\"response.data.recordsTotal:\",response.data);\r\n          this.totalSize_animal = response.data.recordsTotal;\r\n          // this.speciesList_animal=response.data.data[0].headerList;\r\n          this.showTableIcon(response.data.data,classification).then((res)=>{ this.traitData_animal=res;this.loading_animal=false;});\r\n          \r\n        }else{\r\n          this.getSpecies(traitId,'plant')\r\n          this.totalSize_plant = response.data.recordsTotal;\r\n          // this.speciesList_plant=response.data.data[0].headerList;\r\n          this.showTableIcon(response.data.data,classification).then((res)=>{ this.traitData_plant=res; this.loading_plant=false;});\r\n         \r\n        }\r\n\r\n      })\r\n      .finally(()=>{ return Promise.resolve()})\r\n   \r\n    },\r\n    // 根据当前classification判断获取动物或植物列表\r\n    getSpecies(traitID,speciesType){\r\n      this.$axios.get('http://localhost:9401/api/species-trait',{params: {'traitID':traitID,speciesType: speciesType}})\r\n        .then(response=>{\r\n          // 2是植物，1是动物\r\n          if(speciesType=='plant'){\r\n            this.querySpeciesList_plant=response.data;\r\n          }else{\r\n            this.querySpeciesList_animal=response.data;\r\n          }\r\n      })\r\n    },\r\n     export2Excel() {\r\n          require.ensure([], () => {\r\n            const { export_json_to_excel } = require('../../vendor/Export2Excel');\r\n            const tHeader = ['序号', 'IMSI', 'MSISDN', '号码', '姓名'];\r\n            const filterVal = ['ID', 'imsi', 'msisdn', 'address', 'name'];\r\n            const list = this.tableData;\r\n            const data = this.formatJson(filterVal, list);\r\n            export_json_to_excel(tHeader, data, '列表excel');\r\n          })\r\n          },\r\n            formatJson(filterVal, jsonData) {\r\n          return jsonData.map(v => filterVal.map(j => v[j]))\r\n      },\r\n      clearTraitFilter(){\r\n        this.traitItem={\r\n          traitName:\"\",\r\n          traitId:\"\",\r\n          traitDefID:\"\",\r\n          definition:\"\",\r\n          classification:\"\"\r\n        }\r\n        if(this.classification=='animal'){this.loading_animal=true}else{this.loading_plant=true}\r\n        this.showTitle=false;\r\n        this.getTraitData(\"\",\"animal\");\r\n        this.getTraitData(\"\",\"plant\");\r\n      }\r\n  },\r\n  \r\n\r\n  mounted() {\r\n    if(this.classification=='animal'){\r\n      this.loading_animal = true;\r\n    }else{\r\n      this.loading_plant=true;\r\n    }\r\n    let hdbId = this.$route.query.hdbId;\r\n    this.hdbId=hdbId;\r\n    // if(hdbId!=null && hdbId!=\"\"){}\r\n    if(hdbId!=\"\"&&hdbId!=null){\r\n      let classification;\r\n      if(this.$route.query.speciesType==1){\r\n        classification=\"animal\";\r\n        this.classification=\"animal\";\r\n      }else if(this.$route.query.speciesType==2){\r\n        classification=\"plant\";\r\n        this.classification=\"plant\";\r\n      }\r\n     \r\n      this.traitItem={\r\n          traitName:\"\",\r\n          traitId:\"\",\r\n          traitDefID:\"\",\r\n          definition:\"\",\r\n          classification:\"\"\r\n        }\r\n        this.showTitle=false;\r\n        this.getTraitData(\"\",classification,hdbId);\r\n    }else{\r\n      this.getTraitData(this.traitItem.traitDefID,this.traitItem.classification);\r\n    }\r\n\r\n    window.addEventListener(\"scroll\", this.watchScroll);\r\n    \r\n    window.addEventListener(\"scroll\", this.watchScroll);\r\n      this.getTableMaxHeight(); \r\n      let _this = this;\r\n      window.onresize = function () {//用于使表格高度自适应的方法  \r\n      _this.getTableMaxHeight();//获取容器当前高度，重设表格的最大高度\r\n    }\r\n    \r\n  }\r\n}\r\n\r\n</script>\r\n"]}]}