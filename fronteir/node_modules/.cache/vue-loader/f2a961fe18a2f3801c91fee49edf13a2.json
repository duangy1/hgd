{"remainingRequest":"F:\\hdb\\fronteir\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\hdb\\fronteir\\src\\views\\Variant.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\hdb\\fronteir\\src\\views\\Variant.vue","mtime":1664365726959},{"path":"F:\\hdb\\fronteir\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\hdb\\fronteir\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\hdb\\fronteir\\node_modules\\vue-loader\\lib\\index.js","mtime":1656480287592}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovLyBAIGlzIGFuIGFsaWFzIHRvIC9zcmMNCi8vIGltcG9ydCBOYXZpZ2F0b3IgZnJvbSAiQC9jb21wb25lbnRzL25hdmlnYXRvci52dWUiOw0KaW1wb3J0IHZhck9udG9sb2d5IGZyb20gIkAvYXNzZXRzL3N0YXRpYy92YXJPbnRvbG9neS5qc29uIjsNCmltcG9ydCBCYW5uZXIgZnJvbSAiQC9jb21wb25lbnRzL2Jhbm5lci52dWUiOw0KaW1wb3J0IEZvb3RlckJhciBmcm9tICJAL2NvbXBvbmVudHMvRm9vdGVyQmFyLnZ1ZSI7DQppbXBvcnQgSGVhZGVyQmFyIGZyb20gIkAvY29tcG9uZW50cy9IZWFkZXJCYXIudnVlIjsNCi8vIGltcG9ydCBxcyBmcm9tICJxcyI7DQovLyAvLyBpY29ucw0KaW1wb3J0IHNhbWVUcmFpdEljb24gZnJvbSAiQC9hc3NldHMvaW1nL2ljb24vc3Rhci5zdmciOw0KaW1wb3J0IG9ydGhvSWNvbiBmcm9tICJAL2Fzc2V0cy9pbWcvaWNvbi9odWFmdS5zdmciOw0KaW1wb3J0IHNpbmdsZVRyYWl0SWNvbiBmcm9tICJAL2Fzc2V0cy9pbWcvaWNvbi9vcmFuZ2Uuc3ZnIjsNCi8vIGltcG9ydCAiQC9hc3NldHMvY3NzL3RyYWl0cy5jc3MiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiVHJhaXRzIiwNCiAgY29tcG9uZW50czogew0KICAgIC8vIE5hdmlnYXRvciwNCiAgICBGb290ZXJCYXIsDQogICAgSGVhZGVyQmFyLA0KICAgIEJhbm5lciwNCiAgICANCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBmaWx0ZXJUZXh0KHZhbCkgew0KICAgICAgdGhpcy4kcmVmcy50cmVlLmZpbHRlcih2YWwpOw0KICAgIH0sDQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHNhbWVUcmFpdEljb24sDQogICAgICBvcnRob0ljb24sDQogICAgICBzaW5nbGVUcmFpdEljb24sDQogICAgICB2aXNpYmxlOmZhbHNlLA0KICAgICAgdmlzaWJsZV8xOmZhbHNlLA0KICAgICAgZmlsdGVyVGV4dDogIiIsDQogICAgICB0cmVlZGF0YTogdmFyT250b2xvZ3kudHJlZSwNCiAgICAgIHNob3dTdWJUYWJsZUJveDpmYWxzZSwNCiAgICAgIGd3YXNMb2FkaW5nOnRydWUsDQogICAgICBvcnRob0xvYWRpbmc6dHJ1ZSwNCiAgICAgIGFjdGl2ZU5hbWU6ICdhbmltYWwnLA0KICAgICAgZHJhd2VyOmZhbHNlLA0KICAgICAgZGlyZWN0aW9uOiJsdHIiLA0KICAgICAgIC8vIOS/neWtmOWQjOa6kOeJqeenje+8jOeUqOS6juihqOagvOeUn+aIkOWIlw0KICAgICAgc3BlY2llc0xpc3RfYW5pbWFsOltdLA0KICAgICAgc3BlY2llc0xpc3RfcGxhbnQ6W10sDQogICAgICAgLy8g5L+d5a2Y5ZCM5rqQ54mp56eNb2Jq77yM55So5LqO5Yqo5oCB6YCJ5oup5YiXDQogICAgICBzcGVjaWVzTGlzdF9hbmltYWxfMTpbXSwNCiAgICAgIHNwZWNpZXNMaXN0X3BsYW50XzE6W10sDQogICAgICB0cmFpdERhdGFfYW5pbWFsOiBbXSwNCiAgICAgIHRyYWl0RGF0YV9wbGFudDpbXSwNCiAgICAgIG9ydGhvVGFibGVEYXRhOiBbXSwNCiAgICAgIHZhbHVlOiAiIiwNCiAgICAgIHZhckl0ZW06ew0KICAgICAgICB2YXJOYW1lOiJmcmFtZXNoaWZ0X3ZhcmlhbnQiDQogICAgICB9LA0KICAgICAgY3VycmVudFBhZ2U0X2E6IDEsDQogICAgICBjdXJyZW50UGFnZTRfcDogMSwNCiAgICAgIHRvdGFsU2l6ZV9hbmltYWw6MCwNCiAgICAgIHRvdGFsU2l6ZV9wbGFudDowLA0KICAgICAgZm9ybTogew0KICAgICAgICBxdWVyeVNwZWNpZXM6IiIsDQogICAgICAgIGdlbmU6IiINCiAgICAgIH0sDQogICAgICBwYWdlU2l6ZTogMTAsDQogICAgICBnd2FzSW5mb0RhdGE6W10sDQogICAgICAvLyBsb2FkaW5nOnRydWUsDQogICAgICBsb2FkaW5nX2FuaW1hbDpmYWxzZSwNCiAgICAgIGxvYWRpbmdfcGxhbnQ6ZmFsc2UsDQogICAgICBzaG93T3J0aG9TdWJUYWJsZTpmYWxzZSwNCiAgICAgIGNsYXNzaWZpY2F0aW9uOiJhbmltYWwiLA0KICAgICAgbmF2QmFyRml4ZWQ6ImZhbHNlIiwNCiAgICAgIHNob3dUcmFpdFNhbWVJY29uOmZhbHNlLA0KICAgICAgIC8vIOS7juaOpeWPo+iOt+WPluaJgOacieaciXRyYWl05pWw5o2u55qE54mp56eN77yM55So5LqO54mp56eN6YCJ5oup77yM5o+Q5Lqkc2VhcmNoDQogICAgICBxdWVyeVNwZWNpZXNMaXN0X2FuaW1hbDpbXSwNCiAgICAgIHF1ZXJ5U3BlY2llc0xpc3RfcGxhbnQ6W10sDQogICAgICBxdWVyeVNwZWNpZXNMaXN0OltdLA0KICAgICAgc2VsZWN0R2VuZTp7fSwNCiAgICAgIHNob3dUaXRsZTp0cnVlLA0KICAgICAgdGF4X1BsYW50OlsiMzcwMiIsIjM3MDgiLCI0MDcyIiwiMzY1OSIsIjM2MzUiLCIzOTgzIiwiNDUzMCIsIjM4NDciLCI0MjM0NSIsIjM2OTQiLCI0MDgxIiwiNDU1OCIsIjQ1NjUiLCIyOTc2MCIsIjQ1NzciLCI0MTEzIl0NCg0KICAgIH07DQogIH0sDQoNCiAgbWV0aG9kczogew0KICAgDQogICAgY2hhbmdlQ2xhc3ModGFiKXsNCiAgICAgICAgdGhpcy5zcGVjaWVzTGlzdD1bXTsNCiAgICAgICAgdGhpcy5zaG93T3J0aG9TdWJUYWJsZT1mYWxzZTsNCiAgICAgICAgdGhpcy5zaG93U3ViVGFibGVCb3g9ZmFsc2U7DQogICAgICAgIHRoaXMuY2xhc3NpZmljYXRpb249dGFiLm5hbWU7DQogICAgICAgIC8vIHRoaXMuJHJlZnNbJ3RhYmxlJ10uZG9MYXlvdXQoKTsNCiAgICAgICAgdGhpcy5mb3JtLnF1ZXJ5U3BlY2llcz0iIjsNCiAgICAgICAgdGhpcy5mb3JtLmdlbmU9IiI7DQogICAgfSwNCg0KICAgIGNvbmZpcm1idXR0b24oKXsNCiAgICB0aGlzLnZpc2libGVfMSA9IGZhbHNlOw0KICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlOw0KICAgIC8vIHRoaXMuJHJlZnMudGFibGUuZG9MYXlvdXQoKTsNCiAgIH0sDQogICAgaGFuZGxlU2l6ZUNoYW5nZSh2YWwpew0KICAgICAgLy8gdGhpcy5sb2FkaW5nID0gdHJ1ZTsNCiAgICAgIGlmKHRoaXMuY2xhc3NpZmljYXRpb249PSJhbmltYWwiKXt0aGlzLmxvYWRpbmdfYW5pbWFsPXRydWU7fWVsc2V7dGhpcy5sb2FkaW5nX3BsYW50PXRydWV9DQogICAgICB0aGlzLnBhZ2VTaXplID0gdmFsOw0KICAgICAgdGhpcy5wYWdlTm89MTsNCiAgICAgIHRoaXMuZ2V0VHJhaXREYXRhKHRoaXMudmFySXRlbS52YXJOYW1lLHRoaXMuY2xhc3NpZmljYXRpb24pDQogICAgfSwNCiAgICBoYW5kbGVDdXJyZW50Q2hhbmdlKHZhbCkgew0KICAgICAgaWYodGhpcy5jbGFzc2lmaWNhdGlvbj09ImFuaW1hbCIpew0KICAgICAgICB0aGlzLmxvYWRpbmdfYW5pbWFsPXRydWU7DQogICAgICAgIHRoaXMuY3VycmVudFBhZ2U0X2EgPSB2YWw7DQogICAgICAgIC8vIHRyYWl0SWQsY2xhc3NpZmljYXRpb24scGFnZXNpemUscGFnZW51bSxzcGVjaWVzTmFtZQ0KICAgICAgICB0aGlzLmdldFRyYWl0RGF0YSh0aGlzLnZhckl0ZW0udmFyTmFtZSx0aGlzLmNsYXNzaWZpY2F0aW9uKQ0KICAgICAgfWVsc2V7DQogICAgICAgIHRoaXMubG9hZGluZ19wbGFudD10cnVlOw0KICAgICAgICB0aGlzLmN1cnJlbnRQYWdlNF9wID0gdmFsOw0KICAgICAgICB0aGlzLmdldFRyYWl0RGF0YSh0aGlzLnZhckl0ZW0udmFyTmFtZSx0aGlzLmNsYXNzaWZpY2F0aW9uKQ0KICAgICAgfQ0KICAgICAgDQoNCiAgICB9LA0KICAgIGhhbmRsZVNlbGVjdGlvbkNoYW5nZSh2YWwpIHsNCiAgICAgIHRoaXMubXVsdGlwbGVTZWxlY3Rpb24gPSB2YWw7DQogICAgfSwNCiAgICBmaWx0ZXJOb2RlKHZhbHVlLCBkYXRhKSB7DQogICAgICBpZiAoIXZhbHVlKSByZXR1cm4gdHJ1ZTsNCiAgICAgIHJldHVybiBkYXRhLmxhYmVsLmluZGV4T2YodmFsdWUpICE9PSAtMTsNCiAgICB9LA0KICAgIGdldEluZm9CeVRyYWl0KHZhbHVlLCBkYXRhKSB7DQogICAgICB0aGlzLnNob3dUaXRsZT10cnVlOw0KICAgICAgdGhpcy5zaG93U3ViVGFibGVCb3g9ZmFsc2U7DQogICAgICB0aGlzLnNob3dPcnRob1N1YlRhYmxlPWZhbHNlOw0KICAgICAgdGhpcy52YXJJdGVtLnZhck5hbWU9dmFsdWUubGFiZWw7DQogICAgICB0aGlzLnBhZ2VObz0xOw0KICAgICAgdGhpcy5mb3JtPSB7DQogICAgICAgIHF1ZXJ5U3BlY2llczoiIiwNCiAgICAgICAgZ2VuZToiIg0KICAgICAgfQ0KICAgICAgaWYodGhpcy5jbGFzc2lmaWNhdGlvbj09ImFuaW1hbCIpew0KICAgICAgICB0aGlzLmN1cnJlbnRQYWdlNF9hPTE7DQogICAgICAgIHRoaXMubG9hZGluZ19hbmltYWw9dHJ1ZTsNCiAgICAgIH1lbHNlew0KICAgICAgICB0aGlzLmxvYWRpbmdfcGxhbnQ9dHJ1ZTsNCiAgICAgICAgdGhpcy5jdXJyZW50UGFnZTRfcD0xOw0KICAgICAgfQ0KICAgICAgdGhpcy5nZXRUcmFpdERhdGEodmFsdWUubGFiZWwpDQogICAgICANCiAgICAgIGRhdGEuY2hlY2tlZCA9IHRydWU7DQogICAgICANCiAgICB9LA0KICAgIG1lc3NhZ0Vycm9yKHR5cGUpew0KICAgICAgaWYodHlwZT09J3BsYW50Jyl7DQogICAgICAgIGlmKHRoaXMudG90YWxTaXplX3BsYW50PT0wKXsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ05vIGRhdGEgZm91bmQnKTsNCiAgICAgICAgICB9DQogICAgICB9ZWxzZXsNCiAgICAgICAgICBpZih0aGlzLnRvdGFsU2l6ZV9hbmltYWw9PTApew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcignTm8gZGF0YSBmb3VuZCcpOw0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICBzaG93U2VsZWN0ZWRHZW5lKHJvd0RhdGEpew0KICAgICAgdGhpcy5zZWxlY3RHZW5lPXJvd0RhdGE7DQogICAgICB0aGlzLnNlbGVjdEdlbmUudW5pcHJvdElkPXJvd0RhdGEuaGRiaWQuc3BsaXQoIl8iKVswXTsNCiAgICAgIHRoaXMuc2VsZWN0R2VuZS5lbnNlbWJsSWQ9cm93RGF0YS5oZGJpZC5zcGxpdCgiXyIpWzFdOw0KICB9LA0KICBzaG93T3J0aG9JbmZvVGFibGUocm93RGF0YSxpbmRleCl7DQogICAgY29uc29sZS5sb2coInJvd0RhdGE6Iixyb3dEYXRhKTsNCiAgICB0aGlzLnNob3dTZWxlY3RlZEdlbmUocm93RGF0YSxpbmRleCkNCiAgICBsZXQgb3J0aG9saXN0PVtdOw0KICAgIC8vIOmAmui/h2hkYmlk562b6YCJ5L+d55WZdW5pcXVl55qE5ZCM5rqQ5YC8LOmcgOimgeetm+mAieWQl++8nw0KICAgIGxldCBvcnRob2hkYmxpc3Q9W107DQogICAgcm93RGF0YS5zcGVjaWVzTGlzdERhdGEuZm9yRWFjaCgoaWQsaWR4KT0+ew0KICAgICAgaWYoaWQ9PWluZGV4KXsNCiAgICAgICAgbGV0IGl0ZW09cm93RGF0YS5vcnRob0xpc3RbaWR4XTsNCiAgICAgICAgaWYob3J0aG9oZGJsaXN0LmluZGV4T2YoaXRlbS5oZGJJZCk9PS0xKXsNCiAgICAgICAgICBvcnRob2xpc3QucHVzaChpdGVtKTsNCiAgICAgICAgICBvcnRob2hkYmxpc3QucHVzaChpdGVtLmhkYklkKTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBvcnRob2xpc3QucHVzaChyb3dEYXRhLm9ydGhvTGlzdFtpZHhdKQ0KICAgIH19KQ0KICAgIHRoaXMuc2hvd09ydGhvU3ViVGFibGUgPSB0cnVlOw0KICAgIHRoaXMuc2hvd1N1YlRhYmxlQm94PWZhbHNlOw0KICAgIHRoaXMub3J0aG9Mb2FkaW5nPXRydWU7DQoNCiAgICB0aGlzLm9ydGhvVGFibGVEYXRhPVtdDQogICAgb3J0aG9saXN0LmZvckVhY2goaXRlbT0+ew0KICAgICAgbGV0IGhkYmlkPWl0ZW0uaGRiSWQ7DQogICAgICB0aGlzLiRheGlvcy5nZXQoImh0dHBzOi8vbmdkYy5jbmNiLmFjLmNuL2hhcGkvYXBpL2dlbmUtZGV0YWlsLW9ydGhvIix7cGFyYW1zOnsiaGRiSWQiOmhkYmlkfX0pLnRoZW4oKHJlcyk9PnsNCiAgICAgICAgaWYocmVzLmRhdGEhPT0iIil7DQogICAgICAgICAgaXRlbS5lbnNlbWJsR2VuZUlkPXJlcy5kYXRhLmVuc2VtYmxHZW5lSWQubGVuZ3RoPjA/cmVzLmRhdGEuZW5zZW1ibEdlbmVJZDoiLSI7DQogICAgICAgICAgaXRlbS5nZW5lU3ltYm9sPXJlcy5kYXRhLmdlbmVTeW1ib2wubGVuZ3RoPjA/cmVzLmRhdGEuZ2VuZVN5bWJvbDoiLSI7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgIGl0ZW0uZW5zZW1ibEdlbmVJZD0iLSI7DQogICAgICAgICAgaXRlbS5nZW5lU3ltYm9sPSItIjsNCiAgICAgICAgfQ0KICAgICAgICBsZXQgZGJDb250ZW50PWl0ZW0uZnJvbWRiLnNwbGl0KCcsJyk7DQogICAgICAgIGl0ZW0uZGJDb250ZW50PWRiQ29udGVudDsNCiAgICAgICAgdGhpcy5vcnRob1RhYmxlRGF0YS5wdXNoKGl0ZW0pOw0KICAgICAgICB0aGlzLm9ydGhvTG9hZGluZz1mYWxzZTsNCiAgICAgIH0pDQogICAgfSkNCiAgICAvLyB0aGlzLm9ydGhvVGFibGVEYXRhPW9ydGhvbGlzdDsNCiAgICAvLyBjb25zb2xlLmxvZygib3J0aG9UYWJsZURhdGE6Iix0aGlzLm9ydGhvVGFibGVEYXRhKTsNCg0KICB9LA0KIA0KICAvLyDooajmoLzpq5jluqboh6rpgILlupQNCiAgZ2V0VGFibGVNYXhIZWlnaHQoKXsNCiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsNCiAgICAgIGxldCBib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIudHJhaXQtaW5mbyIpLmF0dHJpYnV0ZXMNCiAgICAgIGxldCBib3hfY2xpZW50SGVpZ2h0ID0gYm94WzBdLm93bmVyRWxlbWVudC5jbGllbnRIZWlnaHQ7DQogICAgICB0aGlzLnRhYmxlSGVpZ2h0ID0gYm94X2NsaWVudEhlaWdodCAtIDEwMDsNCiAgICB9KQ0KICB9LA0KICBidXR0b25GdW5jdGlvbigpew0KICAgIHRoaXMuZHJhd2VyID0gdHJ1ZTsNCiAgIH0sDQogIHNob3dHd2FzSW5mb1RhYmxlKHJvd1ZhbHVlLGluZGV4KXsNCiAgICB0aGlzLnNob3dTZWxlY3RlZEdlbmUocm93VmFsdWUsaW5kZXgpDQogICAgbGV0IG9ydGhvbGlzdD1bXTsNCiAgICAvLyDpgJrov4doZGJpZOetm+mAieS/neeVmXVuaXF1ZeeahOWQjOa6kOWAvA0KICAgIGxldCBvcnRob2hkYmxpc3Q9W107DQogICAgcm93VmFsdWUuc3BlY2llc0xpc3REYXRhLmZvckVhY2goKGlkLGlkeCk9PnsNCiAgICBpZihpZD09aW5kZXgpew0KICAgICAgICBsZXQgaXRlbT1yb3dWYWx1ZS5vcnRob0xpc3RbaWR4XTsNCiAgICAgICAgaWYob3J0aG9oZGJsaXN0LmluZGV4T2YoaXRlbS5oZGJJZCk9PS0xKXsNCiAgICAgICAgICBvcnRob2xpc3QucHVzaChpdGVtKTsNCiAgICAgICAgICBvcnRob2hkYmxpc3QucHVzaChpdGVtLmhkYklkKTsNCiAgICAgICAgfQ0KICAgIH19KQ0KICAgIHRoaXMub3J0aG9UYWJsZURhdGE9W107DQogICAgb3J0aG9saXN0LmZvckVhY2goaXRlbT0+ew0KICAgICAgbGV0IGhkYmlkPWl0ZW0uaGRiSWQ7DQogICAgICB0aGlzLiRheGlvcy5nZXQoImh0dHBzOi8vbmdkYy5jbmNiLmFjLmNuL2hhcGkvYXBpL2dlbmUtZGV0YWlsLW9ydGhvIix7cGFyYW1zOnsiaGRiSWQiOmhkYmlkfX0pLnRoZW4oKHJlcyk9PnsNCiAgICAgICAgaXRlbS5lbnNlbWJsR2VuZUlkPXJlcy5kYXRhLmVuc2VtYmxHZW5lSWQubGVuZ3RoPjA/cmVzLmRhdGEuZW5zZW1ibEdlbmVJZDoiLSI7DQogICAgICAgIGl0ZW0uZ2VuZVN5bWJvbD1yZXMuZGF0YS5nZW5lU3ltYm9sLmxlbmd0aD4wP3Jlcy5kYXRhLmdlbmVTeW1ib2w6Ii0iOw0KICAgICAgICBpZih0aGlzLm9ydGhvVGFibGVEYXRhLmluZGV4T2YoaXRlbSk9PS0xKXsNCiAgICAgICAgICB0aGlzLm9ydGhvVGFibGVEYXRhLnB1c2goaXRlbSkNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLm9ydGhvTG9hZGluZz1mYWxzZTsNCiAgICAgIH0pDQogICAgfSkNCiAgICANCiAgICB0aGlzLnNob3dPcnRob1N1YlRhYmxlID0gdHJ1ZTsNCiAgICB0aGlzLm9ydGhvTG9hZGluZz1mYWxzZTsNCiAgICB0aGlzLnNob3dTdWJUYWJsZUJveD10cnVlOw0KDQogICAgLy8g5bem5L6n5Z+65Zug55qE5o6l5Y+j5pWw5o2uDQogICAgbGV0IHNucElkMSA9IHJvd1ZhbHVlLnNucElkOw0KICAgIGxldCBkYXRhU291cmNlMT1yb3dWYWx1ZS5kYXRhU291cmNlDQogICAgbGV0IEJBU0VQQVRIPSIiOw0KICAgIHRoaXMuZ3dhc0luZm9EYXRhPVtdOw0KICAgIGlmKGRhdGFTb3VyY2UxIT0gbnVsbCAmJiBkYXRhU291cmNlMS5sZW5ndGghPT0wKXsNCiAgICAgIGlmKGRhdGFTb3VyY2UxLmluZGV4T2YoInYyIik+MCl7QkFTRVBBVEg9Imh0dHBzOi8vbmdkYy5jbmNiLmFjLmNuL2d2bVJFU1RWMi92Mi92YXJpYW50cy9nZXRsaXN0P2RhdGFTb3VyY2U9In0NCiAgICAgIGVsc2V7QkFTRVBBVEg9Imh0dHBzOi8vbmdkYy5jbmNiLmFjLmNuL2d2bVJFU1RWMy92Mi92YXJpYW50cy9nZXRsaXN0P2RhdGFTb3VyY2U9In0NCiAgICAgIC8vIGxldCBzbnBBbGw9aS5zbnBMaXN0LmpvaW4oJywnKQ0KICAgICAgbGV0IFBBVEg9IiI7DQoJCWlmKEJBU0VQQVRILmxlbmd0aD4wKQ0KCQkJUEFUSD1CQVNFUEFUSCtkYXRhU291cmNlMSsiJnNucGxpc3Q9IitzbnBJZDE7DQoJCQ0KICAgICAgaWYoc25wSWQxLmxlbmd0aD4wICYmIFBBVEgubGVuZ3RoPjApew0KICAgICAgICAgIHRoaXMuZ2V0VmFyRGF0YShQQVRIKQ0KICAgICAgfQ0KICAgIH0NCiAgICAvLyDlj7Pkvqfln7rlm6DmjqXlj6PmlbDmja4NCiAgICBvcnRob2xpc3QuZm9yRWFjaCgoaXRlbSk9PnsNCiAgICBsZXQgZGF0YVNvdXJjZTI9aXRlbS5kYXRhU291cmNlOw0KICAgIGxldCBoZGJpZD1pdGVtLmhkYklkOw0KICAgIGxldCB2YXJOYW1lPWl0ZW0udmFyTmFtZTsNCiAgICBsZXQgZ3dhc09yZ0lkPWl0ZW0uZ3dhc09yZ0lkOw0KICAgIGxldCBQQVRIPSIiOw0KICAgIGlmKGRhdGFTb3VyY2UyIT0gbnVsbCAmJiBkYXRhU291cmNlMi5sZW5ndGg+MCl7DQogICAgICB0aGlzLiRheGlvcy5nZXQoImh0dHBzOi8vbmdkYy5jbmNiLmFjLmNuL2hhcGkvYXBpL3Zhci1zbnBpZCIse3BhcmFtczp7J2hkYklkJzogaGRiaWQsInZhck5hbWUiOnZhck5hbWV9fSkudGhlbihyZXM9PnsNCiAgICAgICAgICBpZihyZXMgIT1udWxsICYmIHJlcy5kYXRhICE9IG51bGwgJiYgcmVzLmRhdGEubGVuZ3RoICE9PTApew0KICAgICAgICAgICAgbGV0IEJBU0VQQVRIPSIiOw0KICAgICAgICAgICAgbGV0IHNucElkMj1yZXMuZGF0YTsNCiAgICAgICAgICAgIHRoaXMuZ3dhc0xvYWRpbmc9dHJ1ZTsNCiAgICAgICAgICAgIGlmKGRhdGFTb3VyY2UyLmluZGV4T2YoInYyIik+MCl7QkFTRVBBVEg9Imh0dHBzOi8vbmdkYy5jbmNiLmFjLmNuL2d2bVJFU1RWMi92Mi92YXJpYW50cy9nZXRsaXN0P2RhdGFTb3VyY2U9Ig0KICAgICAgICAgICAgfWVsc2V7QkFTRVBBVEg9Imh0dHBzOi8vbmdkYy5jbmNiLmFjLmNuL2d2bVJFU1RWMy92Mi92YXJpYW50cy9nZXRsaXN0P2RhdGFTb3VyY2U9In0NCgkJCWlmKEJBU0VQQVRILmxlbmd0aD4wKQ0KICAgICAgICAgICAgUEFUSD1CQVNFUEFUSCtkYXRhU291cmNlMisiJnNucGxpc3Q9IitzbnBJZDI7DQogICAgICAgICAgfQ0KICAgICAgICB9KS5maW5hbGx5KA0KICAgICAgICAgICgpPT57DQoJCQlpZihQQVRILmxlbmd0aD4wKXsNCgkJCQkNCgkJCQl0aGlzLmdldFZhckRhdGEoUEFUSCxnd2FzT3JnSWQpDQoJCQl9DQoNCiAgICAgICAgICB9DQogICAgICAgICkNCiAgICB9DQogICB9KQ0KIA0KICAgIA0KICAgIA0KICAgfSwNCiAgIGdldFZhckRhdGEoUEFUSCxnd2FzT3JnSWQpew0KICAgIHRoaXMuJGF4aW9zLmdldChQQVRIKS50aGVuKHJlc3BvbnNlPT57DQogICAgICB0aGlzLmd3YXNMb2FkaW5nPWZhbHNlOw0KICAgICAgdGhpcy5nd2FzSW5mb0RhdGE9W107DQogICAgICAvL3RoaXMuZ3dhc0luZm9EYXRhPXJlc3BvbnNlLmRhdGEuc25wOw0KICAgICAgdGhpcy52YXJMb2FkaW5nPWZhbHNlOw0KICAgICAgbGV0IGRhdGFzPXJlc3BvbnNlLmRhdGEuc25wDQogICAgICBpZihkYXRhcy5sZW5ndGg+MCl7DQogICAgICAgIC8vIOi/lOWbnuaYr+WvueixoQ0KICAgICAgICBmb3IobGV0IGl0ZW0gb2YgZGF0YXMpew0KICAgICAgICAgICBpdGVtLm9yZ0lkPWd3YXNPcmdJZA0KICAgICAgICB9DQogICAgICAgIHRoaXMuZ3dhc0luZm9EYXRhPXRoaXMuZ3dhc0luZm9EYXRhLmNvbmNhdChkYXRhcyk7DQogICAgICB9ZWxzZXsNCiAgICAgICAgLy8g6L+U5Zue5piv5a+56LGhDQogICAgICAgIGRhdGFzLm9yZ0lkPWd3YXNPcmdJZA0KICAgICAgICB0aGlzLmd3YXNJbmZvRGF0YS5wdXNoKGRhdGFzKTsNCiAgICAgIH0NCiAgICAgIC8vIOWvuei/lOWbnuaVsOaNrui/m+ihjOagvOW8j+WkhOeQhg0KICAgICAgZm9yKGxldCBpdGVtIG9mIHRoaXMuZ3dhc0luZm9EYXRhKXsNCiAgICAgICAgICBsZXQgcG9zPWl0ZW0uY2hyb20rIjoiK2l0ZW0ucG9zaXRpb247DQogICAgICAgICAgbGV0IGFsbGVsZT1pdGVtLnJlZmFsbGVsZSsiLyIraXRlbS5hbGxlbGU7DQogICAgICAgICAgbGV0IG1hZj1pdGVtLm1hZisiOiIraXRlbS5tYWZmcmVxLnNsaWNlKDAsNyk7DQogICAgICAgICAgbGV0IGNsYXNzc25wPSJTTlAiOw0KCQkJCQlpdGVtLmZpbmFscG9zaXRpb249cG9zOw0KCQkJCQlpdGVtLmZpbmFsYWxsZWxlPWFsbGVsZTsNCgkJCQkJaXRlbS5maW5hbG1hZj1tYWY7DQogICAgICAgICAgaXRlbS5zbnBDbGFzc0lkPWNsYXNzc25wOw0KICAgICAgICAgIGlmKGl0ZW0uZ2VuZS5sZW5ndGg+MSl7DQogICAgICAgICAgICBsZXQgbmFtZT1bXTsNCiAgICAgICAgICAgIGxldCBjb25zZXF0eXBlPVtdOw0KICAgICAgICAgICAgbGV0IGFsbGlhbHM9W107DQogICAgICAgICAgICBpdGVtLmdlbmUuZm9yRWFjaChpdGVtPT57DQogICAgICAgICAgICAgIG5hbWUucHVzaChpdGVtLmdlbmVuYW1lKTsNCiAgICAgICAgICAgICAgaWYoY29uc2VxdHlwZS5pbmRleE9mKGl0ZW0uY29uc2VxdHlwZSk9PS0xKXsNCiAgICAgICAgICAgICAgICBjb25zZXF0eXBlLnB1c2goaXRlbS5jb25zZXF0eXBlKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICBpZihhbGxpYWxzLmluZGV4T2YoaXRlbS5nZW5lYWxpYXMpPT0tMSl7DQogICAgICAgICAgICAgICAgYWxsaWFscy5wdXNoKGl0ZW0uZ2VuZWFsaWFzKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICANCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICBpdGVtLmZpbmFsZ2VuZW5hbWU9bmFtZS5qb2luKCcsJyk7DQogICAgICAgICAgICBpdGVtLmZpbmFsQ29uc2VxdHlwZT1jb25zZXF0eXBlLmpvaW4oJywnKTsNCiAgICAgICAgICAgIGl0ZW0uZmluYWxHZW5lYWxpYXM9YWxsaWFscy5qb2luKCcsJyk7DQogICAgICAgICAgICBpdGVtLmZpbmFsR2VuZWFsaWFzPWl0ZW0uZmluYWxHZW5lYWxpYXMubGVuZ3RoPjA/aXRlbS5maW5hbEdlbmVhbGlhczoiLSI7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgIGl0ZW0uZmluYWxnZW5lbmFtZT1pdGVtLmdlbmUuZ2VuZW5hbWU7DQogICAgICAgICAgaXRlbS5maW5hbENvbnNlcXR5cGU9aXRlbS5nZW5lLmNvbnNlcXR5cGU7DQogICAgICAgICAgaXRlbS5maW5hbEdlbmVhbGlhcz1pdGVtLmdlbmUuZ2VuZWFsaWFzOw0KICAgICAgICB9DQogICAgICB9DQogICAgICB9KQ0KICAgfSwNCiAgICBoaWxpZ3REYkNvbHMoe3Jvd0luZGV4fSl7DQogICAgICBpZihyb3dJbmRleD09PTEpew0KICAgICAgICAgIHJldHVybiAid3JpdGluZy1tb2RlOiB2ZXJ0aWNhbC1scjsgIWltcG9ydGFudDt0ZXh0LWFsaWduOnJpZ2h0Ig0KICAgICAgfQ0KICAgICAgDQogICAgfSwNCiAgICBpY29uQ2xhc3MoZGF0YSxpbmRleCl7DQogICAgICAgIGRhdGEuc3BlY2llc0xpc3REYXRhLmZvckVhY2goKGlkLGlkeCk9PnsNCiAgICAgICAgICBpZihpZD09aW5kZXgpew0KICAgICAgICAgICAgaWYoIGRhdGEub3J0aG9MaXN0W2lkeF0udmFyTmFtZSE9bnVsbCApew0KICAgICAgICAgICAgICBsZXQgdHJhaXRsaXN0PWRhdGEub3J0aG9MaXN0W2lkeF0udmFyTmFtZS5zcGxpdCgiLCIpDQogICAgICAgICAgICAgIGlmKHRyYWl0bGlzdC5pbmRleE9mKGRhdGEudmFyTmFtZSk+LTEpew0KICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICByZXR1cm4gMjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAgIH0NCiAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgIC8vIH0NCiAgICB9LA0KICAgDQogICAgc2VhcmNoRmlsdGVyKCl7DQogICAgICAvLyDku4XlnKjovpPlhaXkuobmn6Xor6Lniannp43lkozln7rlm6DnmoTml7blgJnlj5HpgIHor7fmsYINCiAgICAgIGlmKHRoaXMuZm9ybS5xdWVyeVNwZWNpZXM9PSIiICYmIHRoaXMuZm9ybS5nZW5lPT0iIil7DQogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ1BsZWFzZSBlbnRlciBxdWVyeSBjcml0ZXJpYScpOw0KICAgICAgfWVsc2V7DQogICAgICAgIGlmKHRoaXMuY2xhc3NpZmljYXRpb249PSJhbmltYWwiKXsNCiAgICAgICAgICB0aGlzLmxvYWRpbmdfYW5pbWFsPXRydWU7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgIHRoaXMubG9hZGluZ19wbGFudD10cnVlOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICB0aGlzLnBhZ2VObz0xOw0KICAgICAgICB0aGlzLmdldFRyYWl0RGF0YSh0aGlzLnZhckl0ZW0udmFyTmFtZSx0aGlzLmNsYXNzaWZpY2F0aW9uKQ0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICB0aGlzLm1lc3NhZ0Vycm9yKHRoaXMuY2xhc3NpZmljYXRpb24pDQogICAgICAgIH0sIDEwMDApOw0KICAgICAgfQ0KICAgIH0sIA0KICAgIGNsZWFyRmlsdGVyKCl7DQogICAgICBpZih0aGlzLmZvcm0ucXVlcnlTcGVjaWVzIT09IiIgfHwgdGhpcy5mb3JtLmdlbmUhPT0iIil7DQogICAgICAgIA0KICAgICAgICB0aGlzLmZvcm0ucXVlcnlTcGVjaWVzPSIiOw0KICAgICAgICB0aGlzLmZvcm0uZ2VuZT0iIjsNCiAgICAgICAgaWYodGhpcy5jbGFzc2lmaWNhdGlvbj09ImFuaW1hbCIpew0KICAgICAgICAgIHRoaXMubG9hZGluZ19hbmltYWw9dHJ1ZTsNCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgdGhpcy5sb2FkaW5nX3BsYW50PXRydWU7DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5nZXRUcmFpdERhdGEodGhpcy52YXJJdGVtLnZhck5hbWUsdGhpcy5jbGFzc2lmaWNhdGlvbikNCiAgICAgICAgLy8gdGhpcy5nZXRUcmFpdERhdGEodGhpcy52YXJJdGVtLnZhck5hbWUsInBsYW50IikNCiAgICAgIH0NCiAgICB9LA0KICAgIGFzeW5jIHNob3dUYWJsZUljb24oZGF0YSxjbGFzc3NzKXsNCiAgICAgIA0KICAgICAgaWYoY2xhc3NzcyA9PSAicGxhbnQiKXsNCiAgICAgICAgdGhpcy5zcGVjaWVzTGlzdF9wbGFudD1bXTsNCiAgICAgICAgdGhpcy5zcGVjaWVzTGlzdF9wbGFudF8xPVtdOw0KICAgICAgICBpZihkYXRhLmxlbmd0aD4wKXsNCiAgICAgICAgICBmb3IobGV0IHZhckRhdGEgb2YgZGF0YSl7DQogICAgICAgICAgICAvLyDlop7liqDkuIDkuKrlsZ7mgKfkv53lrZjniannp43nmoRpbmRleO+8jOeUqOadpeaYvuekuuihqOagvOmHjOeahGljb24NCiAgICAgICAgICAgIHZhckRhdGEuc3BlY2llc0xpc3REYXRhPVtdOw0KICAgICAgICAgICAgLy8g5aKe5Yqg5LiA5Liq5bGe5oCn77yM5L+d5a2Y5pi+56S65pyJdHJhaXTmlbDmja7nmoTmg4XlhrUNCiAgICAgICAgICAgIHZhckRhdGEudHJhaXRMaXN0RGF0YTE9W107DQogICAgICAgICAgICB2YXJEYXRhLnRyYWl0TGlzdERhdGEyPVtdOw0KICAgICAgICAgICAgaWYodmFyRGF0YS5vcnRob0xpc3Qpew0KICAgICAgICAgICAgICBmb3IobGV0IGl0ZW0gb2YgdmFyRGF0YS5vcnRob0xpc3Qpew0KICAgICAgICAgICAgICAgIGxldCBzcGVjaWVzTmFtZT1pdGVtLnNwZWNpZXMuY29tbW9uTmFtZQ0KICAgICAgICAgICAgICAgIGlmKHRoaXMuc3BlY2llc0xpc3RfcGxhbnQuaW5kZXhPZihzcGVjaWVzTmFtZSk9PS0xKXsNCiAgICAgICAgICAgICAgICAgIHRoaXMuc3BlY2llc0xpc3RfcGxhbnQucHVzaChzcGVjaWVzTmFtZSk7DQogICAgICAgICAgICAgICAgICBpdGVtLnNwZWNpZXMuY2hlY2tlZD10cnVlOw0KICAgICAgICAgICAgICAgICAgdGhpcy5zcGVjaWVzTGlzdF9wbGFudF8xLnB1c2goaXRlbS5zcGVjaWVzKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdmFyRGF0YS5zcGVjaWVzTGlzdERhdGEucHVzaCh0aGlzLnNwZWNpZXNMaXN0X3BsYW50LmluZGV4T2Yoc3BlY2llc05hbWUpKTsNCiAgICAgICAgICAgICAgICBpZihpdGVtLnZhck5hbWUgIT09IG51bGwpew0KICAgICAgICAgICAgICAgICAgdmFyRGF0YS50cmFpdExpc3REYXRhMi5wdXNoKHRoaXMuc3BlY2llc0xpc3RfcGxhbnQuaW5kZXhPZihzcGVjaWVzTmFtZSkpDQogICAgICAgICAgICAgICAgICBsZXQgdmFybGlzdD1pdGVtLnZhck5hbWUuc3BsaXQoJywnKQ0KICAgICAgICAgICAgICAgICAgaWYodmFybGlzdC5pbmRleE9mKCB2YXJEYXRhLnZhck5hbWUpPi0xKXsNCiAgICAgICAgICAgICAgICAgICAgICB2YXJEYXRhLnRyYWl0TGlzdERhdGExLnB1c2godGhpcy5zcGVjaWVzTGlzdF9wbGFudC5pbmRleE9mKHNwZWNpZXNOYW1lKSkNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgLy8gdGhpcy4kcmVmc1sndGFibGUnXS5kb0xheW91dCgpOw0KICAgICAgICB9DQogICAgfWVsc2V7DQogICAgICB0aGlzLnNwZWNpZXNMaXN0X2FuaW1hbD1bXTsNCiAgICAgIA0KICAgICAgdGhpcy5zcGVjaWVzTGlzdF9hbmltYWxfMT1bXTsNCiAgICAgICAgaWYoZGF0YS5sZW5ndGg+MCl7DQogICAgICAgICAgZm9yKGxldCB2YXJEYXRhIG9mIGRhdGEpew0KICAgICAgICAgICAgLy8g5aKe5Yqg5LiA5Liq5bGe5oCn5L+d5a2Y54mp56eN55qEaW5kZXjvvIznlKjmnaXmmL7npLrooajmoLzph4znmoRpY29uDQogICAgICAgICAgICB2YXJEYXRhLnNwZWNpZXNMaXN0RGF0YT1bXTsNCiAgICAgICAgICAgIHZhckRhdGEudHJhaXRMaXN0RGF0YTE9W107DQogICAgICAgICAgICB2YXJEYXRhLnRyYWl0TGlzdERhdGEyPVtdOw0KICAgICAgICAgICAgaWYodmFyRGF0YS5vcnRob0xpc3Qpew0KICAgICAgICAgICAgICBmb3IobGV0IGl0ZW0gb2YgdmFyRGF0YS5vcnRob0xpc3Qpew0KICAgICAgICAgICAgICAgIGxldCBzcGVjaWVzTmFtZT1pdGVtLnNwZWNpZXMuY29tbW9uTmFtZTsNCiAgICAgICAgICAgICAgICBpZih0aGlzLnNwZWNpZXNMaXN0X2FuaW1hbC5pbmRleE9mKHNwZWNpZXNOYW1lKT09LTEpew0KICAgICAgICAgICAgICAgICAgdGhpcy5zcGVjaWVzTGlzdF9hbmltYWwucHVzaChzcGVjaWVzTmFtZSk7DQogICAgICAgICAgICAgICAgICBpdGVtLnNwZWNpZXMuY2hlY2tlZD10cnVlOw0KICAgICAgICAgICAgICAgICAgdGhpcy5zcGVjaWVzTGlzdF9hbmltYWxfMS5wdXNoKGl0ZW0uc3BlY2llcyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHZhckRhdGEuc3BlY2llc0xpc3REYXRhLnB1c2godGhpcy5zcGVjaWVzTGlzdF9hbmltYWwuaW5kZXhPZihzcGVjaWVzTmFtZSkpOw0KICAgICAgICAgICAgICAgIGlmKGl0ZW0udmFyTmFtZSAhPT0gbnVsbCl7DQogICAgICAgICAgICAgICAgICAvLyDmnIl0cmFpdOS9huS4jeebuOWQjA0KICAgICAgICAgICAgICAgICAgIHZhckRhdGEudHJhaXRMaXN0RGF0YTIucHVzaCh0aGlzLnNwZWNpZXNMaXN0X2FuaW1hbC5pbmRleE9mKHNwZWNpZXNOYW1lKSkNCiAgICAgICAgICAgICAgICAgIGxldCB2YXJsaXN0PWl0ZW0udmFyTmFtZS5zcGxpdCgnLCcpDQogICAgICAgICAgICAgICAgICBpZih2YXJsaXN0LmluZGV4T2YoIHZhckRhdGEudmFyTmFtZSk+LTEpew0KICAgICAgICAgICAgICAgICAgICAvLyDmnInnm7jlkIx0cmFpdA0KICAgICAgICAgICAgICAgICAgICAgIHZhckRhdGEudHJhaXRMaXN0RGF0YTEucHVzaCh0aGlzLnNwZWNpZXNMaXN0X2FuaW1hbC5pbmRleE9mKHNwZWNpZXNOYW1lKSkNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkYXRhKTsNCiAgICB9LA0KICAgIC8vIOS4u+imgeiOt+WPluaVsOaNrueahOaWueazlQ0KICAgIC8vIOagueaNruWKqOakjeeJqeWIhuW8gOiOt+WPlg0KICAgIGFzeW5jIGdldFRyYWl0RGF0YSh2YXJuYW1lLGNsYXNzaWZpY2F0aW9uLGhkYklkLHRheG9uSWQpew0KICAgICAgLy8g5YiG5Lik56eN5oOF5Ya177yM5aaC5p6c5LiN5Lyg5YWlY2xhc3NpZmljYXRpb27vvIzlsLHliqjmpI3nianpg73or7fmsYINCiAgICAgIGlmKHRoaXMuZm9ybS5nZW5lIT09JycgJiYgdGhpcy5mb3JtLmdlbmUgIT09dW5kZWZpbmVkKXsNCiAgICAgICAgdGhpcy5mb3JtLmdlbmU9dGhpcy5mb3JtLmdlbmUudHJpbSgpDQogICAgICB9DQogICAgICAvLyDlpoLmnpzkvKDlhaXkuoZjbGFzc2lmaWNhdGlvbu+8jOWwseivt+axguivpeWIhuexuw0KICAgICAgLy8g5rKh5Lyg5YWl5bCx6YO96K+35rGCDQogICAgICBpZihjbGFzc2lmaWNhdGlvbiAhPT0nJyAmJiBjbGFzc2lmaWNhdGlvbiAhPT11bmRlZmluZWQpew0KICAgICAgICAvLyB0aGlzLmJvdGg9ZmFsc2U7DQogICAgICAgIHRoaXMuYXhpb3NSZXF1ZXN0KHZhcm5hbWUsY2xhc3NpZmljYXRpb24saGRiSWQsdGF4b25JZCkNCiAgICAgIH1lbHNlew0KICAgICAgICAvLyB0aGlzLmJvdGg9dHJ1ZTsNCiAgICAgICAgdGhpcy5heGlvc1JlcXVlc3QodmFybmFtZSwiYW5pbWFsIixoZGJJZCx0YXhvbklkKTsNCiAgICAgICAgdGhpcy5heGlvc1JlcXVlc3QodmFybmFtZSwicGxhbnQiLGhkYklkLHRheG9uSWQpOw0KICAgICAgfQ0KICAgDQogICAgfSwNCiAgICBheGlvc1JlcXVlc3QodmFybmFtZSxjbGFzc2lmaWNhdGlvbixoZGJJZCx0YXhvbklkKXsNCiAgICAgIGlmKGNsYXNzaWZpY2F0aW9uPT0iYW5pbWFsIil7dGhpcy5wYWdlTm89dGhpcy5jdXJyZW50UGFnZTRfYX1lbHNlIGlmKGNsYXNzaWZpY2F0aW9uPT0icGxhbnQiKXsNCiAgICAgICAgdGhpcy5wYWdlTm89dGhpcy5jdXJyZW50UGFnZTRfcA0KICAgICAgfWVsc2V7dGhpcy5wYWdlTm89MX0NCiAgICAgICB0aGlzLiRheGlvcy5nZXQoImh0dHBzOi8vbmdkYy5jbmNiLmFjLmNuL2hhcGkvYXBpL3ZhcmlhbnRzIix7cGFyYW1zOnsnY2xhc3NpZmljYXRpb24nOiBjbGFzc2lmaWNhdGlvbiwndmFybmFtZSc6dmFybmFtZSwnbGVuZ3RoJzp0aGlzLnBhZ2VTaXplLCdwYWdlTm8nOnRoaXMucGFnZU5vLCdzcGVjaWVzTmFtZSc6dGhpcy5mb3JtLnF1ZXJ5U3BlY2llcywnZ2VuZWlkJzp0aGlzLmZvcm0uZ2VuZSwnaGRiSWQnOmhkYklkLCd0YXhvbklkJzp0YXhvbklkfX0pDQogICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgICAgICB0aGlzLmdldFNwZWNpZXModmFybmFtZSxjbGFzc2lmaWNhdGlvbikNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYoY2xhc3NpZmljYXRpb249PSdhbmltYWwnKXsNCiAgICAgICAgICAgICAgdGhpcy50b3RhbFNpemVfYW5pbWFsID0gcmVzcG9uc2UuZGF0YS5yZWNvcmRzVG90YWw7DQogICAgICAgICAgICAgIHRoaXMuc2hvd1RhYmxlSWNvbihyZXNwb25zZS5kYXRhLmRhdGEsY2xhc3NpZmljYXRpb24pLnRoZW4oKHJlcyk9PnsgdGhpcy50cmFpdERhdGFfYW5pbWFsPXJlczsgdGhpcy5sb2FkaW5nX2FuaW1hbD1mYWxzZTt9KTsNCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICB0aGlzLnRvdGFsU2l6ZV9wbGFudCA9IHJlc3BvbnNlLmRhdGEucmVjb3Jkc1RvdGFsOw0KICAgICAgICAgICAgICB0aGlzLnNob3dUYWJsZUljb24ocmVzcG9uc2UuZGF0YS5kYXRhLGNsYXNzaWZpY2F0aW9uKS50aGVuKChyZXMpPT57IHRoaXMudHJhaXREYXRhX3BsYW50PXJlczsgdGhpcy5sb2FkaW5nX3BsYW50PWZhbHNlO30pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy8g5Yik5pat5LuA5LmI5pe25YCZ6K+l546w5a6ebm8gZGF0YeeahOaPkOekug0KICAgICAgICB9KS5maW5hbGx5KCgpPT57DQogICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfSkNCiAgICB9LA0KICAgIC8vIOagueaNruW9k+WJjWNsYXNzaWZpY2F0aW9u5Yik5pat6I635Y+W5Yqo54mp5oiW5qSN54mp5YiX6KGoDQogICAgZ2V0U3BlY2llcyh2YXJOYW1lLHNwZWNpZXNUeXBlKXsNCiAgICAgIHRoaXMuJGF4aW9zLmdldCgnaHR0cHM6Ly9uZ2RjLmNuY2IuYWMuY24vaGFwaS9hcGkvc3BlY2llcy12YXInLHtwYXJhbXM6IHsidmFyTmFtZSI6dmFyTmFtZSxzcGVjaWVzVHlwZTogc3BlY2llc1R5cGV9fSkNCiAgICAgICAgLnRoZW4ocmVzcG9uc2U9PnsNCiAgICAgICAgICAvLyAy5piv5qSN54mp77yMMeaYr+WKqOeJqQ0KICAgICAgICAgIGlmKHNwZWNpZXNUeXBlPT0ncGxhbnQnKXsNCiAgICAgICAgICAgIHRoaXMucXVlcnlTcGVjaWVzTGlzdF9wbGFudD1yZXNwb25zZS5kYXRhOw0KICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgdGhpcy5xdWVyeVNwZWNpZXNMaXN0X2FuaW1hbD1yZXNwb25zZS5kYXRhOw0KICAgICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwgIA0KICAgIGNsZWFyVHJhaXRGaWx0ZXIoKXsNCiAgICAgICAgdGhpcy52YXJJdGVtPXsNCiAgICAgICAgICB2YXJOYW1lOiIiDQogICAgICAgIH0NCiAgICAgICAgaWYodGhpcy5jbGFzc2lmaWNhdGlvbj09J2FuaW1hbCcpe3RoaXMubG9hZGluZ19hbmltYWw9dHJ1ZX1lbHNle3RoaXMubG9hZGluZ19wbGFudD10cnVlfQ0KICAgICAgICB0aGlzLnNob3dUaXRsZT1mYWxzZTsNCiAgICAgICAgLy8gbGV0IHBhcmFtczE9e2NsYXNzaWZpY2F0aW9uOiJhbmltYWwifQ0KICAgICAgICAvLyBsZXQgcGFyYW1zPXt0cmFpdElkOnRoaXMudHJhaXRJdGVtLnRyYWl0RGVmSUQsY2xhc3NpZmljYXRpb246dGhpcy50cmFpdEl0ZW0uY2xhc3NpZmljYXRpb24scGFnZXNpemU6dGhpcy5wYWdlU2l6ZSxwYWdlbnVtOjEsc3BlY2llc05hbWU6dGhpcy5mb3JtLnF1ZXJ5U3BlY2llc30NCiAgICAgICAgLy8gbGV0IHBhcmFtczI9e2NsYXNzaWZpY2F0aW9uOiJwbGFudCJ9DQogICAgICAgIHRoaXMuZ2V0VHJhaXREYXRhKCIiLCJhbmltYWwiKTsNCiAgICAgICAgdGhpcy5nZXRUcmFpdERhdGEoIiIsInBsYW50Iik7DQogICAgICAgIC8vIHRoaXMuZ2V0VHJhaXREYXRhKCIiLCJwbGFudCIpOw0KICAgICAgfSwNCiAgICBleHBvcnRUb0V4Y2VsKGNsYXNzcykgew0KICAgICAgbGV0IG9yaURhdGE7DQogICAgICBpZihjbGFzc3M9PSdhbmltYWwnKXtvcmlEYXRhPXRoaXMudHJhaXREYXRhX2FuaW1hbH1lbHNle29yaURhdGE9dGhpcy50cmFpdERhdGFfcGxhbnR9DQogICAgICBpbXBvcnQoJ0AvdmVuZG9yL0V4cG9ydDJFeGNlbCcpLnRoZW4oZXhjZWwgPT4gew0KICAgICAgICBjb25zdCB0SGVhZGVyID0gWyAnVmFyaWFudCBUZXJtJywiR2VuZSBJRCIsIlNwZWNpZXMgQ29tbW9uIE5hbWUiLCJUYXhvbiBJRCIsIkhvbW9sb2dvdXMgSW5mbyBEYXRhIl0NCiAgICAgICAgY29uc3QgZmlsdGVyVmFsID0gWyd2YXJOYW1lJywnZ2VuZUlkJywnc3BlY2llc0NvbW1vbk5hbWUnLCd0YXhvbklkJywnb3J0aG9MaXN0J10NCiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZm9ybWF0SnNvbihmaWx0ZXJWYWwsIG9yaURhdGEpDQogICAgICAgIGV4Y2VsLmV4cG9ydF9qc29uX3RvX2V4Y2VsKHsNCiAgICAgICAgICBoZWFkZXI6IHRIZWFkZXIsDQogICAgICAgICAgZGF0YSwNCiAgICAgICAgICBmaWxlbmFtZToicHVibGljX291dGVyIg0KICAgICAgICB9KQ0KICAgICAgfSkNCiAgICB9LA0KICAgIGV4cG9ydFRvU3ViT3J0aG9UYWJsZUV4Y2VsKG9ydGhvZGF0YSkgew0KICAgICAgaW1wb3J0KCdAL3ZlbmRvci9FeHBvcnQyRXhjZWwnKS50aGVuKGV4Y2VsID0+IHsNCiAgICAgICAgY29uc3QgdEhlYWRlciA9IFsgJ1NwZWNpZXMnLCJUYXhvbiBJRCIsIkVuc2VtYmwgSUQiLCdHZW5lIFN5bWJvbCcsIlByb3RlaW4gSUQiLCJEYXRhU291cmNlIl0NCiAgICAgICAgY29uc3QgZmlsdGVyVmFsID0gWydjb21tb25OYW1lJywndGF4JywnZW5zZW1ibEdlbmVJZCcsJ2dlbmVTeW1ib2wnLCJoZGJJZCIsImRiRXZpZGVuY2UiXQ0KICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5mb3JtYXRKc29uKGZpbHRlclZhbCwgb3J0aG9kYXRhKQ0KICAgICAgICBleGNlbC5leHBvcnRfanNvbl90b19leGNlbCh7DQogICAgICAgICAgaGVhZGVyOiB0SGVhZGVyLA0KICAgICAgICAgIGRhdGEsDQogICAgICAgICAgZmlsZW5hbWU6IkhvbW9sb2dfT3V0ZXIiDQogICAgICAgIH0pDQogICAgICB9KQ0KICAgIH0sDQogICAgZXhwb3J0VG9TdWJHd2FzVGFibGVFeGNlbChnd2FzZGF0YSkgew0KICAgICAgaW1wb3J0KCdAL3ZlbmRvci9FeHBvcnQyRXhjZWwnKS50aGVuKGV4Y2VsID0+IHsNCiAgICAgICAgY29uc3QgdEhlYWRlciA9IFsgJ0dlbmUgSUQnLCJWYXIgSUQiLCJQb3NpdGlvbiIsJ0FsbGVsZScsIk1BRiIsIkNsYXNzIiwiQ29uc2VxdWVuY2UgVHlwZS9FZmZlY3QiLCJHZW5lIFN5bWJvbCJdDQogICAgICAgIGNvbnN0IGZpbHRlclZhbCA9IFsnZmluYWxnZW5lbmFtZScsJ3JzbnBJZCcsJ2ZpbmFscG9zaXRpb24nLCdmaW5hbGFsbGVsZScsJ2ZpbmFsbWFmJywic25wQ2xhc3NJZCIsJ2ZpbmFsQ29uc2VxdHlwZScsJ2ZpbmFsR2VuZWFsaWFzJ10NCiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZm9ybWF0SnNvbihmaWx0ZXJWYWwsIGd3YXNkYXRhKQ0KICAgICAgICBleGNlbC5leHBvcnRfanNvbl90b19leGNlbCh7DQogICAgICAgICAgaGVhZGVyOiB0SGVhZGVyLA0KICAgICAgICAgIGRhdGEsDQogICAgICAgICAgZmlsZW5hbWU6IlZhcmlhbnRzX091dGVyIg0KICAgICAgICB9KQ0KICAgICAgfSkNCiAgICB9LA0KICAgIGZvcm1hdEpzb24oZmlsdGVyVmFsLCBqc29uRGF0YSkgew0KICAgICAgcmV0dXJuIGpzb25EYXRhLm1hcCh2ID0+IGZpbHRlclZhbC5tYXAoaiA9PiB7DQogICAgICAgIGlmKGo9PSJvcnRob0xpc3QiKXsNCiAgICAgICAgICAgIGxldCBvcnRob0RhdGE9dltqXTsNCiAgICAgICAgICAgIGxldCBvcnRob0xpc3Q9W10NCiAgICAgICAgICAgIGZvcihsZXQgaXRlbSBvZiBvcnRob0RhdGEpew0KICAgICAgICAgICAgICBsZXQgb3J0aG9kYXRhSW5mbz17IlNwZWNpZXMgQ29tbW9uIE5hbWUiOml0ZW0uY29tbW9uTmFtZSwiVGF4b24gSUQiOml0ZW0udGF4LCJWYXJpYW50IFRlcm0iOml0ZW0udmFyTmFtZSwiSG9tb2xvZ291cyBQcm90ZWluIElEIjppdGVtLmhkYklkLCJEYXRhIFNvdXJjZSI6aXRlbS5kYkV2aWRlbmNlfQ0KICAgICAgICAgICAgICBvcnRob0xpc3QucHVzaChKU09OLnN0cmluZ2lmeShvcnRob2RhdGFJbmZvKSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBvcnRob0xpc3QNCiAgICAgICAgfWVsc2V7DQogICAgICAgICByZXR1cm4gIHZbal0NCiAgICAgICAgfQ0KICAgICAgfSkpDQogICAgfSwNCg0KICB9LA0KICANCg0KICBtb3VudGVkKCkgew0KICAgICANCiAgICBsZXQgaGRiSWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5oZGJJZDsNCiAgICB0aGlzLmhkYklkPWhkYklkOw0KICAgIGxldCB0YXhvbklkPXRoaXMuJHJvdXRlLnF1ZXJ5LnRheG9uSWQ7DQogICAgaWYodGF4b25JZCE9PScnJiZ0YXhvbklkIT1udWxsKXsNCiAgICAgIGxldCBjb21tb25OYW1lPXRoaXMuJHJvdXRlLnF1ZXJ5LmNvbW1vbk5hbWU7DQogICAgICB0aGlzLmZvcm0ucXVlcnlTcGVjaWVzPWNvbW1vbk5hbWU7DQogICAgfQ0KICAgIC8vIGlmKGhkYklkIT1udWxsICYmIGhkYklkIT0iIil7fQ0KICAgIGlmKGhkYklkIT0iIiYmaGRiSWQhPW51bGx8fCh0YXhvbklkIT09JycmJnRheG9uSWQhPW51bGwpKXsNCiAgICAgIGxldCBjbGFzc2lmaWNhdGlvbjsNCiAgICAgIGlmKHRoaXMuJHJvdXRlLnF1ZXJ5LnNwZWNpZXNUeXBlPT0xKXsNCiAgICAgICAgY2xhc3NpZmljYXRpb249ImFuaW1hbCI7DQogICAgICAgIHRoaXMuY2xhc3NpZmljYXRpb249ImFuaW1hbCI7DQogICAgICAgIHRoaXMubG9hZGluZ19hbmltYWw9dHJ1ZTsNCiAgICAgIH1lbHNlIGlmKHRoaXMuJHJvdXRlLnF1ZXJ5LnNwZWNpZXNUeXBlPT0yKXsNCiAgICAgICAgY2xhc3NpZmljYXRpb249InBsYW50IjsNCiAgICAgICAgdGhpcy5jbGFzc2lmaWNhdGlvbj0icGxhbnQiOw0KICAgICAgICB0aGlzLmxvYWRpbmdfcGxhbnQ9dHJ1ZTsNCiAgICAgIH0NCiAgICAgDQogICAgICB0aGlzLnZhckl0ZW09ew0KICAgICAgICB2YXJOYW1lOiIiDQogICAgICB9DQogICAgICAgIHRoaXMuc2hvd1RpdGxlPWZhbHNlOw0KICAgICAgICB0aGlzLmdldFRyYWl0RGF0YSgiIixjbGFzc2lmaWNhdGlvbixoZGJJZCx0YXhvbklkKTsNCiAgICB9ZWxzZXsNCiAgICAgIHRoaXMubG9hZGluZ19hbmltYWwgPSB0cnVlOw0KICAgICAgdGhpcy5sb2FkaW5nX3BsYW50PXRydWU7DQogICAgICB0aGlzLmdldFRyYWl0RGF0YSh0aGlzLnZhckl0ZW0udmFyTmFtZSwiIixoZGJJZCx0YXhvbklkKTsNCiAgICB9DQoNCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigic2Nyb2xsIiwgdGhpcy53YXRjaFNjcm9sbCk7DQogICAgLy8gdGhpcy5nZXRUYWJsZU1heEhlaWdodCgpOyANCiAgICAvLyBsZXQgX3RoaXMgPSB0aGlzOw0KICAgIC8vIHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uICgpIHsvL+eUqOS6juS9v+ihqOagvOmrmOW6puiHqumAguW6lOeahOaWueazlSAgDQogICAgLy8gX3RoaXMuZ2V0VGFibGVNYXhIZWlnaHQoKTsvL+iOt+WPluWuueWZqOW9k+WJjemrmOW6pu+8jOmHjeiuvuihqOagvOeahOacgOWkp+mrmOW6pg0KICAgIC8vIH0NCiAgIC8vIOiOt+WPluWKqOakjeeJqeWQjeensOWIl+ihqO+8jOeUqOS6juS4i+aLiemAieaLqeahhg0KICAgIHRoaXMuZ2V0U3BlY2llcyh0aGlzLnZhckl0ZW0udmFyTmFtZSwiYW5pbWFsIikNCiAgICB0aGlzLmdldFNwZWNpZXModGhpcy52YXJJdGVtLnZhck5hbWUsInBsYW50IikNCiAgICANCiAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInNjcm9sbCIsIHRoaXMud2F0Y2hTY3JvbGwpOw0KICAgICAgdGhpcy5nZXRUYWJsZU1heEhlaWdodCgpOyANCiAgICAgIGxldCBfdGhpcyA9IHRoaXM7DQogICAgICB3aW5kb3cub25yZXNpemUgPSBmdW5jdGlvbiAoKSB7Ly/nlKjkuo7kvb/ooajmoLzpq5jluqboh6rpgILlupTnmoTmlrnms5UgIA0KICAgICAgX3RoaXMuZ2V0VGFibGVNYXhIZWlnaHQoKTsvL+iOt+WPluWuueWZqOW9k+WJjemrmOW6pu+8jOmHjeiuvuihqOagvOeahOacgOWkp+mrmOW6pg0KICAgIH0NCiAgICANCiAgfQ0KfQ0KDQo="},{"version":3,"sources":["Variant.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA21BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Variant.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div>\r\n    <HeaderBar />\r\n    <Banner />\r\n    <!-- <Navigator /> -->\r\n    \r\n    <!-- 左侧树结构 -->\r\n    <!-- 抽屉结构 -->\r\n    <el-drawer\r\n      :visible.sync=\"drawer\"\r\n      :direction=\"direction\"\r\n    >\r\n      <div class=\"tree-div\">\r\n      <el-card shadow=\"none\" class=\"tree-card\" >\r\n      <el-input placeholder=\"Enter keywords to filter\" v-model=\"filterText\" class=\"filterInput\"> \r\n      </el-input>\r\n\r\n      <el-tree\r\n        style=\"margin-top: 15px\"\r\n        class=\"filter-tree\"\r\n        :data=\"treedata\"\r\n        default-expand-all\r\n        :filter-node-method=\"filterNode\"\r\n        icon-class=\"el-icon-s-management\"\r\n        ref=\"tree\"\r\n        :expand-on-click-node=\"false\"\r\n        @node-click=\"getInfoByTrait\"\r\n      >\r\n      </el-tree>\r\n      </el-card>\r\n    </div>\r\n    </el-drawer>\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\" class=\"arrow-title\">\r\n      <el-breadcrumb-item :to=\"{ path: '/gene' }\">Browse</el-breadcrumb-item>\r\n      <el-breadcrumb-item>Variant</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <!-- 侧边栏按钮 -->\r\n  \r\n  <el-container style=\"border: 1px solid #eee;overflow: hidden;\" id=\"trait-container\">\r\n  <div style=\"margin-top:3%\">\r\n  <div class=\"button-wrapper\">\r\n   <el-button @click=\"buttonFunction()\" ref=\"button\" id=\"button\"></el-button>\r\n   <!-- <div class=\"button-text\">Trait Ontology</div> -->\r\n  </div>\r\n  <!-- 灰色title横幅 -->\r\n   <transition name=\"el-zoom-in-top\">\r\n      <div class=\"trait-box trait-infoBox\"  v-show=\"showTitle\">\r\n        <div style=\"padding-left:29px;margin-top: -15px;\">\r\n          <h2 class=\"trait-title\">Consequence Type : {{ varItem.varName }} </h2>\r\n        </div>\r\n        <el-button @click=\"clearTraitFilter\" icon=\"el-icon-remove-outline\" round class=\"remove-button\">Remove filter</el-button>\r\n      </div>\r\n    </transition>\r\n    </div>\r\n    <el-card shadow=\"none\" class=\"border-card\">\r\n    <el-tabs v-model=\"classification\" style=\"margin-top:10px;margin-bottom: 1%;\" @tab-click=\"changeClass\">\r\n    <!-- 动物tab -->\r\n    <el-tab-pane label=\"Animal\" name=\"animal\" >\r\n      <!-- <el-card shadow=\"none\" class=\"tableCard\" style=\"margin-top: 10px\"> -->\r\n      <div>\r\n        <div>\r\n            <div class=\"filt-div\">\r\n              <el-input v-model=\"form.gene\" placeholder=\"Query gene\" class=\"gene-input\" clearable></el-input>\r\n              <el-select v-model=\"form.querySpecies\" class=\"filt-spe-select\" placeholder=\"Query species\" clearable>\r\n                    <el-option\r\n                        v-for=\"(item,index) in querySpeciesList_animal\"\r\n                        :key=\"index\"\r\n                        :label=\"item\"\r\n                        :value=\"item\"\r\n                        >\r\n                    </el-option>\r\n                </el-select>\r\n                <el-button icon=\"el-icon-search\" type=\"success\"  plain id=\"filter-search\" @click=\"searchFilter()\">Search</el-button>\r\n                <el-button icon=\"el-icon-delete\" type=\"primary\"  plain id=\"filter-search2\" @click=\"clearFilter()\">Clear</el-button>\r\n                <el-button type=\"primary\" icon=\"el-icon-download\" plain id=\"filterCol\" @click=\"exportToExcel('animal')\"></el-button>\r\n\r\n                <el-popover\r\n                  placement=\"bottom-end\"\r\n                  width=\"400\"\r\n                  trigger=\"manual\"\r\n                  class=\"popbox\"\r\n                  v-model=\"visible_1\">\r\n                    <div class=\"checkbox-box\">\r\n                      <el-checkbox v-for=\"item of speciesList_animal_1\" :key=\"item.commonName\" :label=\"item.commonName\" class=\"chooseColBox\" ref=\"one\" v-model=\"item.checked\"></el-checkbox>\r\n                    </div>\r\n                    <div class=\"botton-wrapper\">\r\n                      <el-button size=\"mini\" type=\"primary\"  @click=\"confirmbutton\" class=\"choose-col-button\">Close</el-button>\r\n                      <!-- <el-button size=\"mini\" type=\"text\" plain @click=\"visible_1 = false\" class=\"choose-col-button\">cancel</el-button> -->\r\n                    </div>\r\n                  <el-button slot=\"reference\" icon=\"el-icon-s-grid\" type=\"primary\" plain id=\"filterCol\" @click=\"visible_1 = !visible_1\" :disabled=\"speciesList_animal_1.length==0\"></el-button>\r\n                </el-popover>\r\n\r\n\r\n\r\n            </div>\r\n          <!-- </el-card> -->\r\n          <div id=\"wrapper\"  >\r\n          <div class=\"trait-info\">\r\n            \r\n      <!-- 使用中的trait表格 -->\r\n      <!-- <el-container style=\"width:100%;border: 1px solid darkgray;\"> -->\r\n        \r\n          <el-table\r\n            :data=\"traitData_animal\"\r\n            class=\"trait-table\"\r\n            row-key=\"id\"\r\n            ref=\"table_main_animal\"\r\n            :header-cell-style=\"hiligtDbCols\"\r\n            v-loading=\"loading_animal\"\r\n            border\r\n          >\r\n            <el-table-column align=\"center\" class=\"titleCell\" prop=\"varName\" label=\"Consequence Type\" fixed width=\"280px\" style=\"background-color:white\"></el-table-column>\r\n            <el-table-column align=\"center\" prop=\"geneId\" label=\"Gene ID\" width=\"220px\" fixed>\r\n               <template slot-scope=\"scope\">\r\n                <a :href=\"'./gene-detail?hdbId='+scope.row.hdbid+'&taxonId='+scope.row.taxonId\">\r\n                    {{ scope.row.geneId }}\r\n                </a>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column align=\"center\" prop=\"speciesCommonName\" label=\"Species Name\" width=\"150px\" fixed></el-table-column>\r\n            <el-table-column align=\"center\" prop=\"taxonId\" label=\"Taxon ID\" width=\"160px\" fixed>\r\n              <template slot-scope=\"scope\">\r\n                <a :href=\"'https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id='+scope.row.taxonId+'&lvl=3&lin=f&keep=1&srchmode=1&unlock'\">\r\n                    {{ scope.row.taxonId }}\r\n                </a>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column align=\"center\" prop=\"speciesCommonName\" label=\"Homologous Species Name\">\r\n            <template v-for=\"(item,index) in speciesList_animal_1\">\r\n              <el-table-column align=\"center\" :label=\"item.commonName\" :prop=\"item.commonName\" v-if=\"item.checked\" :key=\"item.commonName\">\r\n                <template slot-scope=\"scope\" >\r\n                  <img\r\n                    :src=\"orthoIcon\"\r\n                    min-width=\"70\"\r\n                    height=\"70\"\r\n                    class=\"iconImg\"\r\n                    v-if='scope.row.speciesListData.indexOf(index)>-1'\r\n                    style=\"cursor:pointer !important\"\r\n                    @click=showOrthoInfoTable(scope.row,index)\r\n                  />\r\n                  <!--这个v-if，先判断在当前的cell内有数值，然后再判断值 -->\r\n                  \r\n                  <img\r\n                    :src=\"singleTraitIcon\"\r\n                    min-width=\"70\"\r\n                    height=\"70\"\r\n                    class=\"iconImg\"\r\n                    v-if='scope.row.traitListData2.indexOf(index)>-1'\r\n                    style=\"cursor:pointer !important\"\r\n                    @click=showGwasInfoTable(scope.row,index)\r\n                  />\r\n                  <img\r\n                    :src=\"sameTraitIcon\"\r\n                    min-width=\"70\"\r\n                    height=\"70\"\r\n                    class=\"iconImg\"\r\n                    v-if='scope.row.traitListData1.indexOf(index)>-1'\r\n                    style=\"cursor:pointer !important\"\r\n                    @click=showGwasInfoTable(scope.row,index)\r\n                  />\r\n                </template>\r\n              </el-table-column>\r\n            </template>\r\n            </el-table-column>\r\n          </el-table>\r\n      \r\n          <div style=\"position: absolute;float: left;\">\r\n          <div style=\"display: flex;\">\r\n                    <img :src=\"orthoIcon\"\r\n                      style=\"margin-right: 6px;min-width=70px;height=70px;\"\r\n                      class=\"iconImg\" />\r\n                      <div class=\"note-info\">exists homologous gene</div>\r\n          </div>\r\n          <div style=\"display: flex;\">\r\n                    <img :src=\"singleTraitIcon\"   \r\n                      style=\"margin-right: 6px;min-width=70px;height=70px;\"\r\n                      class=\"iconImg\" /><div class=\"note-info\">exists homologous gene with variant annotation</div>  \r\n          </div>\r\n          <div style=\"display: flex;\">\r\n                    <img :src=\"sameTraitIcon\"   \r\n                      style=\"margin-right: 6px;min-width=70px;height=70px;\"\r\n                      class=\"iconImg\" /><div class=\"note-info\">exists homologous gene with same variant annotation</div>  \r\n          </div>\r\n          \r\n          </div>\r\n          <el-pagination\r\n          \r\n            class=\"trait-pag\"\r\n            @size-change=\"handleSizeChange\"\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"currentPage4_a\"\r\n            :page-sizes=\"[10, 20, 50, 100]\"\r\n            :page-size=\"pageSize\"\r\n            layout=\"total, sizes, prev, pager, next, jumper\"\r\n            :total=\"totalSize_animal\"\r\n          >\r\n          </el-pagination>\r\n      <!-- </el-container> -->\r\n      </div>\r\n</div>\r\n\r\n    <!-- 同源表格 -->\r\n    <!-- <el-card shadow=\"none\" class=\"sub-table-card\"> -->\r\n      \r\n      <div class=\"sub-trait-box \" v-if=\"showOrthoSubTable\">\r\n      <el-divider class=\"divider\"></el-divider>\r\n          <div class=\"title-box\">\r\n            <template>\r\n              <el-descriptions title=\"Selected Gene\" >\r\n                <el-descriptions-item label=\"Gene ID\"><a :href=\"'./gene-detail?hdbId='+selectGene.hdbid+'&taxonId='+selectGene.taxonId\">\r\n                    {{ selectGene.geneId }}\r\n                </a></el-descriptions-item>\r\n                <el-descriptions-item label=\"Uniprot ID\"><a :href=\"'https://www.uniprot.org/uniprot/'+selectGene.uniprotId\" target='_blank'>\r\n                    {{ selectGene.uniprotId }}\r\n                </a></el-descriptions-item>\r\n                <el-descriptions-item label=\"Ensembl Protein ID\">\r\n                  <!-- <a :href=\"'https://ensembl.org/Multi/Search/Results?q='+selectGene.ensemblId+';site=ensembl'\" target='_blank'>\r\n                    {{ selectGene.ensemblId }}\r\n                </a> -->\r\n                <a target=\"_blank\" v-if=\"tax_Plant.indexOf(String(selectGene.taxonId))==-1\" :href=\"'https://ensembl.org/Multi/Search/Results?q='+selectGene.ensemblId+';site=ensembl'\">{{selectGene.ensemblId}}</a>\r\n                <a target=\"_blank\" v-else :href=\"'https://plants.ensembl.org/Multi/Search/Results?q='+selectGene.ensemblId+';site=ensembl'\">{{selectGene.ensemblId}}</a>\r\n\r\n              </el-descriptions-item>\r\n                <el-descriptions-item label=\"Species Name\">{{selectGene.speciesCommonName}}</el-descriptions-item>\r\n                <el-descriptions-item label=\"Classification\">{{selectGene.classification}}</el-descriptions-item>\r\n                <el-descriptions-item label=\"Consequence type\">\r\n                  <el-tag size=\"small\">{{selectGene.varName}}</el-tag>\r\n                </el-descriptions-item>\r\n                <!-- <el-descriptions-item label=\"Address\"\r\n                  >No.1188, Wuzhong Avenue, Wuzhong District, Suzhou, Jiangsu\r\n                  Province</el-descriptions-item\r\n                > -->\r\n              </el-descriptions>\r\n            </template>\r\n            <el-divider></el-divider>\r\n            <h2 class=\"trait-sub-title\">Homologous Gene Detail Information</h2>\r\n            <el-button type=\"primary\" icon=\"el-icon-download\" plain id=\"filterCol1\" @click=\"exportToSubOrthoTableExcel(orthoTableData)\"></el-button>\r\n\r\n          </div>\r\n      </div>\r\n      <!-- <div id=\"wrapper\"> -->\r\n          <div class=\"trait-info\">\r\n            <el-table\r\n              :data=\"orthoTableData\"\r\n              class=\"info-table\"\r\n              v-loading=\"orthoLoading\"\r\n              v-if=\"showOrthoSubTable\"\r\n              :border=\"false\"\r\n              fixed\r\n              :header-cell-style=\"{background:'#F5F7FA'}\"\r\n          >\r\n             <el-table-column\r\n                  prop=\"commonName\"\r\n                  label=\"Species\"\r\n                  >\r\n              </el-table-column>\r\n              <el-table-column\r\n                  prop=\"tax\"\r\n                  label=\"Taxon ID\"\r\n              >\r\n              <template slot-scope=\"scope\">\r\n                <a :href=\"'https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id='+scope.row.tax+'&lvl=3&lin=f&keep=1&srchmode=1&unlock'\">\r\n                    {{ scope.row.tax }}\r\n                </a>\r\n              </template>\r\n              </el-table-column>\r\n              <el-table-column\r\n                  prop=\"ensemblGeneId\"\r\n                  label=\"Ensembl ID\"\r\n                  >\r\n                  <template slot-scope=\"scope\">\r\n                    <!-- <a v-if=\"scope.row.ensemblGeneId!=='-'\" target=\"_blank\" :href=\"'https://ensembl.org/Multi/Search/Results?q='+scope.row.ensemblGeneId+';site=ensembl'\">{{scope.row.ensemblGeneId}}</a> -->\r\n                    <div v-if=\"scope.row.ensemblGeneId!=='-'\">\r\n                      <a target=\"_blank\" v-if=\"tax_Plant.indexOf(String(scope.row.tax))==-1\" :href=\"'https://ensembl.org/Multi/Search/Results?q='+scope.row.ensemblGeneId+';site=ensembl'\">{{scope.row.ensemblGeneId}}</a>\r\n                      <a target=\"_blank\" v-else :href=\"'https://plants.ensembl.org/Multi/Search/Results?q='+scope.row.ensemblGeneId+';site=ensembl'\">{{scope.row.ensemblGeneId}}</a>\r\n                    </div>\r\n                    <div v-else>{{scope.row.ensemblGeneId}}</div>\r\n                </template>\r\n              </el-table-column>\r\n               <el-table-column\r\n                prop=\"geneSymbol\"\r\n                label=\"Gene Symbol\"\r\n                >\r\n              </el-table-column>\r\n              <el-table-column\r\n                prop=\"protein\"\r\n                label=\"Uniprot ID\">\r\n                <template slot-scope=\"scope\">\r\n              \r\n                  <a :href=\"'https://www.uniprot.org/uniprot/'+scope.row.protein\" target='_blank'>\r\n                      {{ scope.row.protein }}\r\n                  </a>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"ensemblId\"\r\n                label=\"Ensembl Protein ID\">\r\n                <template slot-scope=\"scope\">\r\n              \r\n                  <!-- <a :href=\"'https://ensembl.org/Multi/Search/Results?q='+scope.row.ensemblId\" target='_blank'>\r\n                      {{ scope.row.ensemblId }}\r\n                  </a> -->\r\n                  <a target=\"_blank\" v-if=\"tax_Plant.indexOf(String(scope.row.tax))==-1\" :href=\"'https://ensembl.org/Multi/Search/Results?q='+scope.row.ensemblId+';site=ensembl'\">{{scope.row.ensemblId}}</a>\r\n                  <a target=\"_blank\" v-else :href=\"'https://plants.ensembl.org/Multi/Search/Results?q='+scope.row.ensemblId+';site=ensembl'\">{{scope.row.ensemblId}}</a>\r\n\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"Data Source Count \"  width=\"150px\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-rate\r\n                        v-model=\"scope.row.dbEvidence.split(',').length\"\r\n                        disabled\r\n                        text-color=\"#ff9900\"\r\n                        score-template=\"{value}\">\r\n                    </el-rate>\r\n                </template>\r\n              </el-table-column>\r\n              <el-table-column  label=\"Data Source\" align=\"center\">\r\n                  <template slot-scope=\"scope\">\r\n                      <el-popover\r\n                          placement=\"top\"\r\n                          title=\"Data Source\"\r\n                          width=\"200\"\r\n                          trigger=\"click\"\r\n                          :content=\"scope.row.dbEvidence\">\r\n                          <!-- <i class=\"el-icon-s-order\" slot=\"reference\" width=\"30px\"></i> -->\r\n                          <template #reference>\r\n                              <i class=\"el-icon-s-order\" slot=\"reference\"></i>\r\n                          </template>\r\n                          <template #default>\r\n                              <div>{{scope.row.dbEvidence}}</div>\r\n                              <div v-for=\"(item,index) of scope.row.dbContent\" :key=\"index\">\r\n                                  <div v-if=\"item.split(':')[0]=='Panther'\">\r\n                                      Panther:<a target=\"_blank\" :href=\"'http://www.pantherdb.org/panther/family.do?clsAccession='+item.split(':')[1]\" >{{item.split(':')[1]}}</a>\r\n                                  </div>\r\n                                  <div v-if=\"item.split(':')[0]=='TreeFam'\">\r\n                                      TreeFam:<a target=\"_blank\" :href=\"'http://www.treefam.org/family/'+item.split(':')[1]\" >{{item.split(':')[1]}}</a>\r\n                                  </div>\r\n                                  <div v-if=\"item.split(':')[0]=='eggNOG'\">\r\n                                      eggNOG:<a target=\"_blank\" :href=\"'http://eggnog5.embl.de/#/app/results?seqid='+scope.row.protein+'&target_nogs=ENOG50'+item.split(':')[1]\" >{{item.split(':')[1]}}</a>\r\n                                  </div> \r\n                                  <div v-if=\"item.split(':')[0]=='Inparanoid'\">\r\n                                    Inparanoid:<a target=\"_blank\" :href=\"'https://inparanoid.sbc.su.se/cgi-bin/efasta.cgi?cluster='+item.split(':')[1].split(' ')[1]+'&species1='+scope.row.inparanoidID1+'&species2='+scope.row.inparanoidID2+'&java=0'\">{{item.split(':')[1]}}</a>\r\n                                  </div> \r\n                              </div>\r\n                          </template>\r\n                      </el-popover>\r\n                      \r\n                  </template>\r\n              </el-table-column>\r\n             \r\n            </el-table>\r\n          </div>\r\n\r\n      <!-- </div> -->\r\n    <!-- </el-card> -->\r\n\r\n      <!-- gwas 表格 -->\r\n    <!-- <el-card shadow=\"none\"  class=\"sub-table-card\"> -->\r\n       \r\n      <div class=\"sub-trait-box\" v-if=\"showSubTableBox\">\r\n        <div  class=\"title-box\" >\r\n          <h3 class=\"trait-sub-title\">Variants Detail Information</h3>\r\n          <el-button type=\"primary\" icon=\"el-icon-download\" plain id=\"filterCol1\" @click=\"exportToSubGwasTableExcel(gwasInfoData)\"></el-button>\r\n\r\n        </div>\r\n        <div id=\"trait-info\">\r\n            <!-- <el-card shadow=\"none\" class=\"gwasDetailCard\"> -->\r\n              <el-table \r\n                :data=\"gwasInfoData\"\r\n                id=\"subTable\"\r\n                :row-style=\"{height: '0'}\"\r\n                max-height=\"800\"\r\n                v-loading=\"gwasLoading\"\r\n                :header-cell-style=\"{background:'#F5F7FA'}\"\r\n              >\r\n              <el-table-column\r\n                prop=\"finalgenename\"\r\n                label=\"Gene ID\"\r\n              >\r\n                  <!-- <template slot-scope=\"scope\">\r\n                    <a v-bind:href=\"'https://ngdc.cncb.ac.cn/gvm/snp/getGeneDetail?param1='+scope.row.genename+'&orgId'+scope.row.orgId\" target='_blank'>\r\n                      {{ scope.row.genename }}\r\n                    </a>\r\n                  </template> -->\r\n\r\n              </el-table-column>\r\n              <el-table-column\r\n                  prop=\"rsnpId\"\r\n                  label=\"Var ID\"\r\n                  >\r\n                  <template slot-scope=\"scope\">\r\n                  <a v-bind:href=\"'https://ngdc.cncb.ac.cn/gvm/snp/getSNPDetail?snpname='+scope.row.rsnpId+'&chrom='+scope.row.chrom+'&position='+scope.row.snpStart+'&orgId='+scope.row.orgId\" target='_blank'>\r\n                    {{ scope.row.rsnpId }}\r\n                  </a>\r\n                </template>\r\n              </el-table-column>\r\n                <el-table-column\r\n                    prop=\"finalposition\"\r\n                    label=\"Position\"\r\n                    \r\n                    >\r\n                </el-table-column>\r\n                <el-table-column\r\n                    prop=\"finalallele\"\r\n                    label=\"Allele\"\r\n                   \r\n                >\r\n                </el-table-column>\r\n              \r\n                <el-table-column\r\n                    prop=\"finalmaf\"\r\n                    label=\"MAF\"\r\n                >\r\n                </el-table-column>\r\n              \r\n                <el-table-column\r\n                    prop=\"snpClassId\"\r\n                    label=\"Class\"\r\n                    \r\n                >\r\n                </el-table-column>\r\n                <el-table-column\r\n                    prop=\"finalConseqtype\"\r\n                    label=\"Consequence Type/Effect\"\r\n                    width=\"330px\"\r\n                >\r\n                </el-table-column>\r\n                <el-table-column\r\n                    prop=\"finalGenealias\"\r\n                    label=\"Gene Symbol\"\r\n                    \r\n                >\r\n                </el-table-column>\r\n                \r\n              </el-table>\r\n            <!-- </el-card> -->\r\n        </div>\r\n      </div>\r\n    <!-- </el-card> -->\r\n      </div>\r\n      </div>\r\n      <!-- </div> -->\r\n      <!-- </el-card> -->\r\n    </el-tab-pane>\r\n     <!-- 植物tab -->\r\n    <el-tab-pane label=\"Plant\" name=\"plant\">\r\n      <div class=\"filt-div\">\r\n            <el-input v-model=\"form.gene\" placeholder=\"Query gene\" class=\"gene-input\" clearable></el-input>\r\n            <el-select v-model=\"form.querySpecies\" class=\"filt-spe-select\" placeholder=\"Query species\" clearable>\r\n                <el-option\r\n                    v-for=\"(item,index) in querySpeciesList_plant\"\r\n                    :key=\"index\"\r\n                    :label=\"item\"\r\n                    :value=\"item\"\r\n                    >\r\n                </el-option>\r\n            </el-select>\r\n            <el-button icon=\"el-icon-search\" type=\"success\" plain id=\"filter-search\" @click=\"searchFilter()\">Search</el-button>\r\n            <el-button icon=\"el-icon-delete\" type=\"primary\" plain id=\"filter-search2\" @click=\"clearFilter()\">Clear</el-button>\r\n            <el-button type=\"primary\" icon=\"el-icon-download\" plain id=\"filterCol\" @click=\"exportToExcel('plant')\"></el-button>\r\n            <el-popover\r\n              placement=\"bottom-end\"\r\n              width=\"400\"\r\n              trigger=\"manual\"\r\n              class=\"popbox\"\r\n              v-model=\"visible\">\r\n                <div class=\"checkbox-box\">\r\n                  <el-checkbox v-for=\"item of speciesList_plant_1\" :key=\"item.commonName\" :label=\"item.commonName\" class=\"chooseColBox\" ref=\"one\" v-model=\"item.checked\"></el-checkbox>\r\n                <!-- <el-checkbox  class=\"chooseColBox\" @change=\"chooseall\" ref=\"all\">Choose All</el-checkbox> -->\r\n                </div>\r\n                <div class=\"botton-wrapper\">\r\n                  <el-button size=\"mini\" type=\"primary\"  @click=\"confirmbutton\" class=\"choose-col-button\">Close</el-button>\r\n                  <!-- <el-button size=\"mini\" type=\"text\" plain @click=\"visible = false\" class=\"choose-col-button\">cancel</el-button> -->\r\n                </div>\r\n                <el-button slot=\"reference\" icon=\"el-icon-s-grid\" type=\"primary\" plain id=\"filterCol\" @click=\"visible = !visible\" :disabled=\"speciesList_plant_1.length==0\"></el-button>\r\n              </el-popover>\r\n\r\n      </div>\r\n      <!-- <div class=\"wraper\"> -->\r\n        \r\n      <div class=\"trait-info\">\r\n   <!-- 使用中的表格 -->\r\n        <el-table\r\n            :data=\"traitData_plant\"\r\n            class=\"trait-table\"\r\n            row-key=\"id\"\r\n            v-loading=\"loading_plant\"\r\n            ref=\"table_main_plant\"\r\n            :header-cell-style=\"hiligtDbCols\"\r\n            border\r\n          >\r\n            <el-table-column align=\"center\" class=\"titleCell\" prop=\"varName\" label=\"Consequence Type\" fixed width=\"280px\" style=\"background-color:white\"></el-table-column>\r\n            <el-table-column align=\"center\" prop=\"geneId\" label=\"Gene ID\" width=\"220px\" fixed>\r\n               <template slot-scope=\"scope\">\r\n                <a :href=\"'./gene-detail?hdbId='+scope.row.hdbid+'&taxonId='+scope.row.taxonId\">\r\n                    {{ scope.row.geneId }}\r\n                </a>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column align=\"center\" prop=\"speciesCommonName\" label=\"Species Name\" width=\"150px\" fixed></el-table-column>\r\n            <el-table-column align=\"center\" prop=\"taxonId\" label=\"Taxon ID\" width=\"160px\" fixed>\r\n              <template slot-scope=\"scope\">\r\n                <a :href=\"'https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id='+scope.row.taxonId+'&lvl=3&lin=f&keep=1&srchmode=1&unlock'\">\r\n                    {{ scope.row.taxonId }}\r\n                </a>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column align=\"center\" prop=\"speciesCommonName\" label=\"Homologous Species Name\">\r\n            <template v-for=\"(item,index) in speciesList_plant_1\">\r\n              <el-table-column align=\"center\" :label=\"item.commonName\" :prop=\"item.commonName\" v-if=\"item.checked\" :key=\"item.commonName\">\r\n            <!-- <el-table-column :label=\"item\" :show-overflow-tooltip=\"true\" :prop=\"item\" v-for=\"(item,index) in speciesList_plant\" :key=\"index\"\r\n              class=\"imglink\" height=\"100px\"> -->\r\n                  <template slot-scope=\"scope\" >\r\n                  <img\r\n                      :src=\"orthoIcon\"\r\n                      min-width=\"70\"\r\n                      height=\"70\"\r\n                      class=\"iconImg\"\r\n                      v-if='scope.row.speciesListData.indexOf(index)>-1'\r\n                      style=\"cursor:pointer\"\r\n                      @click=showOrthoInfoTable(scope.row,index)\r\n                    />\r\n                    <img\r\n                      :src=\"singleTraitIcon\"\r\n                      min-width=\"70\"\r\n                      height=\"70\"\r\n                      class=\"iconImg\"\r\n                      v-if='scope.row.traitListData2.indexOf(index)>-1'\r\n                      style=\"cursor:pointer !important\"\r\n                      @click=showGwasInfoTable(scope.row,index)\r\n                    />\r\n                    <!--这个v-if，先判断在当前的cell内有数值，然后再判断值 -->\r\n                    <img\r\n                      :src=\"sameTraitIcon\"\r\n                      min-width=\"70\"\r\n                      height=\"70\"\r\n                      class=\"iconImg\"\r\n                      v-if='scope.row.traitListData1.indexOf(index)>-1'\r\n                      style=\"cursor:pointer\"\r\n                      @click=showGwasInfoTable(scope.row,index)\r\n                    />\r\n                  </template>\r\n              </el-table-column>\r\n            </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        <div style=\"position: absolute;float: left;\">\r\n        <div style=\"display: flex;\">\r\n                    <img :src=\"orthoIcon\"\r\n                      style=\"margin-right: 6px;min-width=70px;height=70px;\"\r\n                      class=\"iconImg\" />\r\n                      <div class=\"note-info\">exists homologous gene</div>\r\n          </div>\r\n          <div style=\"display: flex;\">\r\n                    <img :src=\"singleTraitIcon\"   \r\n                      style=\"margin-right: 6px;min-width=70px;height=70px;\"\r\n                      class=\"iconImg\" /><div class=\"note-info\">exists homologous gene with variant annotation</div>  \r\n          </div>\r\n          <div style=\"display: flex;\">\r\n                    <img :src=\"sameTraitIcon\"   \r\n                      style=\"margin-right: 6px;min-width=70px;height=70px;\"\r\n                      class=\"iconImg\" /><div class=\"note-info\">exists homologous gene with same variant annotation</div>  \r\n          </div>\r\n        </div>\r\n        <el-pagination\r\n          class=\"trait-pag\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          :current-page=\"currentPage4_p\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :page-size=\"pageSize\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"totalSize_plant\"\r\n        >\r\n        </el-pagination>\r\n        <div class=\"sub-trait-box \" v-if=\"showOrthoSubTable\">\r\n        <el-divider class=\"divider\"></el-divider>\r\n          <div class=\"title-box\">\r\n            <template>\r\n              <el-descriptions title=\"Selected Gene\" >\r\n                <el-descriptions-item label=\"Gene ID\"><a :href=\"'./gene-detail?hdbId='+selectGene.hdbid+'&taxonId='+selectGene.taxonId\">\r\n                    {{ selectGene.geneId }}\r\n                </a></el-descriptions-item>\r\n                <el-descriptions-item label=\"Uniprot ID\"><a :href=\"'https://www.uniprot.org/uniprot/'+selectGene.uniprotId\" target='_blank'>\r\n                    {{ selectGene.uniprotId }}\r\n                </a></el-descriptions-item>\r\n                <el-descriptions-item label=\"Ensembl Protein ID\">\r\n                  <!-- <a :href=\"'https://ensembl.org/Multi/Search/Results?q='+selectGene.ensemblId+';site=ensembl'\" target='_blank'>\r\n                    {{ selectGene.ensemblId }}\r\n                </a> -->\r\n                <a target=\"_blank\" v-if=\"tax_Plant.indexOf(String(selectGene.taxonId))==-1\" :href=\"'https://ensembl.org/Multi/Search/Results?q='+selectGene.ensemblId+';site=ensembl'\">{{selectGene.ensemblId}}</a>\r\n                <a target=\"_blank\" v-else :href=\"'https://plants.ensembl.org/Multi/Search/Results?q='+selectGene.ensemblId+';site=ensembl'\">{{selectGene.ensemblId}}</a>\r\n\r\n              </el-descriptions-item>\r\n                <el-descriptions-item label=\"Species Name\">{{selectGene.speciesCommonName}}</el-descriptions-item>\r\n                <el-descriptions-item label=\"Classification\">{{selectGene.classification}}</el-descriptions-item>\r\n                <el-descriptions-item label=\"Consequence type\">\r\n                  <el-tag size=\"small\">{{selectGene.varName}}</el-tag>\r\n                </el-descriptions-item>\r\n                <!-- <el-descriptions-item label=\"Address\"\r\n                  >No.1188, Wuzhong Avenue, Wuzhong District, Suzhou, Jiangsu\r\n                  Province</el-descriptions-item\r\n                > -->\r\n              </el-descriptions>\r\n            </template>\r\n          <el-divider></el-divider>\r\n            <h2 class=\"trait-sub-title\">Homologous Gene Detail Information</h2>\r\n            <el-button type=\"primary\" icon=\"el-icon-download\" plain id=\"filterCol1\" @click=\"exportToSubOrthoTableExcel(orthoTableData)\"></el-button>\r\n\r\n          </div>\r\n      </div>\r\n    <!-- 同源表格 -->\r\n          <el-table\r\n            :data=\"orthoTableData\"\r\n            class=\"info-table\"\r\n            v-loading=\"orthoLoading\"\r\n            v-if=\"showOrthoSubTable\"\r\n            :border=\"false\"\r\n            :header-cell-style=\"{background:'#F5F7FA'}\"\r\n        >\r\n            <el-table-column\r\n                prop=\"commonName\"\r\n                label=\"Species\"\r\n                >\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"tax\"\r\n                label=\"Taxon ID\"\r\n            >\r\n            <template slot-scope=\"scope\">\r\n                <a :href=\"'https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id='+scope.row.tax+'&lvl=3&lin=f&keep=1&srchmode=1&unlock'\">\r\n                    {{ scope.row.tax }}\r\n                </a>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"ensemblGeneId\"\r\n                label=\"Ensembl ID\"\r\n                >\r\n                <template slot-scope=\"scope\">\r\n                    <!-- <a v-if=\"scope.row.ensemblGeneId!=='-'\" target=\"_blank\" :href=\"'https://ensembl.org/Multi/Search/Results?q='+scope.row.ensemblGeneId+';site=ensembl'\">{{scope.row.ensemblGeneId}}</a>\r\n                    <div v-else>{{scope.row.ensemblGeneId}}</div> -->\r\n                    <div v-if=\"scope.row.ensemblGeneId!=='-'\">\r\n                      <a target=\"_blank\" v-if=\"tax_Plant.indexOf(String(scope.row.tax))==-1\" :href=\"'https://ensembl.org/Multi/Search/Results?q='+scope.row.ensemblGeneId+';site=ensembl'\">{{scope.row.ensemblGeneId}}</a>\r\n                      <a target=\"_blank\" v-else :href=\"'https://plants.ensembl.org/Multi/Search/Results?q='+scope.row.ensemblGeneId+';site=ensembl'\">{{scope.row.ensemblGeneId}}</a>\r\n                    </div>\r\n                    <div v-else>{{scope.row.ensemblGeneId}}</div>\r\n                </template>\r\n            </el-table-column>\r\n              <el-table-column\r\n              prop=\"geneSymbol\"\r\n              label=\"Gene Symbol\"\r\n            >\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"protein\"\r\n                label=\"Uniprot ID\">\r\n                <template slot-scope=\"scope\">\r\n              \r\n                  <a :href=\"'https://www.uniprot.org/uniprot/'+scope.row.protein\" target='_blank'>\r\n                      {{ scope.row.protein }}\r\n                  </a>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"ensemblId\"\r\n                label=\"Ensembl Protein ID\">\r\n                <template slot-scope=\"scope\">\r\n              \r\n                  <!-- <a :href=\"'https://ensembl.org/Multi/Search/Results?q='+scope.row.ensemblId+';site=ensembl'\" target='_blank'>\r\n                      {{ scope.row.ensemblId }}\r\n                  </a> -->\r\n                  <a target=\"_blank\" v-if=\"tax_Plant.indexOf(String(scope.row.tax))==-1\" :href=\"'https://ensembl.org/Multi/Search/Results?q='+scope.row.ensemblId+';site=ensembl'\">{{scope.row.ensemblId}}</a>\r\n                  <a target=\"_blank\" v-else :href=\"'https://plants.ensembl.org/Multi/Search/Results?q='+scope.row.ensemblId+';site=ensembl'\">{{scope.row.ensemblId}}</a>\r\n\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"Data Source Count \"  width=\"150px\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-rate\r\n                        v-model=\"scope.row.dbEvidence.split(',').length\"\r\n                        disabled\r\n                        text-color=\"#ff9900\"\r\n                        score-template=\"{value}\">\r\n                    </el-rate>\r\n                </template>\r\n              </el-table-column>\r\n            <el-table-column  label=\"Data Source\" align=\"center\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-popover\r\n                        placement=\"top\"\r\n                        title=\"Data Source\"\r\n                        width=\"200\"\r\n                        trigger=\"click\"\r\n                        :content=\"scope.row.dbEvidence\">\r\n                        <!-- <i class=\"el-icon-s-order\" slot=\"reference\" width=\"30px\"></i> -->\r\n                        <template #reference>\r\n                            <i class=\"el-icon-s-order\" slot=\"reference\"></i>\r\n                        </template>\r\n                        <template #default>\r\n                            <div>{{scope.row.dbEvidence}}</div>\r\n                            <div v-for=\"(item,index) of scope.row.dbContent\" :key=\"index\">\r\n                                <div v-if=\"item.split(':')[0]=='Panther'\">\r\n                                    Panther:<a target=\"_blank\" :href=\"'http://www.pantherdb.org/panther/family.do?clsAccession='+item.split(':')[1]\" >{{item.split(':')[1]}}</a>\r\n                                </div>\r\n                                <div v-if=\"item.split(':')[0]=='TreeFam'\">\r\n                                    TreeFam:<a target=\"_blank\" :href=\"'http://www.treefam.org/family/'+item.split(':')[1]\" >{{item.split(':')[1]}}</a>\r\n                                </div>\r\n                                <div v-if=\"item.split(':')[0]=='eggNOG'\">\r\n                                    eggNOG:<a target=\"_blank\" :href=\"'http://eggnog5.embl.de/#/app/results?seqid='+scope.row.protein+'&target_nogs=ENOG50'+item.split(':')[1]\" >{{item.split(':')[1]}}</a>\r\n                                </div> \r\n                                <div v-if=\"item.split(':')[0]=='Inparanoid'\">\r\n                                  Inparanoid:<a target=\"_blank\" :href=\"'https://inparanoid.sbc.su.se/cgi-bin/efasta.cgi?cluster='+item.split(':')[1].split(' ')[1]+'&species1='+scope.row.inparanoidID1+'&species2='+scope.row.inparanoidID2+'&java=0'\">{{item.split(':')[1]}}</a>\r\n                                </div> \r\n                            </div>\r\n                        </template>\r\n                    </el-popover>\r\n                    \r\n                </template>\r\n            </el-table-column>\r\n        </el-table>\r\n    <!-- gwas detail info表格 -->\r\n      <div class=\"sub-trait-box\" v-if=\"showSubTableBox\">\r\n        <div  class=\"title-box\" style=\"padding-left:1.5%;margin-bottom:1.3%\">\r\n          <h3 class=\"trait-sub-title\">Variants Detail Information</h3>\r\n          <el-button type=\"primary\" icon=\"el-icon-download\" plain id=\"filterCol1\" @click=\"exportToSubGwasTableExcel(gwasInfoData)\"></el-button>\r\n        </div>\r\n        <div id=\"trait-info\">\r\n            <!-- <el-card shadow=\"none\" class=\"gwasDetailCard\"> -->\r\n              <!-- <el-table \r\n                :data=\"gwasInfoData\"\r\n                style=\"width: 100%;margin-top:3%;\"\r\n                id=\"subTable\"\r\n                :row-style=\"{height: '0'}\"\r\n                max-height=\"400\"\r\n                v-loading=\"gwasLoading\"\r\n              >\r\n                <el-table-column prop=\"geneName\" label=\"Gene ID\"></el-table-column>\r\n                <el-table-column prop=\"varId\" label=\"Var ID\"></el-table-column>\r\n                <el-table-column prop=\"varName\" label=\"Consequence Type\"></el-table-column>\r\n                <el-table-column prop=\"speciesCommonName\" label=\"Species\"></el-table-column>\r\n                <el-table-column prop=\"pmid\" label=\"Pubmed ID\"></el-table-column>\r\n                <el-table-column prop=\"pvalue\" label=\"Pvalue\"></el-table-column>\r\n              </el-table> -->\r\n               <el-table \r\n                :data=\"gwasInfoData\"\r\n                id=\"subTable\"\r\n                :row-style=\"{height: '0'}\"\r\n                max-height=\"800\"\r\n                v-loading=\"gwasLoading\"\r\n                :header-cell-style=\"{background:'#F5F7FA'}\"\r\n              >\r\n              <el-table-column\r\n                prop=\"finalgenename\"\r\n                label=\"Gene ID\"\r\n                width=\"120\"\r\n              >\r\n                  <!-- <template slot-scope=\"scope\">\r\n                    <a v-bind:href=\"'https://ngdc.cncb.ac.cn/gvm/snp/getGeneDetail?param1='+scope.row.genename+'&orgId'+scope.row.orgId\" target='_blank'>\r\n                      {{ scope.row.genename }}\r\n                    </a>\r\n                  </template> -->\r\n\r\n              </el-table-column>\r\n              <el-table-column\r\n                  prop=\"rsnpId\"\r\n                  label=\"Var ID\"\r\n                  >\r\n                  <template slot-scope=\"scope\">\r\n                  <a v-bind:href=\"'https://ngdc.cncb.ac.cn/gvm/snp/getSNPDetail?snpname='+scope.row.rsnpId+'&chrom='+scope.row.chrom+'&position='+scope.row.snpStart+'&orgId='+scope.row.orgId\" target='_blank'>\r\n                    {{ scope.row.rsnpId }}\r\n                  </a>\r\n                </template>\r\n              </el-table-column>\r\n                <el-table-column\r\n                    prop=\"finalposition\"\r\n                    label=\"Position\"\r\n                   \r\n                    >\r\n                </el-table-column>\r\n                <el-table-column\r\n                    prop=\"finalallele\"\r\n                    label=\"Allele\"\r\n                   \r\n                >\r\n                </el-table-column>\r\n              \r\n                <el-table-column\r\n                    prop=\"finalmaf\"\r\n                    label=\"MAF\"\r\n                >\r\n                </el-table-column>\r\n              \r\n                <el-table-column\r\n                    prop=\"snpClassId\"\r\n                    label=\"Class\"\r\n                   \r\n                >\r\n                </el-table-column>\r\n                <el-table-column\r\n                    prop=\"finalConseqtype\"\r\n                    label=\"Consequence Type/Effect\"\r\n                    width=\"330px\"\r\n                >\r\n                </el-table-column>\r\n                <el-table-column\r\n                    prop=\"finalGenealias\"\r\n                    label=\"Gene Symbol\"\r\n                    width=\"120px\"\r\n                >\r\n                </el-table-column>\r\n                \r\n              </el-table>\r\n            <!-- </el-card> -->\r\n        </div>\r\n      </div>\r\n      </div>\r\n    <!-- </div> -->\r\n     \r\n     \r\n      <!-- </el-card> -->\r\n    </el-tab-pane>\r\n    \r\n    \r\n    </el-tabs>\r\n    </el-card>\r\n    </el-container>\r\n    <FooterBar />\r\n    <template>\r\n     <el-backtop\r\n      :bottom=\"100\"\r\n      style=\"z-index: 999;\"\r\n      class=\"backTop\"\r\n    >\r\n      <div\r\n        style=\"\r\n           {\r\n            height: 100%;\r\n            width: 100%;\r\n            box-shadow: 0 0 6px rgba(0, 0, 0, 0.12);\r\n            text-align: center;\r\n            line-height: 40px;\r\n            color: #1989fa;\r\n            border-radius: 50%;\r\n            background-color: white;\r\n          }\r\n        \"\r\n      >\r\n      <i class=\"el-icon-caret-top\"></i>\r\n      </div>\r\n    </el-backtop>\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<style src=\"../assets/css/traits.css\" scoped></style>\r\n\r\n<script>\r\n// @ is an alias to /src\r\n// import Navigator from \"@/components/navigator.vue\";\r\nimport varOntology from \"@/assets/static/varOntology.json\";\r\nimport Banner from \"@/components/banner.vue\";\r\nimport FooterBar from \"@/components/FooterBar.vue\";\r\nimport HeaderBar from \"@/components/HeaderBar.vue\";\r\n// import qs from \"qs\";\r\n// // icons\r\nimport sameTraitIcon from \"@/assets/img/icon/star.svg\";\r\nimport orthoIcon from \"@/assets/img/icon/huafu.svg\";\r\nimport singleTraitIcon from \"@/assets/img/icon/orange.svg\";\r\n// import \"@/assets/css/traits.css\";\r\nexport default {\r\n  name: \"Traits\",\r\n  components: {\r\n    // Navigator,\r\n    FooterBar,\r\n    HeaderBar,\r\n    Banner,\r\n    \r\n  },\r\n  watch: {\r\n    filterText(val) {\r\n      this.$refs.tree.filter(val);\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      sameTraitIcon,\r\n      orthoIcon,\r\n      singleTraitIcon,\r\n      visible:false,\r\n      visible_1:false,\r\n      filterText: \"\",\r\n      treedata: varOntology.tree,\r\n      showSubTableBox:false,\r\n      gwasLoading:true,\r\n      orthoLoading:true,\r\n      activeName: 'animal',\r\n      drawer:false,\r\n      direction:\"ltr\",\r\n       // 保存同源物种，用于表格生成列\r\n      speciesList_animal:[],\r\n      speciesList_plant:[],\r\n       // 保存同源物种obj，用于动态选择列\r\n      speciesList_animal_1:[],\r\n      speciesList_plant_1:[],\r\n      traitData_animal: [],\r\n      traitData_plant:[],\r\n      orthoTableData: [],\r\n      value: \"\",\r\n      varItem:{\r\n        varName:\"frameshift_variant\"\r\n      },\r\n      currentPage4_a: 1,\r\n      currentPage4_p: 1,\r\n      totalSize_animal:0,\r\n      totalSize_plant:0,\r\n      form: {\r\n        querySpecies:\"\",\r\n        gene:\"\"\r\n      },\r\n      pageSize: 10,\r\n      gwasInfoData:[],\r\n      // loading:true,\r\n      loading_animal:false,\r\n      loading_plant:false,\r\n      showOrthoSubTable:false,\r\n      classification:\"animal\",\r\n      navBarFixed:\"false\",\r\n      showTraitSameIcon:false,\r\n       // 从接口获取所有有trait数据的物种，用于物种选择，提交search\r\n      querySpeciesList_animal:[],\r\n      querySpeciesList_plant:[],\r\n      querySpeciesList:[],\r\n      selectGene:{},\r\n      showTitle:true,\r\n      tax_Plant:[\"3702\",\"3708\",\"4072\",\"3659\",\"3635\",\"3983\",\"4530\",\"3847\",\"42345\",\"3694\",\"4081\",\"4558\",\"4565\",\"29760\",\"4577\",\"4113\"]\r\n\r\n    };\r\n  },\r\n\r\n  methods: {\r\n   \r\n    changeClass(tab){\r\n        this.speciesList=[];\r\n        this.showOrthoSubTable=false;\r\n        this.showSubTableBox=false;\r\n        this.classification=tab.name;\r\n        // this.$refs['table'].doLayout();\r\n        this.form.querySpecies=\"\";\r\n        this.form.gene=\"\";\r\n    },\r\n\r\n    confirmbutton(){\r\n    this.visible_1 = false;\r\n    this.visible = false;\r\n    // this.$refs.table.doLayout();\r\n   },\r\n    handleSizeChange(val){\r\n      // this.loading = true;\r\n      if(this.classification==\"animal\"){this.loading_animal=true;}else{this.loading_plant=true}\r\n      this.pageSize = val;\r\n      this.pageNo=1;\r\n      this.getTraitData(this.varItem.varName,this.classification)\r\n    },\r\n    handleCurrentChange(val) {\r\n      if(this.classification==\"animal\"){\r\n        this.loading_animal=true;\r\n        this.currentPage4_a = val;\r\n        // traitId,classification,pagesize,pagenum,speciesName\r\n        this.getTraitData(this.varItem.varName,this.classification)\r\n      }else{\r\n        this.loading_plant=true;\r\n        this.currentPage4_p = val;\r\n        this.getTraitData(this.varItem.varName,this.classification)\r\n      }\r\n      \r\n\r\n    },\r\n    handleSelectionChange(val) {\r\n      this.multipleSelection = val;\r\n    },\r\n    filterNode(value, data) {\r\n      if (!value) return true;\r\n      return data.label.indexOf(value) !== -1;\r\n    },\r\n    getInfoByTrait(value, data) {\r\n      this.showTitle=true;\r\n      this.showSubTableBox=false;\r\n      this.showOrthoSubTable=false;\r\n      this.varItem.varName=value.label;\r\n      this.pageNo=1;\r\n      this.form= {\r\n        querySpecies:\"\",\r\n        gene:\"\"\r\n      }\r\n      if(this.classification==\"animal\"){\r\n        this.currentPage4_a=1;\r\n        this.loading_animal=true;\r\n      }else{\r\n        this.loading_plant=true;\r\n        this.currentPage4_p=1;\r\n      }\r\n      this.getTraitData(value.label)\r\n      \r\n      data.checked = true;\r\n      \r\n    },\r\n    messagError(type){\r\n      if(type=='plant'){\r\n        if(this.totalSize_plant==0){\r\n            this.$message.error('No data found');\r\n          }\r\n      }else{\r\n          if(this.totalSize_animal==0){\r\n            this.$message.error('No data found');\r\n        }\r\n      }\r\n    },\r\n    showSelectedGene(rowData){\r\n      this.selectGene=rowData;\r\n      this.selectGene.uniprotId=rowData.hdbid.split(\"_\")[0];\r\n      this.selectGene.ensemblId=rowData.hdbid.split(\"_\")[1];\r\n  },\r\n  showOrthoInfoTable(rowData,index){\r\n    console.log(\"rowData:\",rowData);\r\n    this.showSelectedGene(rowData,index)\r\n    let ortholist=[];\r\n    // 通过hdbid筛选保留unique的同源值,需要筛选吗？\r\n    let orthohdblist=[];\r\n    rowData.speciesListData.forEach((id,idx)=>{\r\n      if(id==index){\r\n        let item=rowData.orthoList[idx];\r\n        if(orthohdblist.indexOf(item.hdbId)==-1){\r\n          ortholist.push(item);\r\n          orthohdblist.push(item.hdbId);\r\n        }\r\n        // ortholist.push(rowData.orthoList[idx])\r\n    }})\r\n    this.showOrthoSubTable = true;\r\n    this.showSubTableBox=false;\r\n    this.orthoLoading=true;\r\n\r\n    this.orthoTableData=[]\r\n    ortholist.forEach(item=>{\r\n      let hdbid=item.hdbId;\r\n      this.$axios.get(\"https://ngdc.cncb.ac.cn/hapi/api/gene-detail-ortho\",{params:{\"hdbId\":hdbid}}).then((res)=>{\r\n        if(res.data!==\"\"){\r\n          item.ensemblGeneId=res.data.ensemblGeneId.length>0?res.data.ensemblGeneId:\"-\";\r\n          item.geneSymbol=res.data.geneSymbol.length>0?res.data.geneSymbol:\"-\";\r\n        }else{\r\n          item.ensemblGeneId=\"-\";\r\n          item.geneSymbol=\"-\";\r\n        }\r\n        let dbContent=item.fromdb.split(',');\r\n        item.dbContent=dbContent;\r\n        this.orthoTableData.push(item);\r\n        this.orthoLoading=false;\r\n      })\r\n    })\r\n    // this.orthoTableData=ortholist;\r\n    // console.log(\"orthoTableData:\",this.orthoTableData);\r\n\r\n  },\r\n \r\n  // 表格高度自适应\r\n  getTableMaxHeight(){\r\n      this.$nextTick(function () {\r\n      let box = document.querySelector(\".trait-info\").attributes\r\n      let box_clientHeight = box[0].ownerElement.clientHeight;\r\n      this.tableHeight = box_clientHeight - 100;\r\n    })\r\n  },\r\n  buttonFunction(){\r\n    this.drawer = true;\r\n   },\r\n  showGwasInfoTable(rowValue,index){\r\n    this.showSelectedGene(rowValue,index)\r\n    let ortholist=[];\r\n    // 通过hdbid筛选保留unique的同源值\r\n    let orthohdblist=[];\r\n    rowValue.speciesListData.forEach((id,idx)=>{\r\n    if(id==index){\r\n        let item=rowValue.orthoList[idx];\r\n        if(orthohdblist.indexOf(item.hdbId)==-1){\r\n          ortholist.push(item);\r\n          orthohdblist.push(item.hdbId);\r\n        }\r\n    }})\r\n    this.orthoTableData=[];\r\n    ortholist.forEach(item=>{\r\n      let hdbid=item.hdbId;\r\n      this.$axios.get(\"https://ngdc.cncb.ac.cn/hapi/api/gene-detail-ortho\",{params:{\"hdbId\":hdbid}}).then((res)=>{\r\n        item.ensemblGeneId=res.data.ensemblGeneId.length>0?res.data.ensemblGeneId:\"-\";\r\n        item.geneSymbol=res.data.geneSymbol.length>0?res.data.geneSymbol:\"-\";\r\n        if(this.orthoTableData.indexOf(item)==-1){\r\n          this.orthoTableData.push(item)\r\n        }\r\n        this.orthoLoading=false;\r\n      })\r\n    })\r\n    \r\n    this.showOrthoSubTable = true;\r\n    this.orthoLoading=false;\r\n    this.showSubTableBox=true;\r\n\r\n    // 左侧基因的接口数据\r\n    let snpId1 = rowValue.snpId;\r\n    let dataSource1=rowValue.dataSource\r\n    let BASEPATH=\"\";\r\n    this.gwasInfoData=[];\r\n    if(dataSource1!= null && dataSource1.length!==0){\r\n      if(dataSource1.indexOf(\"v2\")>0){BASEPATH=\"https://ngdc.cncb.ac.cn/gvmRESTV2/v2/variants/getlist?dataSource=\"}\r\n      else{BASEPATH=\"https://ngdc.cncb.ac.cn/gvmRESTV3/v2/variants/getlist?dataSource=\"}\r\n      // let snpAll=i.snpList.join(',')\r\n      let PATH=\"\";\r\n\t\tif(BASEPATH.length>0)\r\n\t\t\tPATH=BASEPATH+dataSource1+\"&snplist=\"+snpId1;\r\n\t\t\r\n      if(snpId1.length>0 && PATH.length>0){\r\n          this.getVarData(PATH)\r\n      }\r\n    }\r\n    // 右侧基因接口数据\r\n    ortholist.forEach((item)=>{\r\n    let dataSource2=item.dataSource;\r\n    let hdbid=item.hdbId;\r\n    let varName=item.varName;\r\n    let gwasOrgId=item.gwasOrgId;\r\n    let PATH=\"\";\r\n    if(dataSource2!= null && dataSource2.length>0){\r\n      this.$axios.get(\"https://ngdc.cncb.ac.cn/hapi/api/var-snpid\",{params:{'hdbId': hdbid,\"varName\":varName}}).then(res=>{\r\n          if(res !=null && res.data != null && res.data.length !==0){\r\n            let BASEPATH=\"\";\r\n            let snpId2=res.data;\r\n            this.gwasLoading=true;\r\n            if(dataSource2.indexOf(\"v2\")>0){BASEPATH=\"https://ngdc.cncb.ac.cn/gvmRESTV2/v2/variants/getlist?dataSource=\"\r\n            }else{BASEPATH=\"https://ngdc.cncb.ac.cn/gvmRESTV3/v2/variants/getlist?dataSource=\"}\r\n\t\t\tif(BASEPATH.length>0)\r\n            PATH=BASEPATH+dataSource2+\"&snplist=\"+snpId2;\r\n          }\r\n        }).finally(\r\n          ()=>{\r\n\t\t\tif(PATH.length>0){\r\n\t\t\t\t\r\n\t\t\t\tthis.getVarData(PATH,gwasOrgId)\r\n\t\t\t}\r\n\r\n          }\r\n        )\r\n    }\r\n   })\r\n \r\n    \r\n    \r\n   },\r\n   getVarData(PATH,gwasOrgId){\r\n    this.$axios.get(PATH).then(response=>{\r\n      this.gwasLoading=false;\r\n      this.gwasInfoData=[];\r\n      //this.gwasInfoData=response.data.snp;\r\n      this.varLoading=false;\r\n      let datas=response.data.snp\r\n      if(datas.length>0){\r\n        // 返回是对象\r\n        for(let item of datas){\r\n           item.orgId=gwasOrgId\r\n        }\r\n        this.gwasInfoData=this.gwasInfoData.concat(datas);\r\n      }else{\r\n        // 返回是对象\r\n        datas.orgId=gwasOrgId\r\n        this.gwasInfoData.push(datas);\r\n      }\r\n      // 对返回数据进行格式处理\r\n      for(let item of this.gwasInfoData){\r\n          let pos=item.chrom+\":\"+item.position;\r\n          let allele=item.refallele+\"/\"+item.allele;\r\n          let maf=item.maf+\":\"+item.maffreq.slice(0,7);\r\n          let classsnp=\"SNP\";\r\n\t\t\t\t\titem.finalposition=pos;\r\n\t\t\t\t\titem.finalallele=allele;\r\n\t\t\t\t\titem.finalmaf=maf;\r\n          item.snpClassId=classsnp;\r\n          if(item.gene.length>1){\r\n            let name=[];\r\n            let conseqtype=[];\r\n            let allials=[];\r\n            item.gene.forEach(item=>{\r\n              name.push(item.genename);\r\n              if(conseqtype.indexOf(item.conseqtype)==-1){\r\n                conseqtype.push(item.conseqtype);\r\n              }\r\n              if(allials.indexOf(item.genealias)==-1){\r\n                allials.push(item.genealias);\r\n              }\r\n              \r\n            })\r\n            item.finalgenename=name.join(',');\r\n            item.finalConseqtype=conseqtype.join(',');\r\n            item.finalGenealias=allials.join(',');\r\n            item.finalGenealias=item.finalGenealias.length>0?item.finalGenealias:\"-\";\r\n        }else{\r\n          item.finalgenename=item.gene.genename;\r\n          item.finalConseqtype=item.gene.conseqtype;\r\n          item.finalGenealias=item.gene.genealias;\r\n        }\r\n      }\r\n      })\r\n   },\r\n    hiligtDbCols({rowIndex}){\r\n      if(rowIndex===1){\r\n          return \"writing-mode: vertical-lr; !important;text-align:right\"\r\n      }\r\n      \r\n    },\r\n    iconClass(data,index){\r\n        data.speciesListData.forEach((id,idx)=>{\r\n          if(id==index){\r\n            if( data.orthoList[idx].varName!=null ){\r\n              let traitlist=data.orthoList[idx].varName.split(\",\")\r\n              if(traitlist.indexOf(data.varName)>-1){\r\n                return 1;\r\n              }else{\r\n                return 2;\r\n            }\r\n          }else{\r\n            return false\r\n          }\r\n          }else{\r\n            return false\r\n          }\r\n        })\r\n      // }\r\n    },\r\n   \r\n    searchFilter(){\r\n      // 仅在输入了查询物种和基因的时候发送请求\r\n      if(this.form.querySpecies==\"\" && this.form.gene==\"\"){\r\n        this.$message.error('Please enter query criteria');\r\n      }else{\r\n        if(this.classification==\"animal\"){\r\n          this.loading_animal=true;\r\n        }else{\r\n          this.loading_plant=true;\r\n        }\r\n        \r\n        this.pageNo=1;\r\n        this.getTraitData(this.varItem.varName,this.classification)\r\n        setTimeout(() => {\r\n          this.messagError(this.classification)\r\n        }, 1000);\r\n      }\r\n    }, \r\n    clearFilter(){\r\n      if(this.form.querySpecies!==\"\" || this.form.gene!==\"\"){\r\n        \r\n        this.form.querySpecies=\"\";\r\n        this.form.gene=\"\";\r\n        if(this.classification==\"animal\"){\r\n          this.loading_animal=true;\r\n        }else{\r\n          this.loading_plant=true;\r\n        }\r\n        this.getTraitData(this.varItem.varName,this.classification)\r\n        // this.getTraitData(this.varItem.varName,\"plant\")\r\n      }\r\n    },\r\n    async showTableIcon(data,classss){\r\n      \r\n      if(classss == \"plant\"){\r\n        this.speciesList_plant=[];\r\n        this.speciesList_plant_1=[];\r\n        if(data.length>0){\r\n          for(let varData of data){\r\n            // 增加一个属性保存物种的index，用来显示表格里的icon\r\n            varData.speciesListData=[];\r\n            // 增加一个属性，保存显示有trait数据的情况\r\n            varData.traitListData1=[];\r\n            varData.traitListData2=[];\r\n            if(varData.orthoList){\r\n              for(let item of varData.orthoList){\r\n                let speciesName=item.species.commonName\r\n                if(this.speciesList_plant.indexOf(speciesName)==-1){\r\n                  this.speciesList_plant.push(speciesName);\r\n                  item.species.checked=true;\r\n                  this.speciesList_plant_1.push(item.species);\r\n                }\r\n                varData.speciesListData.push(this.speciesList_plant.indexOf(speciesName));\r\n                if(item.varName !== null){\r\n                  varData.traitListData2.push(this.speciesList_plant.indexOf(speciesName))\r\n                  let varlist=item.varName.split(',')\r\n                  if(varlist.indexOf( varData.varName)>-1){\r\n                      varData.traitListData1.push(this.speciesList_plant.indexOf(speciesName))\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n          // this.$refs['table'].doLayout();\r\n        }\r\n    }else{\r\n      this.speciesList_animal=[];\r\n      \r\n      this.speciesList_animal_1=[];\r\n        if(data.length>0){\r\n          for(let varData of data){\r\n            // 增加一个属性保存物种的index，用来显示表格里的icon\r\n            varData.speciesListData=[];\r\n            varData.traitListData1=[];\r\n            varData.traitListData2=[];\r\n            if(varData.orthoList){\r\n              for(let item of varData.orthoList){\r\n                let speciesName=item.species.commonName;\r\n                if(this.speciesList_animal.indexOf(speciesName)==-1){\r\n                  this.speciesList_animal.push(speciesName);\r\n                  item.species.checked=true;\r\n                  this.speciesList_animal_1.push(item.species);\r\n                }\r\n                varData.speciesListData.push(this.speciesList_animal.indexOf(speciesName));\r\n                if(item.varName !== null){\r\n                  // 有trait但不相同\r\n                   varData.traitListData2.push(this.speciesList_animal.indexOf(speciesName))\r\n                  let varlist=item.varName.split(',')\r\n                  if(varlist.indexOf( varData.varName)>-1){\r\n                    // 有相同trait\r\n                      varData.traitListData1.push(this.speciesList_animal.indexOf(speciesName))\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n    }\r\n    return Promise.resolve(data);\r\n    },\r\n    // 主要获取数据的方法\r\n    // 根据动植物分开获取\r\n    async getTraitData(varname,classification,hdbId,taxonId){\r\n      // 分两种情况，如果不传入classification，就动植物都请求\r\n      if(this.form.gene!=='' && this.form.gene !==undefined){\r\n        this.form.gene=this.form.gene.trim()\r\n      }\r\n      // 如果传入了classification，就请求该分类\r\n      // 没传入就都请求\r\n      if(classification !=='' && classification !==undefined){\r\n        // this.both=false;\r\n        this.axiosRequest(varname,classification,hdbId,taxonId)\r\n      }else{\r\n        // this.both=true;\r\n        this.axiosRequest(varname,\"animal\",hdbId,taxonId);\r\n        this.axiosRequest(varname,\"plant\",hdbId,taxonId);\r\n      }\r\n   \r\n    },\r\n    axiosRequest(varname,classification,hdbId,taxonId){\r\n      if(classification==\"animal\"){this.pageNo=this.currentPage4_a}else if(classification==\"plant\"){\r\n        this.pageNo=this.currentPage4_p\r\n      }else{this.pageNo=1}\r\n       this.$axios.get(\"https://ngdc.cncb.ac.cn/hapi/api/variants\",{params:{'classification': classification,'varname':varname,'length':this.pageSize,'pageNo':this.pageNo,'speciesName':this.form.querySpecies,'geneid':this.form.gene,'hdbId':hdbId,'taxonId':taxonId}})\r\n          .then((response) => {\r\n            this.getSpecies(varname,classification)\r\n            \r\n            if(classification=='animal'){\r\n              this.totalSize_animal = response.data.recordsTotal;\r\n              this.showTableIcon(response.data.data,classification).then((res)=>{ this.traitData_animal=res; this.loading_animal=false;});\r\n            }else{\r\n              this.totalSize_plant = response.data.recordsTotal;\r\n              this.showTableIcon(response.data.data,classification).then((res)=>{ this.traitData_plant=res; this.loading_plant=false;});\r\n            }\r\n            // 判断什么时候该现实no data的提示\r\n        }).finally(()=>{\r\n          return Promise.resolve()})\r\n    },\r\n    // 根据当前classification判断获取动物或植物列表\r\n    getSpecies(varName,speciesType){\r\n      this.$axios.get('https://ngdc.cncb.ac.cn/hapi/api/species-var',{params: {\"varName\":varName,speciesType: speciesType}})\r\n        .then(response=>{\r\n          // 2是植物，1是动物\r\n          if(speciesType=='plant'){\r\n            this.querySpeciesList_plant=response.data;\r\n          }else{\r\n            this.querySpeciesList_animal=response.data;\r\n          }\r\n      })\r\n    },  \r\n    clearTraitFilter(){\r\n        this.varItem={\r\n          varName:\"\"\r\n        }\r\n        if(this.classification=='animal'){this.loading_animal=true}else{this.loading_plant=true}\r\n        this.showTitle=false;\r\n        // let params1={classification:\"animal\"}\r\n        // let params={traitId:this.traitItem.traitDefID,classification:this.traitItem.classification,pagesize:this.pageSize,pagenum:1,speciesName:this.form.querySpecies}\r\n        // let params2={classification:\"plant\"}\r\n        this.getTraitData(\"\",\"animal\");\r\n        this.getTraitData(\"\",\"plant\");\r\n        // this.getTraitData(\"\",\"plant\");\r\n      },\r\n    exportToExcel(classs) {\r\n      let oriData;\r\n      if(classs=='animal'){oriData=this.traitData_animal}else{oriData=this.traitData_plant}\r\n      import('@/vendor/Export2Excel').then(excel => {\r\n        const tHeader = [ 'Variant Term',\"Gene ID\",\"Species Common Name\",\"Taxon ID\",\"Homologous Info Data\"]\r\n        const filterVal = ['varName','geneId','speciesCommonName','taxonId','orthoList']\r\n        const data = this.formatJson(filterVal, oriData)\r\n        excel.export_json_to_excel({\r\n          header: tHeader,\r\n          data,\r\n          filename:\"public_outer\"\r\n        })\r\n      })\r\n    },\r\n    exportToSubOrthoTableExcel(orthodata) {\r\n      import('@/vendor/Export2Excel').then(excel => {\r\n        const tHeader = [ 'Species',\"Taxon ID\",\"Ensembl ID\",'Gene Symbol',\"Protein ID\",\"DataSource\"]\r\n        const filterVal = ['commonName','tax','ensemblGeneId','geneSymbol',\"hdbId\",\"dbEvidence\"]\r\n        const data = this.formatJson(filterVal, orthodata)\r\n        excel.export_json_to_excel({\r\n          header: tHeader,\r\n          data,\r\n          filename:\"Homolog_Outer\"\r\n        })\r\n      })\r\n    },\r\n    exportToSubGwasTableExcel(gwasdata) {\r\n      import('@/vendor/Export2Excel').then(excel => {\r\n        const tHeader = [ 'Gene ID',\"Var ID\",\"Position\",'Allele',\"MAF\",\"Class\",\"Consequence Type/Effect\",\"Gene Symbol\"]\r\n        const filterVal = ['finalgenename','rsnpId','finalposition','finalallele','finalmaf',\"snpClassId\",'finalConseqtype','finalGenealias']\r\n        const data = this.formatJson(filterVal, gwasdata)\r\n        excel.export_json_to_excel({\r\n          header: tHeader,\r\n          data,\r\n          filename:\"Variants_Outer\"\r\n        })\r\n      })\r\n    },\r\n    formatJson(filterVal, jsonData) {\r\n      return jsonData.map(v => filterVal.map(j => {\r\n        if(j==\"orthoList\"){\r\n            let orthoData=v[j];\r\n            let orthoList=[]\r\n            for(let item of orthoData){\r\n              let orthodataInfo={\"Species Common Name\":item.commonName,\"Taxon ID\":item.tax,\"Variant Term\":item.varName,\"Homologous Protein ID\":item.hdbId,\"Data Source\":item.dbEvidence}\r\n              orthoList.push(JSON.stringify(orthodataInfo))\r\n            }\r\n            return orthoList\r\n        }else{\r\n         return  v[j]\r\n        }\r\n      }))\r\n    },\r\n\r\n  },\r\n  \r\n\r\n  mounted() {\r\n     \r\n    let hdbId = this.$route.query.hdbId;\r\n    this.hdbId=hdbId;\r\n    let taxonId=this.$route.query.taxonId;\r\n    if(taxonId!==''&&taxonId!=null){\r\n      let commonName=this.$route.query.commonName;\r\n      this.form.querySpecies=commonName;\r\n    }\r\n    // if(hdbId!=null && hdbId!=\"\"){}\r\n    if(hdbId!=\"\"&&hdbId!=null||(taxonId!==''&&taxonId!=null)){\r\n      let classification;\r\n      if(this.$route.query.speciesType==1){\r\n        classification=\"animal\";\r\n        this.classification=\"animal\";\r\n        this.loading_animal=true;\r\n      }else if(this.$route.query.speciesType==2){\r\n        classification=\"plant\";\r\n        this.classification=\"plant\";\r\n        this.loading_plant=true;\r\n      }\r\n     \r\n      this.varItem={\r\n        varName:\"\"\r\n      }\r\n        this.showTitle=false;\r\n        this.getTraitData(\"\",classification,hdbId,taxonId);\r\n    }else{\r\n      this.loading_animal = true;\r\n      this.loading_plant=true;\r\n      this.getTraitData(this.varItem.varName,\"\",hdbId,taxonId);\r\n    }\r\n\r\n    window.addEventListener(\"scroll\", this.watchScroll);\r\n    // this.getTableMaxHeight(); \r\n    // let _this = this;\r\n    // window.onresize = function () {//用于使表格高度自适应的方法  \r\n    // _this.getTableMaxHeight();//获取容器当前高度，重设表格的最大高度\r\n    // }\r\n   // 获取动植物名称列表，用于下拉选择框\r\n    this.getSpecies(this.varItem.varName,\"animal\")\r\n    this.getSpecies(this.varItem.varName,\"plant\")\r\n    \r\n     window.addEventListener(\"scroll\", this.watchScroll);\r\n      this.getTableMaxHeight(); \r\n      let _this = this;\r\n      window.onresize = function () {//用于使表格高度自适应的方法  \r\n      _this.getTableMaxHeight();//获取容器当前高度，重设表格的最大高度\r\n    }\r\n    \r\n  }\r\n}\r\n\r\n</script>\r\n"]}]}